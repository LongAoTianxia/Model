/root/miniconda3/envs/d2l/bin/python /root/autodl-tmp/train.py 
7300 images were found in the dataset.
5845 images for training.
1455 images for validation.
Using 8 dataloader workers every process
_IncompatibleKeys(missing_keys=['head.weight', 'head.bias'], unexpected_keys=[])
==== Warmup FP32 Training (no quantization) ====
[train epoch 0] loss: 1.187, acc: 0.604: 100%|█| 366/366 [00:25<00:00, 14.57it/s
[valid epoch 0] loss: 0.473, acc: 0.900: 100%|██| 91/91 [00:04<00:00, 18.45it/s]
[FP32 warmup] epoch 0: train_acc=0.6037, val_acc=0.9003
[train epoch 1] loss: 1.027, acc: 0.649: 100%|█| 366/366 [00:22<00:00, 16.30it/s
[valid epoch 1] loss: 0.437, acc: 0.907: 100%|██| 91/91 [00:04<00:00, 18.85it/s]
[FP32 warmup] epoch 1: train_acc=0.6488, val_acc=0.9065
[train epoch 2] loss: 0.964, acc: 0.680: 100%|█| 366/366 [00:22<00:00, 16.03it/s
[valid epoch 2] loss: 0.436, acc: 0.899: 100%|██| 91/91 [00:04<00:00, 18.73it/s]
[FP32 warmup] epoch 2: train_acc=0.6796, val_acc=0.8990
[train epoch 3] loss: 0.959, acc: 0.683: 100%|█| 366/366 [00:22<00:00, 15.98it/s
[valid epoch 3] loss: 0.402, acc: 0.910: 100%|██| 91/91 [00:04<00:00, 19.16it/s]
[FP32 warmup] epoch 3: train_acc=0.6834, val_acc=0.9100
[train epoch 4] loss: 0.961, acc: 0.679: 100%|█| 366/366 [00:22<00:00, 16.38it/s
[valid epoch 4] loss: 0.383, acc: 0.918: 100%|██| 91/91 [00:10<00:00,  8.85it/s]
[FP32 warmup] epoch 4: train_acc=0.6791, val_acc=0.9182

==== Sweep 0: head+MLP ====

=== QAT Stage 1 (8bit, head+MLP) ===
[train epoch 0] loss: 1.428, acc: 0.525: 100%|█| 366/366 [00:29<00:00, 12.28it/s
[valid epoch 0] loss: 0.621, acc: 0.850: 100%|██| 91/91 [00:05<00:00, 17.75it/s]
Best model (head+MLP Stage 1) saved with accuracy: 0.8502
[train epoch 1] loss: 1.133, acc: 0.629: 100%|█| 366/366 [00:29<00:00, 12.22it/s
[valid epoch 1] loss: 0.543, acc: 0.878: 100%|██| 91/91 [00:05<00:00, 17.56it/s]
Best model (head+MLP Stage 1) saved with accuracy: 0.8777
[train epoch 2] loss: 1.075, acc: 0.646: 100%|█| 366/366 [00:29<00:00, 12.43it/s
[valid epoch 2] loss: 0.509, acc: 0.889: 100%|██| 91/91 [00:05<00:00, 17.68it/s]
Best model (head+MLP Stage 1) saved with accuracy: 0.8893
[train epoch 3] loss: 1.014, acc: 0.669: 100%|█| 366/366 [00:29<00:00, 12.37it/s
[valid epoch 3] loss: 0.479, acc: 0.893: 100%|██| 91/91 [00:05<00:00, 17.63it/s]
Best model (head+MLP Stage 1) saved with accuracy: 0.8935
[train epoch 4] loss: 1.002, acc: 0.672: 100%|█| 366/366 [00:29<00:00, 12.44it/s
[valid epoch 4] loss: 0.454, acc: 0.892: 100%|██| 91/91 [00:05<00:00, 17.76it/s]
[train epoch 5] loss: 0.978, acc: 0.681: 100%|█| 366/366 [00:29<00:00, 12.22it/s
[valid epoch 5] loss: 0.448, acc: 0.899: 100%|██| 91/91 [00:05<00:00, 17.59it/s]
Best model (head+MLP Stage 1) saved with accuracy: 0.8990
Stage 1 (head+MLP) finished. Best acc: 0.8990

=== QAT Stage 2 (6bit, head+MLP) ===
[train epoch 6] loss: 0.820, acc: 0.671: 100%|█| 366/366 [00:28<00:00, 12.73it/s
[valid epoch 6] loss: 0.464, acc: 0.900: 100%|██| 91/91 [00:05<00:00, 17.80it/s]
Best model (head+MLP Stage 2) saved with accuracy: 0.8997
[train epoch 7] loss: 0.827, acc: 0.662: 100%|█| 366/366 [00:29<00:00, 12.46it/s
[valid epoch 7] loss: 0.461, acc: 0.899: 100%|██| 91/91 [00:05<00:00, 17.80it/s]
[train epoch 8] loss: 0.809, acc: 0.671: 100%|█| 366/366 [00:29<00:00, 12.53it/s
[valid epoch 8] loss: 0.463, acc: 0.903: 100%|██| 91/91 [00:05<00:00, 17.63it/s]
Best model (head+MLP Stage 2) saved with accuracy: 0.9031
[train epoch 9] loss: 0.809, acc: 0.671: 100%|█| 366/366 [00:29<00:00, 12.54it/s
[valid epoch 9] loss: 0.451, acc: 0.909: 100%|██| 91/91 [00:05<00:00, 17.74it/s]
Best model (head+MLP Stage 2) saved with accuracy: 0.9093
[train epoch 10] loss: 0.789, acc: 0.673: 100%|█| 366/366 [00:29<00:00, 12.45it/
[valid epoch 10] loss: 0.449, acc: 0.909: 100%|█| 91/91 [00:05<00:00, 17.64it/s]
[train epoch 11] loss: 0.753, acc: 0.691: 100%|█| 366/366 [00:42<00:00,  8.52it/
[valid epoch 11] loss: 0.439, acc: 0.910: 100%|█| 91/91 [00:05<00:00, 15.77it/s]
Best model (head+MLP Stage 2) saved with accuracy: 0.9100
[train epoch 12] loss: 0.767, acc: 0.685: 100%|█| 366/366 [00:29<00:00, 12.48it/
[valid epoch 12] loss: 0.425, acc: 0.912: 100%|█| 91/91 [00:07<00:00, 11.44it/s]
Best model (head+MLP Stage 2) saved with accuracy: 0.9120
[train epoch 13] loss: 0.755, acc: 0.691: 100%|█| 366/366 [00:28<00:00, 12.75it/
[valid epoch 13] loss: 0.414, acc: 0.916: 100%|█| 91/91 [00:05<00:00, 17.54it/s]
Best model (head+MLP Stage 2) saved with accuracy: 0.9162
[train epoch 14] loss: 0.750, acc: 0.694: 100%|█| 366/366 [00:46<00:00,  7.93it/
[valid epoch 14] loss: 0.417, acc: 0.911: 100%|█| 91/91 [00:05<00:00, 16.84it/s]
[train epoch 15] loss: 0.754, acc: 0.686: 100%|█| 366/366 [00:39<00:00,  9.24it/
[valid epoch 15] loss: 0.419, acc: 0.913: 100%|█| 91/91 [00:06<00:00, 14.81it/s]
Stage 2 (head+MLP) finished. Best acc: 0.9162

=== QAT Stage 3 (4bit, head+MLP) ===
[train epoch 16] loss: 0.515, acc: 0.611: 100%|█| 366/366 [00:29<00:00, 12.52it/
[valid epoch 16] loss: 0.667, acc: 0.844: 100%|█| 91/91 [00:05<00:00, 17.57it/s]
Best model (head+MLP Stage 3) saved with accuracy: 0.8440
[train epoch 17] loss: 0.435, acc: 0.625: 100%|█| 366/366 [00:29<00:00, 12.61it/
[valid epoch 17] loss: 0.642, acc: 0.846: 100%|█| 91/91 [00:05<00:00, 17.56it/s]
Best model (head+MLP Stage 3) saved with accuracy: 0.8460
[train epoch 18] loss: 0.420, acc: 0.621: 100%|█| 366/366 [00:29<00:00, 12.61it/
[valid epoch 18] loss: 0.638, acc: 0.856: 100%|█| 91/91 [00:05<00:00, 17.53it/s]
Best model (head+MLP Stage 3) saved with accuracy: 0.8564
[train epoch 19] loss: 0.408, acc: 0.638: 100%|█| 366/366 [00:28<00:00, 12.83it/
[valid epoch 19] loss: 0.624, acc: 0.848: 100%|█| 91/91 [00:05<00:00, 17.63it/s]
[train epoch 20] loss: 0.394, acc: 0.649: 100%|█| 366/366 [00:32<00:00, 11.30it/
[valid epoch 20] loss: 0.616, acc: 0.854: 100%|█| 91/91 [00:05<00:00, 17.33it/s]
[train epoch 21] loss: 0.397, acc: 0.630: 100%|█| 366/366 [00:28<00:00, 12.78it/
[valid epoch 21] loss: 0.604, acc: 0.858: 100%|█| 91/91 [00:05<00:00, 17.58it/s]
Best model (head+MLP Stage 3) saved with accuracy: 0.8577
[train epoch 22] loss: 0.390, acc: 0.626: 100%|█| 366/366 [00:29<00:00, 12.59it/
[valid epoch 22] loss: 0.591, acc: 0.865: 100%|█| 91/91 [00:05<00:00, 17.27it/s]
Best model (head+MLP Stage 3) saved with accuracy: 0.8653
[train epoch 23] loss: 0.521, acc: 0.641: 100%|█| 366/366 [00:29<00:00, 12.33it/
[valid epoch 23] loss: 0.576, acc: 0.859: 100%|█| 91/91 [00:05<00:00, 17.71it/s]
[train epoch 24] loss: 0.528, acc: 0.625: 100%|█| 366/366 [00:28<00:00, 12.65it/
[valid epoch 24] loss: 0.576, acc: 0.863: 100%|█| 91/91 [00:05<00:00, 17.70it/s]
[train epoch 25] loss: 0.501, acc: 0.656: 100%|█| 366/366 [00:28<00:00, 12.65it/
[valid epoch 25] loss: 0.565, acc: 0.872: 100%|█| 91/91 [00:05<00:00, 17.74it/s]
Best model (head+MLP Stage 3) saved with accuracy: 0.8722
[train epoch 26] loss: 0.513, acc: 0.638: 100%|█| 366/366 [00:29<00:00, 12.29it/
[valid epoch 26] loss: 0.565, acc: 0.866: 100%|█| 91/91 [00:05<00:00, 17.59it/s]
[train epoch 27] loss: 0.503, acc: 0.649: 100%|█| 366/366 [00:28<00:00, 12.62it/
[valid epoch 27] loss: 0.556, acc: 0.870: 100%|█| 91/91 [00:05<00:00, 17.59it/s]
[train epoch 28] loss: 0.513, acc: 0.636: 100%|█| 366/366 [00:29<00:00, 12.56it/
[valid epoch 28] loss: 0.553, acc: 0.869: 100%|█| 91/91 [00:05<00:00, 17.71it/s]
[train epoch 29] loss: 0.501, acc: 0.646: 100%|█| 366/366 [00:29<00:00, 12.61it/
[valid epoch 29] loss: 0.556, acc: 0.865: 100%|█| 91/91 [00:05<00:00, 17.46it/s]
[train epoch 30] loss: 0.498, acc: 0.646: 100%|█| 366/366 [00:29<00:00, 12.38it/
[valid epoch 30] loss: 0.554, acc: 0.868: 100%|█| 91/91 [00:05<00:00, 17.50it/s]
Stage 3 (head+MLP) finished. Best acc: 0.8722
Progressive QAT completed. Best validation accuracy: 0.9162

==== Sweep 1: head+MLP+last1Attn ====

=== QAT Stage 1 (8bit, head+MLP+last1Attn) ===
[train epoch 0] loss: 1.390, acc: 0.531: 100%|█| 366/366 [00:30<00:00, 12.05it/s
[valid epoch 0] loss: 0.820, acc: 0.790: 100%|██| 91/91 [00:05<00:00, 17.51it/s]
Best model (head+MLP+last1Attn Stage 1) saved with accuracy: 0.7897
[train epoch 1] loss: 1.275, acc: 0.576: 100%|█| 366/366 [00:29<00:00, 12.44it/s
[valid epoch 1] loss: 0.750, acc: 0.819: 100%|██| 91/91 [00:05<00:00, 17.60it/s]
Best model (head+MLP+last1Attn Stage 1) saved with accuracy: 0.8186
[train epoch 2] loss: 1.256, acc: 0.585: 100%|█| 366/366 [00:29<00:00, 12.26it/s
[valid epoch 2] loss: 0.693, acc: 0.827: 100%|██| 91/91 [00:05<00:00, 17.32it/s]
Best model (head+MLP+last1Attn Stage 1) saved with accuracy: 0.8275
[train epoch 3] loss: 1.199, acc: 0.603: 100%|█| 366/366 [00:29<00:00, 12.26it/s
[valid epoch 3] loss: 0.662, acc: 0.842: 100%|██| 91/91 [00:05<00:00, 17.39it/s]
Best model (head+MLP+last1Attn Stage 1) saved with accuracy: 0.8419
[train epoch 4] loss: 1.176, acc: 0.612: 100%|█| 366/366 [00:30<00:00, 12.04it/s
[valid epoch 4] loss: 0.642, acc: 0.851: 100%|██| 91/91 [00:05<00:00, 17.33it/s]
Best model (head+MLP+last1Attn Stage 1) saved with accuracy: 0.8509
[train epoch 5] loss: 1.153, acc: 0.620: 100%|█| 366/366 [00:29<00:00, 12.58it/s
[valid epoch 5] loss: 0.600, acc: 0.856: 100%|██| 91/91 [00:05<00:00, 17.30it/s]
Best model (head+MLP+last1Attn Stage 1) saved with accuracy: 0.8564
[train epoch 6] loss: 1.114, acc: 0.633: 100%|█| 366/366 [00:29<00:00, 12.45it/s
[valid epoch 6] loss: 0.591, acc: 0.865: 100%|██| 91/91 [00:05<00:00, 16.72it/s]
Best model (head+MLP+last1Attn Stage 1) saved with accuracy: 0.8646
[train epoch 7] loss: 1.114, acc: 0.637: 100%|█| 366/366 [00:29<00:00, 12.26it/s
[valid epoch 7] loss: 0.602, acc: 0.865: 100%|██| 91/91 [00:05<00:00, 16.92it/s]
Best model (head+MLP+last1Attn Stage 1) saved with accuracy: 0.8653
[train epoch 8] loss: 1.096, acc: 0.639: 100%|█| 366/366 [00:29<00:00, 12.29it/s
[valid epoch 8] loss: 0.555, acc: 0.878: 100%|██| 91/91 [00:05<00:00, 17.59it/s]
Best model (head+MLP+last1Attn Stage 1) saved with accuracy: 0.8777
[train epoch 9] loss: 1.049, acc: 0.654: 100%|█| 366/366 [00:29<00:00, 12.52it/s
[valid epoch 9] loss: 0.561, acc: 0.876: 100%|██| 91/91 [00:05<00:00, 17.34it/s]
[train epoch 10] loss: 1.093, acc: 0.640: 100%|█| 366/366 [00:30<00:00, 12.19it/
[valid epoch 10] loss: 0.549, acc: 0.885: 100%|█| 91/91 [00:05<00:00, 17.51it/s]
Best model (head+MLP+last1Attn Stage 1) saved with accuracy: 0.8845
[train epoch 11] loss: 1.036, acc: 0.660: 100%|█| 366/366 [00:30<00:00, 12.18it/
[valid epoch 11] loss: 0.525, acc: 0.885: 100%|█| 91/91 [00:05<00:00, 17.07it/s]
[train epoch 12] loss: 1.048, acc: 0.653: 100%|█| 366/366 [00:29<00:00, 12.38it/
[valid epoch 12] loss: 0.511, acc: 0.888: 100%|█| 91/91 [00:05<00:00, 17.44it/s]
Best model (head+MLP+last1Attn Stage 1) saved with accuracy: 0.8880
[train epoch 13] loss: 1.016, acc: 0.672: 100%|█| 366/366 [00:30<00:00, 12.20it/
[valid epoch 13] loss: 0.509, acc: 0.884: 100%|█| 91/91 [00:05<00:00, 17.49it/s]
[train epoch 14] loss: 1.008, acc: 0.679: 100%|█| 366/366 [00:33<00:00, 10.81it/
[valid epoch 14] loss: 0.485, acc: 0.897: 100%|█| 91/91 [00:05<00:00, 15.87it/s]
Best model (head+MLP+last1Attn Stage 1) saved with accuracy: 0.8969
[train epoch 15] loss: 1.002, acc: 0.674: 100%|█| 366/366 [00:30<00:00, 12.10it/
[valid epoch 15] loss: 0.476, acc: 0.897: 100%|█| 91/91 [00:05<00:00, 17.44it/s]
[train epoch 16] loss: 1.011, acc: 0.673: 100%|█| 366/366 [00:31<00:00, 11.50it/
[valid epoch 16] loss: 0.481, acc: 0.898: 100%|█| 91/91 [00:05<00:00, 17.31it/s]
Best model (head+MLP+last1Attn Stage 1) saved with accuracy: 0.8976
[train epoch 17] loss: 0.994, acc: 0.677: 100%|█| 366/366 [00:30<00:00, 11.99it/
[valid epoch 17] loss: 0.472, acc: 0.904: 100%|█| 91/91 [00:05<00:00, 17.32it/s]
Best model (head+MLP+last1Attn Stage 1) saved with accuracy: 0.9045
[train epoch 18] loss: 1.010, acc: 0.666: 100%|█| 366/366 [00:29<00:00, 12.31it/
[valid epoch 18] loss: 0.472, acc: 0.906: 100%|█| 91/91 [00:05<00:00, 17.08it/s]
Best model (head+MLP+last1Attn Stage 1) saved with accuracy: 0.9058
[train epoch 19] loss: 1.005, acc: 0.671: 100%|█| 366/366 [00:29<00:00, 12.49it/
[valid epoch 19] loss: 0.470, acc: 0.907: 100%|█| 91/91 [00:05<00:00, 16.93it/s]
Best model (head+MLP+last1Attn Stage 1) saved with accuracy: 0.9065
Stage 1 (head+MLP+last1Attn) finished. Best acc: 0.9065

=== QAT Stage 2 (6bit, head+MLP+last1Attn) ===
[train epoch 20] loss: 0.831, acc: 0.668: 100%|█| 366/366 [00:30<00:00, 12.03it/
[valid epoch 20] loss: 0.496, acc: 0.896: 100%|█| 91/91 [00:05<00:00, 17.11it/s]
Best model (head+MLP+last1Attn Stage 2) saved with accuracy: 0.8955
[train epoch 21] loss: 0.804, acc: 0.685: 100%|█| 366/366 [00:30<00:00, 12.05it/
[valid epoch 21] loss: 0.493, acc: 0.892: 100%|█| 91/91 [00:05<00:00, 16.91it/s]
[train epoch 22] loss: 0.814, acc: 0.676: 100%|█| 366/366 [00:31<00:00, 11.47it/
[valid epoch 22] loss: 0.492, acc: 0.890: 100%|█| 91/91 [00:07<00:00, 12.64it/s]
[train epoch 23] loss: 0.808, acc: 0.673: 100%|█| 366/366 [00:30<00:00, 11.91it/
[valid epoch 23] loss: 0.494, acc: 0.900: 100%|█| 91/91 [00:05<00:00, 17.14it/s]
Best model (head+MLP+last1Attn Stage 2) saved with accuracy: 0.8997
[train epoch 24] loss: 0.787, acc: 0.687: 100%|█| 366/366 [00:29<00:00, 12.27it/
[valid epoch 24] loss: 0.489, acc: 0.891: 100%|█| 91/91 [00:05<00:00, 17.18it/s]
[train epoch 25] loss: 0.819, acc: 0.669: 100%|█| 366/366 [00:29<00:00, 12.37it/
[valid epoch 25] loss: 0.486, acc: 0.896: 100%|█| 91/91 [00:05<00:00, 16.95it/s]
[train epoch 26] loss: 0.793, acc: 0.675: 100%|█| 366/366 [00:29<00:00, 12.22it/
[valid epoch 26] loss: 0.483, acc: 0.898: 100%|█| 91/91 [00:05<00:00, 17.08it/s]
[train epoch 27] loss: 0.789, acc: 0.686: 100%|█| 366/366 [00:30<00:00, 11.94it/
[valid epoch 27] loss: 0.486, acc: 0.896: 100%|█| 91/91 [00:05<00:00, 16.60it/s]
[train epoch 28] loss: 0.794, acc: 0.676: 100%|█| 366/366 [00:29<00:00, 12.47it/
[valid epoch 28] loss: 0.477, acc: 0.897: 100%|█| 91/91 [00:05<00:00, 17.01it/s]
[train epoch 29] loss: 0.786, acc: 0.679: 100%|█| 366/366 [00:30<00:00, 12.17it/
[valid epoch 29] loss: 0.476, acc: 0.900: 100%|█| 91/91 [00:05<00:00, 17.13it/s]
[train epoch 30] loss: 0.787, acc: 0.685: 100%|█| 366/366 [00:29<00:00, 12.28it/
[valid epoch 30] loss: 0.465, acc: 0.905: 100%|█| 91/91 [00:05<00:00, 17.28it/s]
Best model (head+MLP+last1Attn Stage 2) saved with accuracy: 0.9052
[train epoch 31] loss: 0.706, acc: 0.673: 100%|█| 366/366 [00:29<00:00, 12.35it/
[valid epoch 31] loss: 0.468, acc: 0.898: 100%|█| 91/91 [00:05<00:00, 17.12it/s]
[train epoch 32] loss: 0.667, acc: 0.696: 100%|█| 366/366 [00:29<00:00, 12.30it/
[valid epoch 32] loss: 0.469, acc: 0.903: 100%|█| 91/91 [00:05<00:00, 16.63it/s]
[train epoch 33] loss: 0.675, acc: 0.690: 100%|█| 366/366 [00:29<00:00, 12.29it/
[valid epoch 33] loss: 0.470, acc: 0.903: 100%|█| 91/91 [00:05<00:00, 17.17it/s]
[train epoch 34] loss: 0.667, acc: 0.692: 100%|█| 366/366 [00:29<00:00, 12.36it/
[valid epoch 34] loss: 0.470, acc: 0.900: 100%|█| 91/91 [00:05<00:00, 17.16it/s]
Stage 2 (head+MLP+last1Attn) finished. Best acc: 0.9052

=== QAT Stage 3 (4bit, head+MLP+last1Attn) ===
[train epoch 35] loss: 0.535, acc: 0.590: 100%|█| 366/366 [00:28<00:00, 12.72it/
[valid epoch 35] loss: 0.717, acc: 0.825: 100%|█| 91/91 [00:05<00:00, 17.00it/s]
Best model (head+MLP+last1Attn Stage 3) saved with accuracy: 0.8247
[train epoch 36] loss: 0.477, acc: 0.602: 100%|█| 366/366 [00:30<00:00, 12.14it/
[valid epoch 36] loss: 0.708, acc: 0.833: 100%|█| 91/91 [00:05<00:00, 17.18it/s]
Best model (head+MLP+last1Attn Stage 3) saved with accuracy: 0.8330
[train epoch 37] loss: 0.442, acc: 0.631: 100%|█| 366/366 [00:29<00:00, 12.25it/
[valid epoch 37] loss: 0.675, acc: 0.830: 100%|█| 91/91 [00:05<00:00, 16.94it/s]
[train epoch 38] loss: 0.437, acc: 0.632: 100%|█| 366/366 [00:30<00:00, 12.11it/
[valid epoch 38] loss: 0.685, acc: 0.842: 100%|█| 91/91 [00:05<00:00, 17.20it/s]
Best model (head+MLP+last1Attn Stage 3) saved with accuracy: 0.8419
[train epoch 39] loss: 0.426, acc: 0.630: 100%|█| 366/366 [00:29<00:00, 12.27it/
[valid epoch 39] loss: 0.678, acc: 0.841: 100%|█| 91/91 [00:05<00:00, 17.18it/s]
[train epoch 40] loss: 0.425, acc: 0.617: 100%|█| 366/366 [00:29<00:00, 12.34it/
[valid epoch 40] loss: 0.660, acc: 0.849: 100%|█| 91/91 [00:05<00:00, 17.34it/s]
Best model (head+MLP+last1Attn Stage 3) saved with accuracy: 0.8495
[train epoch 41] loss: 0.414, acc: 0.628: 100%|█| 366/366 [00:29<00:00, 12.49it/
[valid epoch 41] loss: 0.658, acc: 0.838: 100%|█| 91/91 [00:05<00:00, 17.30it/s]
[train epoch 42] loss: 0.417, acc: 0.622: 100%|█| 366/366 [00:30<00:00, 12.06it/
[valid epoch 42] loss: 0.675, acc: 0.830: 100%|█| 91/91 [00:05<00:00, 16.91it/s]
[train epoch 43] loss: 0.416, acc: 0.614: 100%|█| 366/366 [00:29<00:00, 12.22it/
[valid epoch 43] loss: 0.647, acc: 0.846: 100%|█| 91/91 [00:05<00:00, 16.98it/s]
[train epoch 44] loss: 0.393, acc: 0.633: 100%|█| 366/366 [00:29<00:00, 12.26it/
[valid epoch 44] loss: 0.646, acc: 0.847: 100%|█| 91/91 [00:05<00:00, 17.30it/s]
[train epoch 45] loss: 0.401, acc: 0.619: 100%|█| 366/366 [00:30<00:00, 12.17it/
[valid epoch 45] loss: 0.646, acc: 0.852: 100%|█| 91/91 [00:05<00:00, 17.13it/s]
Best model (head+MLP+last1Attn Stage 3) saved with accuracy: 0.8522
[train epoch 46] loss: 0.550, acc: 0.612: 100%|█| 366/366 [00:29<00:00, 12.31it/
[valid epoch 46] loss: 0.639, acc: 0.839: 100%|█| 91/91 [00:05<00:00, 17.37it/s]
[train epoch 47] loss: 0.543, acc: 0.618: 100%|█| 366/366 [00:29<00:00, 12.23it/
[valid epoch 47] loss: 0.618, acc: 0.843: 100%|█| 91/91 [00:05<00:00, 17.18it/s]
[train epoch 48] loss: 0.527, acc: 0.639: 100%|█| 366/366 [00:30<00:00, 12.01it/
[valid epoch 48] loss: 0.621, acc: 0.847: 100%|█| 91/91 [00:05<00:00, 17.08it/s]
[train epoch 49] loss: 0.521, acc: 0.644: 100%|█| 366/366 [00:30<00:00, 11.89it/
[valid epoch 49] loss: 0.605, acc: 0.846: 100%|█| 91/91 [00:05<00:00, 17.28it/s]
[train epoch 50] loss: 0.516, acc: 0.634: 100%|█| 366/366 [00:29<00:00, 12.39it/
[valid epoch 50] loss: 0.602, acc: 0.850: 100%|█| 91/91 [00:05<00:00, 17.32it/s]
[train epoch 51] loss: 0.511, acc: 0.643: 100%|█| 366/366 [00:30<00:00, 11.96it/
[valid epoch 51] loss: 0.603, acc: 0.849: 100%|█| 91/91 [00:05<00:00, 17.10it/s]
[train epoch 52] loss: 0.526, acc: 0.623: 100%|█| 366/366 [00:30<00:00, 11.94it/
[valid epoch 52] loss: 0.600, acc: 0.854: 100%|█| 91/91 [00:05<00:00, 17.38it/s]
Best model (head+MLP+last1Attn Stage 3) saved with accuracy: 0.8536
[train epoch 53] loss: 0.518, acc: 0.628: 100%|█| 366/366 [00:29<00:00, 12.29it/
[valid epoch 53] loss: 0.592, acc: 0.852: 100%|█| 91/91 [00:05<00:00, 17.42it/s]
[train epoch 54] loss: 0.516, acc: 0.634: 100%|█| 366/366 [00:29<00:00, 12.42it/
[valid epoch 54] loss: 0.594, acc: 0.849: 100%|█| 91/91 [00:05<00:00, 17.46it/s]
[train epoch 55] loss: 0.501, acc: 0.644: 100%|█| 366/366 [00:31<00:00, 11.56it/
[valid epoch 55] loss: 0.591, acc: 0.852: 100%|█| 91/91 [00:05<00:00, 17.24it/s]
[train epoch 56] loss: 0.506, acc: 0.644: 100%|█| 366/366 [00:29<00:00, 12.57it/
[valid epoch 56] loss: 0.592, acc: 0.854: 100%|█| 91/91 [00:05<00:00, 16.56it/s]
[train epoch 57] loss: 0.501, acc: 0.651: 100%|█| 366/366 [00:29<00:00, 12.34it/
[valid epoch 57] loss: 0.589, acc: 0.854: 100%|█| 91/91 [00:05<00:00, 17.22it/s]
Stage 3 (head+MLP+last1Attn) finished. Best acc: 0.8536
Progressive QAT completed. Best validation accuracy: 0.9065

==== Sweep 2: head+MLP+last2Attn ====

=== QAT Stage 1 (8bit, head+MLP+last2Attn) ===
[train epoch 0] loss: 1.272, acc: 0.574: 100%|█| 366/366 [00:31<00:00, 11.67it/s
[valid epoch 0] loss: 0.743, acc: 0.809: 100%|██| 91/91 [00:05<00:00, 16.76it/s]
Best model (head+MLP+last2Attn Stage 1) saved with accuracy: 0.8089
[train epoch 1] loss: 1.152, acc: 0.614: 100%|█| 366/366 [00:31<00:00, 11.60it/s
[valid epoch 1] loss: 0.658, acc: 0.830: 100%|██| 91/91 [00:05<00:00, 16.81it/s]
Best model (head+MLP+last2Attn Stage 1) saved with accuracy: 0.8302
[train epoch 2] loss: 1.159, acc: 0.614: 100%|█| 366/366 [00:32<00:00, 11.11it/s
[valid epoch 2] loss: 0.620, acc: 0.858: 100%|██| 91/91 [00:05<00:00, 16.87it/s]
Best model (head+MLP+last2Attn Stage 1) saved with accuracy: 0.8577
[train epoch 3] loss: 1.163, acc: 0.609: 100%|█| 366/366 [00:32<00:00, 11.40it/s
[valid epoch 3] loss: 0.657, acc: 0.836: 100%|██| 91/91 [00:05<00:00, 15.90it/s]
[train epoch 4] loss: 1.132, acc: 0.621: 100%|█| 366/366 [00:29<00:00, 12.27it/s
[valid epoch 4] loss: 0.605, acc: 0.848: 100%|██| 91/91 [00:05<00:00, 16.70it/s]
[train epoch 5] loss: 1.121, acc: 0.630: 100%|█| 366/366 [00:31<00:00, 11.46it/s
[valid epoch 5] loss: 0.598, acc: 0.857: 100%|██| 91/91 [00:05<00:00, 17.02it/s]
[train epoch 6] loss: 1.092, acc: 0.638: 100%|█| 366/366 [00:30<00:00, 11.89it/s
[valid epoch 6] loss: 0.613, acc: 0.847: 100%|██| 91/91 [00:05<00:00, 17.10it/s]
[train epoch 7] loss: 1.073, acc: 0.648: 100%|█| 366/366 [00:30<00:00, 12.15it/s
[valid epoch 7] loss: 0.618, acc: 0.857: 100%|██| 91/91 [00:05<00:00, 16.88it/s]
[train epoch 8] loss: 1.054, acc: 0.658: 100%|█| 366/366 [00:31<00:00, 11.75it/s
[valid epoch 8] loss: 0.544, acc: 0.874: 100%|██| 91/91 [00:05<00:00, 16.96it/s]
Best model (head+MLP+last2Attn Stage 1) saved with accuracy: 0.8742
[train epoch 9] loss: 1.051, acc: 0.654: 100%|█| 366/366 [00:30<00:00, 11.88it/s
[valid epoch 9] loss: 0.533, acc: 0.874: 100%|██| 91/91 [00:05<00:00, 16.94it/s]
[train epoch 10] loss: 1.054, acc: 0.650: 100%|█| 366/366 [00:30<00:00, 11.92it/
[valid epoch 10] loss: 0.532, acc: 0.876: 100%|█| 91/91 [00:05<00:00, 16.98it/s]
Best model (head+MLP+last2Attn Stage 1) saved with accuracy: 0.8756
[train epoch 11] loss: 1.030, acc: 0.662: 100%|█| 366/366 [00:30<00:00, 12.04it/
[valid epoch 11] loss: 0.531, acc: 0.887: 100%|█| 91/91 [00:05<00:00, 16.92it/s]
Best model (head+MLP+last2Attn Stage 1) saved with accuracy: 0.8866
[train epoch 12] loss: 1.011, acc: 0.667: 100%|█| 366/366 [00:29<00:00, 12.44it/
[valid epoch 12] loss: 0.511, acc: 0.885: 100%|█| 91/91 [00:05<00:00, 16.69it/s]
[train epoch 13] loss: 1.012, acc: 0.669: 100%|█| 366/366 [00:30<00:00, 12.18it/
[valid epoch 13] loss: 0.496, acc: 0.894: 100%|█| 91/91 [00:05<00:00, 16.85it/s]
Best model (head+MLP+last2Attn Stage 1) saved with accuracy: 0.8942
[train epoch 14] loss: 1.003, acc: 0.673: 100%|█| 366/366 [00:29<00:00, 12.22it/
[valid epoch 14] loss: 0.488, acc: 0.888: 100%|█| 91/91 [00:05<00:00, 16.90it/s]
[train epoch 15] loss: 1.001, acc: 0.675: 100%|█| 366/366 [00:31<00:00, 11.78it/
[valid epoch 15] loss: 0.480, acc: 0.896: 100%|█| 91/91 [00:05<00:00, 16.80it/s]
Best model (head+MLP+last2Attn Stage 1) saved with accuracy: 0.8962
[train epoch 16] loss: 1.001, acc: 0.678: 100%|█| 366/366 [00:31<00:00, 11.59it/
[valid epoch 16] loss: 0.482, acc: 0.896: 100%|█| 91/91 [00:05<00:00, 16.99it/s]
[train epoch 17] loss: 0.991, acc: 0.673: 100%|█| 366/366 [00:30<00:00, 11.97it/
[valid epoch 17] loss: 0.480, acc: 0.897: 100%|█| 91/91 [00:05<00:00, 15.92it/s]
Best model (head+MLP+last2Attn Stage 1) saved with accuracy: 0.8969
Stage 1 (head+MLP+last2Attn) finished. Best acc: 0.8969

=== QAT Stage 2 (6bit, head+MLP+last2Attn) ===
[train epoch 18] loss: 0.818, acc: 0.677: 100%|█| 366/366 [00:30<00:00, 11.86it/
[valid epoch 18] loss: 0.506, acc: 0.887: 100%|█| 91/91 [00:05<00:00, 16.70it/s]
Best model (head+MLP+last2Attn Stage 2) saved with accuracy: 0.8866
[train epoch 19] loss: 0.808, acc: 0.677: 100%|█| 366/366 [00:32<00:00, 11.25it/
[valid epoch 19] loss: 0.505, acc: 0.886: 100%|█| 91/91 [00:05<00:00, 16.31it/s]
[train epoch 20] loss: 0.818, acc: 0.678: 100%|█| 366/366 [00:31<00:00, 11.70it/
[valid epoch 20] loss: 0.504, acc: 0.885: 100%|█| 91/91 [00:05<00:00, 16.93it/s]
[train epoch 21] loss: 0.809, acc: 0.674: 100%|█| 366/366 [00:31<00:00, 11.72it/
[valid epoch 21] loss: 0.497, acc: 0.889: 100%|█| 91/91 [00:05<00:00, 16.90it/s]
Best model (head+MLP+last2Attn Stage 2) saved with accuracy: 0.8893
[train epoch 22] loss: 0.805, acc: 0.680: 100%|█| 366/366 [00:30<00:00, 12.11it/
[valid epoch 22] loss: 0.491, acc: 0.896: 100%|█| 91/91 [00:05<00:00, 16.87it/s]
Best model (head+MLP+last2Attn Stage 2) saved with accuracy: 0.8962
[train epoch 23] loss: 0.819, acc: 0.670: 100%|█| 366/366 [00:30<00:00, 12.03it/
[valid epoch 23] loss: 0.501, acc: 0.900: 100%|█| 91/91 [00:05<00:00, 16.79it/s]
Best model (head+MLP+last2Attn Stage 2) saved with accuracy: 0.9003
[train epoch 24] loss: 0.813, acc: 0.667: 100%|█| 366/366 [00:31<00:00, 11.78it/
[valid epoch 24] loss: 0.513, acc: 0.893: 100%|█| 91/91 [00:05<00:00, 16.63it/s]
[train epoch 25] loss: 0.814, acc: 0.668: 100%|█| 366/366 [00:30<00:00, 12.15it/
[valid epoch 25] loss: 0.500, acc: 0.889: 100%|█| 91/91 [00:05<00:00, 16.75it/s]
[train epoch 26] loss: 0.804, acc: 0.674: 100%|█| 366/366 [00:29<00:00, 12.36it/
[valid epoch 26] loss: 0.512, acc: 0.884: 100%|█| 91/91 [00:05<00:00, 16.79it/s]
[train epoch 27] loss: 0.812, acc: 0.666: 100%|█| 366/366 [00:30<00:00, 12.04it/
[valid epoch 27] loss: 0.500, acc: 0.892: 100%|█| 91/91 [00:05<00:00, 16.75it/s]
[train epoch 28] loss: 0.821, acc: 0.665: 100%|█| 366/366 [00:30<00:00, 11.93it/
[valid epoch 28] loss: 0.490, acc: 0.899: 100%|█| 91/91 [00:05<00:00, 15.96it/s]
[train epoch 29] loss: 0.697, acc: 0.677: 100%|█| 366/366 [00:29<00:00, 12.24it/
[valid epoch 29] loss: 0.492, acc: 0.896: 100%|█| 91/91 [00:05<00:00, 16.53it/s]
[train epoch 30] loss: 0.707, acc: 0.674: 100%|█| 366/366 [00:30<00:00, 12.06it/
[valid epoch 30] loss: 0.488, acc: 0.897: 100%|█| 91/91 [00:05<00:00, 16.76it/s]
[train epoch 31] loss: 0.686, acc: 0.680: 100%|█| 366/366 [00:30<00:00, 11.82it/
[valid epoch 31] loss: 0.480, acc: 0.898: 100%|█| 91/91 [00:05<00:00, 16.71it/s]
[train epoch 32] loss: 0.712, acc: 0.662: 100%|█| 366/366 [00:30<00:00, 11.92it/
[valid epoch 32] loss: 0.482, acc: 0.897: 100%|█| 91/91 [00:05<00:00, 16.83it/s]
[train epoch 33] loss: 0.701, acc: 0.672: 100%|█| 366/366 [00:30<00:00, 12.07it/
[valid epoch 33] loss: 0.479, acc: 0.902: 100%|█| 91/91 [00:05<00:00, 16.80it/s]
Best model (head+MLP+last2Attn Stage 2) saved with accuracy: 0.9017
[train epoch 34] loss: 0.704, acc: 0.667: 100%|█| 366/366 [00:30<00:00, 11.97it/
[valid epoch 34] loss: 0.478, acc: 0.899: 100%|█| 91/91 [00:05<00:00, 16.83it/s]
[train epoch 35] loss: 0.684, acc: 0.679: 100%|█| 366/366 [00:31<00:00, 11.62it/
[valid epoch 35] loss: 0.475, acc: 0.899: 100%|█| 91/91 [00:05<00:00, 16.70it/s]
[train epoch 36] loss: 0.683, acc: 0.679: 100%|█| 366/366 [00:30<00:00, 12.12it/
[valid epoch 36] loss: 0.477, acc: 0.897: 100%|█| 91/91 [00:05<00:00, 16.58it/s]
[train epoch 37] loss: 0.677, acc: 0.683: 100%|█| 366/366 [00:33<00:00, 10.82it/
[valid epoch 37] loss: 0.474, acc: 0.897: 100%|█| 91/91 [00:05<00:00, 16.40it/s]
[train epoch 38] loss: 0.680, acc: 0.683: 100%|█| 366/366 [00:30<00:00, 12.02it/
[valid epoch 38] loss: 0.471, acc: 0.900: 100%|█| 91/91 [00:05<00:00, 16.78it/s]
[train epoch 39] loss: 0.668, acc: 0.689: 100%|█| 366/366 [00:30<00:00, 11.98it/
[valid epoch 39] loss: 0.471, acc: 0.900: 100%|█| 91/91 [00:05<00:00, 16.85it/s]
[train epoch 40] loss: 0.675, acc: 0.687: 100%|█| 366/366 [00:30<00:00, 12.08it/
[valid epoch 40] loss: 0.472, acc: 0.899: 100%|█| 91/91 [00:20<00:00,  4.55it/s]
Stage 2 (head+MLP+last2Attn) finished. Best acc: 0.9017

=== QAT Stage 3 (4bit, head+MLP+last2Attn) ===
[train epoch 41] loss: 0.525, acc: 0.594: 100%|█| 366/366 [00:31<00:00, 11.49it/
[valid epoch 41] loss: 0.749, acc: 0.823: 100%|█| 91/91 [00:05<00:00, 16.35it/s]
Best model (head+MLP+last2Attn Stage 3) saved with accuracy: 0.8227
[train epoch 42] loss: 0.467, acc: 0.608: 100%|█| 366/366 [00:33<00:00, 10.79it/
[valid epoch 42] loss: 0.724, acc: 0.832: 100%|█| 91/91 [00:05<00:00, 16.43it/s]
Best model (head+MLP+last2Attn Stage 3) saved with accuracy: 0.8316
[train epoch 43] loss: 0.444, acc: 0.613: 100%|█| 366/366 [00:46<00:00,  7.82it/
[valid epoch 43] loss: 0.721, acc: 0.821: 100%|█| 91/91 [00:06<00:00, 15.16it/s]
[train epoch 44] loss: 0.448, acc: 0.603: 100%|█| 366/366 [00:42<00:00,  8.61it/
[valid epoch 44] loss: 0.700, acc: 0.831: 100%|█| 91/91 [00:07<00:00, 12.98it/s]
[train epoch 45] loss: 0.442, acc: 0.600: 100%|█| 366/366 [00:30<00:00, 11.98it/
[valid epoch 45] loss: 0.687, acc: 0.830: 100%|█| 91/91 [00:05<00:00, 16.75it/s]
[train epoch 46] loss: 0.429, acc: 0.598: 100%|█| 366/366 [00:35<00:00, 10.42it/
[valid epoch 46] loss: 0.700, acc: 0.830: 100%|█| 91/91 [00:05<00:00, 16.66it/s]
[train epoch 47] loss: 0.414, acc: 0.621: 100%|█| 366/366 [00:29<00:00, 12.24it/
[valid epoch 47] loss: 0.682, acc: 0.829: 100%|█| 91/91 [00:05<00:00, 16.75it/s]
[train epoch 48] loss: 0.423, acc: 0.620: 100%|█| 366/366 [00:29<00:00, 12.26it/
[valid epoch 48] loss: 0.659, acc: 0.841: 100%|█| 91/91 [00:05<00:00, 16.45it/s]
Best model (head+MLP+last2Attn Stage 3) saved with accuracy: 0.8412
[train epoch 49] loss: 0.417, acc: 0.625: 100%|█| 366/366 [00:30<00:00, 12.15it/
[valid epoch 49] loss: 0.667, acc: 0.837: 100%|█| 91/91 [00:05<00:00, 16.74it/s]
[train epoch 50] loss: 0.400, acc: 0.631: 100%|█| 366/366 [00:29<00:00, 12.31it/
[valid epoch 50] loss: 0.665, acc: 0.833: 100%|█| 91/91 [00:05<00:00, 16.76it/s]
[train epoch 51] loss: 0.414, acc: 0.611: 100%|█| 366/366 [00:29<00:00, 12.45it/
[valid epoch 51] loss: 0.663, acc: 0.827: 100%|█| 91/91 [00:05<00:00, 16.74it/s]
[train epoch 52] loss: 0.403, acc: 0.622: 100%|█| 366/366 [00:30<00:00, 12.10it/
[valid epoch 52] loss: 0.657, acc: 0.836: 100%|█| 91/91 [00:05<00:00, 16.71it/s]
[train epoch 53] loss: 0.552, acc: 0.612: 100%|█| 366/366 [00:29<00:00, 12.33it/
[valid epoch 53] loss: 0.661, acc: 0.838: 100%|█| 91/91 [00:05<00:00, 16.71it/s]
[train epoch 54] loss: 0.551, acc: 0.616: 100%|█| 366/366 [00:30<00:00, 12.13it/
[valid epoch 54] loss: 0.632, acc: 0.846: 100%|█| 91/91 [00:05<00:00, 16.73it/s]
Best model (head+MLP+last2Attn Stage 3) saved with accuracy: 0.8460
[train epoch 55] loss: 0.541, acc: 0.626: 100%|█| 366/366 [00:30<00:00, 12.07it/
[valid epoch 55] loss: 0.626, acc: 0.842: 100%|█| 91/91 [00:05<00:00, 16.84it/s]
[train epoch 56] loss: 0.545, acc: 0.616: 100%|█| 366/366 [00:35<00:00, 10.19it/
[valid epoch 56] loss: 0.617, acc: 0.845: 100%|█| 91/91 [00:05<00:00, 16.63it/s]
[train epoch 57] loss: 0.516, acc: 0.636: 100%|█| 366/366 [00:34<00:00, 10.47it/
[valid epoch 57] loss: 0.608, acc: 0.844: 100%|█| 91/91 [00:05<00:00, 16.38it/s]
[train epoch 58] loss: 0.517, acc: 0.639: 100%|█| 366/366 [00:30<00:00, 11.99it/
[valid epoch 58] loss: 0.609, acc: 0.835: 100%|█| 91/91 [00:05<00:00, 16.52it/s]
[train epoch 59] loss: 0.520, acc: 0.632: 100%|█| 366/366 [00:34<00:00, 10.52it/
[valid epoch 59] loss: 0.606, acc: 0.841: 100%|█| 91/91 [00:05<00:00, 16.58it/s]
[train epoch 60] loss: 0.497, acc: 0.654: 100%|█| 366/366 [00:32<00:00, 11.35it/
[valid epoch 60] loss: 0.607, acc: 0.841: 100%|█| 91/91 [00:05<00:00, 16.63it/s]
[train epoch 61] loss: 0.504, acc: 0.643: 100%|█| 366/366 [00:30<00:00, 12.09it/
[valid epoch 61] loss: 0.603, acc: 0.847: 100%|█| 91/91 [00:05<00:00, 16.79it/s]
Best model (head+MLP+last2Attn Stage 3) saved with accuracy: 0.8474
[train epoch 62] loss: 0.513, acc: 0.634: 100%|█| 366/366 [00:31<00:00, 11.57it/
[valid epoch 62] loss: 0.597, acc: 0.851: 100%|█| 91/91 [00:05<00:00, 16.74it/s]
Best model (head+MLP+last2Attn Stage 3) saved with accuracy: 0.8509
[train epoch 63] loss: 0.509, acc: 0.648: 100%|█| 366/366 [00:29<00:00, 12.29it/
[valid epoch 63] loss: 0.595, acc: 0.850: 100%|█| 91/91 [00:06<00:00, 14.80it/s]
[train epoch 64] loss: 0.514, acc: 0.638: 100%|█| 366/366 [00:30<00:00, 12.15it/
[valid epoch 64] loss: 0.595, acc: 0.845: 100%|█| 91/91 [00:05<00:00, 16.34it/s]
[train epoch 65] loss: 0.510, acc: 0.634: 100%|█| 366/366 [00:30<00:00, 11.91it/
[valid epoch 65] loss: 0.595, acc: 0.849: 100%|█| 91/91 [00:05<00:00, 16.67it/s]
Stage 3 (head+MLP+last2Attn) finished. Best acc: 0.8509
Progressive QAT completed. Best validation accuracy: 0.9017

==== Sweep 3: head+MLP+last3Attn ====

=== QAT Stage 1 (8bit, head+MLP+last3Attn) ===
[train epoch 0] loss: 1.321, acc: 0.548: 100%|█| 366/366 [00:31<00:00, 11.53it/s
[valid epoch 0] loss: 0.720, acc: 0.810: 100%|██| 91/91 [00:05<00:00, 16.21it/s]
Best model (head+MLP+last3Attn Stage 1) saved with accuracy: 0.8103
[train epoch 1] loss: 1.245, acc: 0.579: 100%|█| 366/366 [00:31<00:00, 11.46it/s
[valid epoch 1] loss: 0.729, acc: 0.828: 100%|██| 91/91 [00:05<00:00, 15.83it/s]
Best model (head+MLP+last3Attn Stage 1) saved with accuracy: 0.8282
[train epoch 2] loss: 1.201, acc: 0.599: 100%|█| 366/366 [00:30<00:00, 11.85it/s
[valid epoch 2] loss: 0.757, acc: 0.803: 100%|██| 91/91 [00:05<00:00, 16.01it/s]
[train epoch 3] loss: 1.205, acc: 0.595: 100%|█| 366/366 [00:31<00:00, 11.51it/s
[valid epoch 3] loss: 0.748, acc: 0.795: 100%|██| 91/91 [00:05<00:00, 16.20it/s]
[train epoch 4] loss: 1.158, acc: 0.613: 100%|█| 366/366 [00:32<00:00, 11.32it/s
[valid epoch 4] loss: 0.679, acc: 0.832: 100%|██| 91/91 [00:05<00:00, 16.30it/s]
Best model (head+MLP+last3Attn Stage 1) saved with accuracy: 0.8323
[train epoch 5] loss: 1.153, acc: 0.617: 100%|█| 366/366 [00:31<00:00, 11.72it/s
[valid epoch 5] loss: 0.680, acc: 0.841: 100%|██| 91/91 [00:05<00:00, 16.27it/s]
Best model (head+MLP+last3Attn Stage 1) saved with accuracy: 0.8412
[train epoch 6] loss: 1.186, acc: 0.604: 100%|█| 366/366 [00:31<00:00, 11.76it/s
[valid epoch 6] loss: 0.670, acc: 0.836: 100%|██| 91/91 [00:05<00:00, 16.46it/s]
[train epoch 7] loss: 1.125, acc: 0.631: 100%|█| 366/366 [00:31<00:00, 11.69it/s
[valid epoch 7] loss: 0.632, acc: 0.847: 100%|██| 91/91 [00:05<00:00, 16.56it/s]
Best model (head+MLP+last3Attn Stage 1) saved with accuracy: 0.8474
[train epoch 8] loss: 1.128, acc: 0.628: 100%|█| 366/366 [00:31<00:00, 11.57it/s
[valid epoch 8] loss: 0.621, acc: 0.840: 100%|██| 91/91 [00:05<00:00, 16.45it/s]
[train epoch 9] loss: 1.142, acc: 0.624: 100%|█| 366/366 [00:31<00:00, 11.71it/s
[valid epoch 9] loss: 0.595, acc: 0.858: 100%|██| 91/91 [00:05<00:00, 16.09it/s]
Best model (head+MLP+last3Attn Stage 1) saved with accuracy: 0.8577
[train epoch 10] loss: 1.087, acc: 0.642: 100%|█| 366/366 [00:31<00:00, 11.65it/
[valid epoch 10] loss: 0.596, acc: 0.854: 100%|█| 91/91 [00:05<00:00, 16.51it/s]
[train epoch 11] loss: 1.071, acc: 0.645: 100%|█| 366/366 [00:31<00:00, 11.56it/
[valid epoch 11] loss: 0.579, acc: 0.856: 100%|█| 91/91 [00:05<00:00, 16.06it/s]
[train epoch 12] loss: 1.031, acc: 0.663: 100%|█| 366/366 [00:32<00:00, 11.38it/
[valid epoch 12] loss: 0.563, acc: 0.851: 100%|█| 91/91 [00:05<00:00, 16.14it/s]
[train epoch 13] loss: 1.063, acc: 0.651: 100%|█| 366/366 [00:31<00:00, 11.61it/
[valid epoch 13] loss: 0.553, acc: 0.862: 100%|█| 91/91 [00:05<00:00, 16.38it/s]
Best model (head+MLP+last3Attn Stage 1) saved with accuracy: 0.8619
[train epoch 14] loss: 1.053, acc: 0.649: 100%|█| 366/366 [00:33<00:00, 10.82it/
[valid epoch 14] loss: 0.535, acc: 0.872: 100%|█| 91/91 [00:05<00:00, 16.29it/s]
Best model (head+MLP+last3Attn Stage 1) saved with accuracy: 0.8722
[train epoch 15] loss: 1.041, acc: 0.661: 100%|█| 366/366 [00:31<00:00, 11.53it/
[valid epoch 15] loss: 0.524, acc: 0.882: 100%|█| 91/91 [00:05<00:00, 16.16it/s]
Best model (head+MLP+last3Attn Stage 1) saved with accuracy: 0.8818
[train epoch 16] loss: 1.035, acc: 0.658: 100%|█| 366/366 [00:31<00:00, 11.69it/
[valid epoch 16] loss: 0.506, acc: 0.885: 100%|█| 91/91 [00:05<00:00, 16.42it/s]
Best model (head+MLP+last3Attn Stage 1) saved with accuracy: 0.8852
[train epoch 17] loss: 1.030, acc: 0.662: 100%|█| 366/366 [00:30<00:00, 11.81it/
[valid epoch 17] loss: 0.512, acc: 0.891: 100%|█| 91/91 [00:05<00:00, 16.57it/s]
Best model (head+MLP+last3Attn Stage 1) saved with accuracy: 0.8907
[train epoch 18] loss: 1.023, acc: 0.664: 100%|█| 366/366 [00:32<00:00, 11.36it/
[valid epoch 18] loss: 0.501, acc: 0.891: 100%|█| 91/91 [00:05<00:00, 16.51it/s]
[train epoch 19] loss: 1.011, acc: 0.667: 100%|█| 366/366 [00:33<00:00, 10.98it/
[valid epoch 19] loss: 0.495, acc: 0.892: 100%|█| 91/91 [00:05<00:00, 16.46it/s]
Best model (head+MLP+last3Attn Stage 1) saved with accuracy: 0.8921
[train epoch 20] loss: 0.989, acc: 0.674: 100%|█| 366/366 [00:33<00:00, 11.06it/
[valid epoch 20] loss: 0.491, acc: 0.893: 100%|█| 91/91 [00:05<00:00, 16.45it/s]
Best model (head+MLP+last3Attn Stage 1) saved with accuracy: 0.8928
[train epoch 21] loss: 1.016, acc: 0.665: 100%|█| 366/366 [00:31<00:00, 11.53it/
[valid epoch 21] loss: 0.491, acc: 0.896: 100%|█| 91/91 [00:05<00:00, 16.65it/s]
Best model (head+MLP+last3Attn Stage 1) saved with accuracy: 0.8962
Stage 1 (head+MLP+last3Attn) finished. Best acc: 0.8962

=== QAT Stage 2 (6bit, head+MLP+last3Attn) ===
[train epoch 22] loss: 0.860, acc: 0.656: 100%|█| 366/366 [00:31<00:00, 11.60it/
[valid epoch 22] loss: 0.546, acc: 0.876: 100%|█| 91/91 [00:05<00:00, 16.71it/s]
Best model (head+MLP+last3Attn Stage 2) saved with accuracy: 0.8756
[train epoch 23] loss: 0.826, acc: 0.667: 100%|█| 366/366 [00:30<00:00, 11.81it/
[valid epoch 23] loss: 0.517, acc: 0.875: 100%|█| 91/91 [00:05<00:00, 16.76it/s]
[train epoch 24] loss: 0.843, acc: 0.663: 100%|█| 366/366 [00:31<00:00, 11.58it/
[valid epoch 24] loss: 0.518, acc: 0.885: 100%|█| 91/91 [00:05<00:00, 16.76it/s]
Best model (head+MLP+last3Attn Stage 2) saved with accuracy: 0.8845
[train epoch 25] loss: 0.821, acc: 0.669: 100%|█| 366/366 [00:30<00:00, 11.81it/
[valid epoch 25] loss: 0.529, acc: 0.879: 100%|█| 91/91 [00:05<00:00, 16.69it/s]
[train epoch 26] loss: 0.814, acc: 0.671: 100%|█| 366/366 [00:31<00:00, 11.75it/
[valid epoch 26] loss: 0.509, acc: 0.875: 100%|█| 91/91 [00:05<00:00, 16.71it/s]
[train epoch 27] loss: 0.830, acc: 0.664: 100%|█| 366/366 [00:30<00:00, 11.85it/
[valid epoch 27] loss: 0.519, acc: 0.885: 100%|█| 91/91 [00:05<00:00, 16.76it/s]
Best model (head+MLP+last3Attn Stage 2) saved with accuracy: 0.8852
[train epoch 28] loss: 0.835, acc: 0.659: 100%|█| 366/366 [00:31<00:00, 11.69it/
[valid epoch 28] loss: 0.517, acc: 0.882: 100%|█| 91/91 [00:05<00:00, 16.74it/s]
[train epoch 29] loss: 0.805, acc: 0.677: 100%|█| 366/366 [00:30<00:00, 11.87it/
[valid epoch 29] loss: 0.515, acc: 0.882: 100%|█| 91/91 [00:05<00:00, 16.56it/s]
[train epoch 30] loss: 0.820, acc: 0.668: 100%|█| 366/366 [00:31<00:00, 11.80it/
[valid epoch 30] loss: 0.516, acc: 0.880: 100%|█| 91/91 [00:05<00:00, 16.65it/s]
[train epoch 31] loss: 0.810, acc: 0.675: 100%|█| 366/366 [00:31<00:00, 11.68it/
[valid epoch 31] loss: 0.502, acc: 0.887: 100%|█| 91/91 [00:05<00:00, 16.61it/s]
Best model (head+MLP+last3Attn Stage 2) saved with accuracy: 0.8866
[train epoch 32] loss: 0.817, acc: 0.667: 100%|█| 366/366 [00:31<00:00, 11.61it/
[valid epoch 32] loss: 0.511, acc: 0.883: 100%|█| 91/91 [00:05<00:00, 16.58it/s]
[train epoch 33] loss: 0.736, acc: 0.649: 100%|█| 366/366 [00:32<00:00, 11.35it/
[valid epoch 33] loss: 0.503, acc: 0.890: 100%|█| 91/91 [00:05<00:00, 16.50it/s]
Best model (head+MLP+last3Attn Stage 2) saved with accuracy: 0.8900
[train epoch 34] loss: 0.725, acc: 0.665: 100%|█| 366/366 [00:31<00:00, 11.56it/
[valid epoch 34] loss: 0.497, acc: 0.891: 100%|█| 91/91 [00:05<00:00, 16.65it/s]
Best model (head+MLP+last3Attn Stage 2) saved with accuracy: 0.8914
[train epoch 35] loss: 0.683, acc: 0.686: 100%|█| 366/366 [00:31<00:00, 11.63it/
[valid epoch 35] loss: 0.481, acc: 0.900: 100%|█| 91/91 [00:05<00:00, 16.56it/s]
Best model (head+MLP+last3Attn Stage 2) saved with accuracy: 0.9003
[train epoch 36] loss: 0.708, acc: 0.668: 100%|█| 366/366 [00:31<00:00, 11.67it/
[valid epoch 36] loss: 0.492, acc: 0.899: 100%|█| 91/91 [00:05<00:00, 16.74it/s]
[train epoch 37] loss: 0.684, acc: 0.687: 100%|█| 366/366 [00:31<00:00, 11.64it/
[valid epoch 37] loss: 0.476, acc: 0.896: 100%|█| 91/91 [00:05<00:00, 16.23it/s]
[train epoch 38] loss: 0.695, acc: 0.673: 100%|█| 366/366 [00:31<00:00, 11.72it/
[valid epoch 38] loss: 0.487, acc: 0.892: 100%|█| 91/91 [00:05<00:00, 16.71it/s]
[train epoch 39] loss: 0.690, acc: 0.675: 100%|█| 366/366 [00:31<00:00, 11.46it/
[valid epoch 39] loss: 0.478, acc: 0.900: 100%|█| 91/91 [00:05<00:00, 16.67it/s]
[train epoch 40] loss: 0.694, acc: 0.674: 100%|█| 366/366 [00:32<00:00, 11.38it/
[valid epoch 40] loss: 0.481, acc: 0.895: 100%|█| 91/91 [00:06<00:00, 14.94it/s]
[train epoch 41] loss: 0.699, acc: 0.670: 100%|█| 366/366 [00:31<00:00, 11.69it/
[valid epoch 41] loss: 0.481, acc: 0.898: 100%|█| 91/91 [00:05<00:00, 16.56it/s]
[train epoch 42] loss: 0.690, acc: 0.679: 100%|█| 366/366 [00:32<00:00, 11.43it/
[valid epoch 42] loss: 0.477, acc: 0.896: 100%|█| 91/91 [00:05<00:00, 16.58it/s]
[train epoch 43] loss: 0.686, acc: 0.677: 100%|█| 366/366 [00:31<00:00, 11.59it/
[valid epoch 43] loss: 0.478, acc: 0.896: 100%|█| 91/91 [00:05<00:00, 16.76it/s]
[train epoch 44] loss: 0.695, acc: 0.670: 100%|█| 366/366 [00:31<00:00, 11.62it/
[valid epoch 44] loss: 0.480, acc: 0.895: 100%|█| 91/91 [00:05<00:00, 16.69it/s]
[train epoch 45] loss: 0.691, acc: 0.675: 100%|█| 366/366 [00:31<00:00, 11.56it/
[valid epoch 45] loss: 0.478, acc: 0.900: 100%|█| 91/91 [00:05<00:00, 16.59it/s]
[train epoch 46] loss: 0.687, acc: 0.676: 100%|█| 366/366 [00:31<00:00, 11.56it/
[valid epoch 46] loss: 0.479, acc: 0.900: 100%|█| 91/91 [00:05<00:00, 16.73it/s]
Stage 2 (head+MLP+last3Attn) finished. Best acc: 0.9003

=== QAT Stage 3 (4bit, head+MLP+last3Attn) ===
[train epoch 47] loss: 0.549, acc: 0.570: 100%|█| 366/366 [00:31<00:00, 11.67it/
[valid epoch 47] loss: 0.763, acc: 0.808: 100%|█| 91/91 [00:05<00:00, 16.57it/s]
Best model (head+MLP+last3Attn Stage 3) saved with accuracy: 0.8082
[train epoch 48] loss: 0.467, acc: 0.608: 100%|█| 366/366 [00:31<00:00, 11.47it/
[valid epoch 48] loss: 0.732, acc: 0.823: 100%|█| 91/91 [00:05<00:00, 16.48it/s]
Best model (head+MLP+last3Attn Stage 3) saved with accuracy: 0.8227
[train epoch 49] loss: 0.456, acc: 0.602: 100%|█| 366/366 [00:31<00:00, 11.62it/
[valid epoch 49] loss: 0.708, acc: 0.832: 100%|█| 91/91 [00:05<00:00, 16.72it/s]
Best model (head+MLP+last3Attn Stage 3) saved with accuracy: 0.8323
[train epoch 50] loss: 0.443, acc: 0.606: 100%|█| 366/366 [00:32<00:00, 11.38it/
[valid epoch 50] loss: 0.708, acc: 0.829: 100%|█| 91/91 [00:05<00:00, 16.68it/s]
[train epoch 51] loss: 0.449, acc: 0.596: 100%|█| 366/366 [00:31<00:00, 11.54it/
[valid epoch 51] loss: 0.715, acc: 0.824: 100%|█| 91/91 [00:05<00:00, 16.61it/s]
[train epoch 52] loss: 0.422, acc: 0.612: 100%|█| 366/366 [00:31<00:00, 11.68it/
[valid epoch 52] loss: 0.698, acc: 0.823: 100%|█| 91/91 [00:05<00:00, 16.63it/s]
[train epoch 53] loss: 0.421, acc: 0.614: 100%|█| 366/366 [00:31<00:00, 11.66it/
[valid epoch 53] loss: 0.696, acc: 0.824: 100%|█| 91/91 [00:05<00:00, 16.23it/s]
[train epoch 54] loss: 0.417, acc: 0.620: 100%|█| 366/366 [00:30<00:00, 11.93it/
[valid epoch 54] loss: 0.673, acc: 0.838: 100%|█| 91/91 [00:05<00:00, 16.43it/s]
Best model (head+MLP+last3Attn Stage 3) saved with accuracy: 0.8378
[train epoch 55] loss: 0.423, acc: 0.607: 100%|█| 366/366 [00:31<00:00, 11.79it/
[valid epoch 55] loss: 0.671, acc: 0.829: 100%|█| 91/91 [00:05<00:00, 16.34it/s]
[train epoch 56] loss: 0.419, acc: 0.610: 100%|█| 366/366 [00:31<00:00, 11.60it/
[valid epoch 56] loss: 0.662, acc: 0.834: 100%|█| 91/91 [00:05<00:00, 16.61it/s]
[train epoch 57] loss: 0.403, acc: 0.624: 100%|█| 366/366 [00:31<00:00, 11.49it/
[valid epoch 57] loss: 0.657, acc: 0.824: 100%|█| 91/91 [00:05<00:00, 16.68it/s]
[train epoch 58] loss: 0.402, acc: 0.611: 100%|█| 366/366 [00:31<00:00, 11.59it/
[valid epoch 58] loss: 0.642, acc: 0.841: 100%|█| 91/91 [00:05<00:00, 16.59it/s]
Best model (head+MLP+last3Attn Stage 3) saved with accuracy: 0.8412
[train epoch 59] loss: 0.392, acc: 0.631: 100%|█| 366/366 [00:31<00:00, 11.52it/
[valid epoch 59] loss: 0.648, acc: 0.834: 100%|█| 91/91 [00:05<00:00, 16.78it/s]
[train epoch 60] loss: 0.406, acc: 0.608: 100%|█| 366/366 [00:31<00:00, 11.55it/
[valid epoch 60] loss: 0.656, acc: 0.840: 100%|█| 91/91 [00:05<00:00, 16.50it/s]
[train epoch 61] loss: 0.556, acc: 0.608: 100%|█| 366/366 [00:33<00:00, 10.79it/
[valid epoch 61] loss: 0.640, acc: 0.839: 100%|█| 91/91 [00:06<00:00, 13.88it/s]
[train epoch 62] loss: 0.536, acc: 0.628: 100%|█| 366/366 [00:31<00:00, 11.53it/
[valid epoch 62] loss: 0.628, acc: 0.836: 100%|█| 91/91 [00:05<00:00, 16.27it/s]
[train epoch 63] loss: 0.538, acc: 0.616: 100%|█| 366/366 [00:32<00:00, 11.41it/
[valid epoch 63] loss: 0.626, acc: 0.836: 100%|█| 91/91 [00:05<00:00, 16.81it/s]
[train epoch 64] loss: 0.524, acc: 0.640: 100%|█| 366/366 [00:47<00:00,  7.64it/
[valid epoch 64] loss: 0.619, acc: 0.844: 100%|█| 91/91 [00:08<00:00, 10.43it/s]
Best model (head+MLP+last3Attn Stage 3) saved with accuracy: 0.8440
[train epoch 65] loss: 0.511, acc: 0.643: 100%|█| 366/366 [00:48<00:00,  7.51it/
[valid epoch 65] loss: 0.614, acc: 0.838: 100%|█| 91/91 [00:07<00:00, 11.86it/s]
[train epoch 66] loss: 0.530, acc: 0.623: 100%|█| 366/366 [00:32<00:00, 11.30it/
[valid epoch 66] loss: 0.609, acc: 0.847: 100%|█| 91/91 [00:16<00:00,  5.60it/s]
Best model (head+MLP+last3Attn Stage 3) saved with accuracy: 0.8467
[train epoch 67] loss: 0.512, acc: 0.636: 100%|█| 366/366 [00:33<00:00, 10.98it/
[valid epoch 67] loss: 0.608, acc: 0.847: 100%|█| 91/91 [00:05<00:00, 16.67it/s]
Best model (head+MLP+last3Attn Stage 3) saved with accuracy: 0.8474
[train epoch 68] loss: 0.515, acc: 0.640: 100%|█| 366/366 [00:41<00:00,  8.90it/
[valid epoch 68] loss: 0.604, acc: 0.845: 100%|█| 91/91 [00:05<00:00, 16.57it/s]
[train epoch 69] loss: 0.510, acc: 0.637: 100%|█| 366/366 [00:33<00:00, 11.09it/
[valid epoch 69] loss: 0.606, acc: 0.845: 100%|█| 91/91 [00:05<00:00, 16.45it/s]
[train epoch 70] loss: 0.521, acc: 0.623: 100%|█| 366/366 [00:32<00:00, 11.10it/
[valid epoch 70] loss: 0.597, acc: 0.849: 100%|█| 91/91 [00:05<00:00, 16.42it/s]
Best model (head+MLP+last3Attn Stage 3) saved with accuracy: 0.8488
[train epoch 71] loss: 0.514, acc: 0.630: 100%|█| 366/366 [00:33<00:00, 11.02it/
[valid epoch 71] loss: 0.596, acc: 0.847: 100%|█| 91/91 [00:05<00:00, 16.61it/s]
[train epoch 72] loss: 0.518, acc: 0.634: 100%|█| 366/366 [00:34<00:00, 10.70it/
[valid epoch 72] loss: 0.595, acc: 0.845: 100%|█| 91/91 [00:05<00:00, 15.91it/s]
[train epoch 73] loss: 0.498, acc: 0.651: 100%|█| 366/366 [00:33<00:00, 11.07it/
[valid epoch 73] loss: 0.592, acc: 0.845: 100%|█| 91/91 [00:12<00:00,  7.58it/s]
[train epoch 74] loss: 0.490, acc: 0.654: 100%|█| 366/366 [00:34<00:00, 10.68it/
[valid epoch 74] loss: 0.592, acc: 0.848: 100%|█| 91/91 [00:05<00:00, 16.16it/s]
Stage 3 (head+MLP+last3Attn) finished. Best acc: 0.8488
Progressive QAT completed. Best validation accuracy: 0.9003

==== Sweep 4: head+MLP+last4Attn ====

=== QAT Stage 1 (8bit, head+MLP+last4Attn) ===
[train epoch 0] loss: 1.345, acc: 0.538: 100%|█| 366/366 [00:40<00:00,  9.14it/s
[valid epoch 0] loss: 0.792, acc: 0.779: 100%|██| 91/91 [00:05<00:00, 16.20it/s]
Best model (head+MLP+last4Attn Stage 1) saved with accuracy: 0.7794
[train epoch 1] loss: 1.289, acc: 0.566: 100%|█| 366/366 [00:38<00:00,  9.62it/s
[valid epoch 1] loss: 0.760, acc: 0.793: 100%|██| 91/91 [00:05<00:00, 16.27it/s]
Best model (head+MLP+last4Attn Stage 1) saved with accuracy: 0.7931
[train epoch 2] loss: 1.266, acc: 0.574: 100%|█| 366/366 [00:32<00:00, 11.12it/s
[valid epoch 2] loss: 0.779, acc: 0.788: 100%|██| 91/91 [00:05<00:00, 16.24it/s]
[train epoch 3] loss: 1.226, acc: 0.591: 100%|█| 366/366 [00:35<00:00, 10.27it/s
[valid epoch 3] loss: 0.744, acc: 0.804: 100%|██| 91/91 [00:05<00:00, 16.52it/s]
Best model (head+MLP+last4Attn Stage 1) saved with accuracy: 0.8041
[train epoch 4] loss: 1.236, acc: 0.584: 100%|█| 366/366 [00:32<00:00, 11.12it/s
[valid epoch 4] loss: 0.714, acc: 0.801: 100%|██| 91/91 [00:05<00:00, 16.58it/s]
[train epoch 5] loss: 1.216, acc: 0.589: 100%|█| 366/366 [00:32<00:00, 11.28it/s
[valid epoch 5] loss: 0.715, acc: 0.814: 100%|██| 91/91 [00:05<00:00, 16.24it/s]
Best model (head+MLP+last4Attn Stage 1) saved with accuracy: 0.8137
[train epoch 6] loss: 1.184, acc: 0.608: 100%|█| 366/366 [00:33<00:00, 10.90it/s
[valid epoch 6] loss: 0.686, acc: 0.821: 100%|██| 91/91 [00:05<00:00, 16.57it/s]
Best model (head+MLP+last4Attn Stage 1) saved with accuracy: 0.8213
[train epoch 7] loss: 1.217, acc: 0.590: 100%|█| 366/366 [00:32<00:00, 11.25it/s
[valid epoch 7] loss: 0.683, acc: 0.834: 100%|██| 91/91 [00:05<00:00, 16.56it/s]
Best model (head+MLP+last4Attn Stage 1) saved with accuracy: 0.8344
[train epoch 8] loss: 1.146, acc: 0.621: 100%|█| 366/366 [00:32<00:00, 11.20it/s
[valid epoch 8] loss: 0.665, acc: 0.830: 100%|██| 91/91 [00:05<00:00, 16.81it/s]
[train epoch 9] loss: 1.163, acc: 0.614: 100%|█| 366/366 [00:33<00:00, 11.08it/s
[valid epoch 9] loss: 0.703, acc: 0.818: 100%|██| 91/91 [00:05<00:00, 16.73it/s]
[train epoch 10] loss: 1.160, acc: 0.611: 100%|█| 366/366 [00:32<00:00, 11.09it/
[valid epoch 10] loss: 0.641, acc: 0.829: 100%|█| 91/91 [00:05<00:00, 16.86it/s]
[train epoch 11] loss: 1.142, acc: 0.619: 100%|█| 366/366 [00:32<00:00, 11.10it/
[valid epoch 11] loss: 0.629, acc: 0.838: 100%|█| 91/91 [00:05<00:00, 16.73it/s]
Best model (head+MLP+last4Attn Stage 1) saved with accuracy: 0.8385
[train epoch 12] loss: 1.091, acc: 0.642: 100%|█| 366/366 [00:33<00:00, 11.09it/
[valid epoch 12] loss: 0.627, acc: 0.835: 100%|█| 91/91 [00:05<00:00, 16.76it/s]
[train epoch 13] loss: 1.097, acc: 0.635: 100%|█| 366/366 [00:33<00:00, 11.02it/
[valid epoch 13] loss: 0.608, acc: 0.848: 100%|█| 91/91 [00:05<00:00, 16.84it/s]
Best model (head+MLP+last4Attn Stage 1) saved with accuracy: 0.8481
[train epoch 14] loss: 1.076, acc: 0.646: 100%|█| 366/366 [00:32<00:00, 11.19it/
[valid epoch 14] loss: 0.601, acc: 0.853: 100%|█| 91/91 [00:05<00:00, 16.71it/s]
Best model (head+MLP+last4Attn Stage 1) saved with accuracy: 0.8529
[train epoch 15] loss: 1.045, acc: 0.658: 100%|█| 366/366 [00:32<00:00, 11.23it/
[valid epoch 15] loss: 0.582, acc: 0.853: 100%|█| 91/91 [00:05<00:00, 16.65it/s]
[train epoch 16] loss: 1.039, acc: 0.661: 100%|█| 366/366 [00:32<00:00, 11.29it/
[valid epoch 16] loss: 0.574, acc: 0.860: 100%|█| 91/91 [00:05<00:00, 16.47it/s]
Best model (head+MLP+last4Attn Stage 1) saved with accuracy: 0.8598
[train epoch 17] loss: 1.035, acc: 0.661: 100%|█| 366/366 [00:33<00:00, 10.97it/
[valid epoch 17] loss: 0.557, acc: 0.860: 100%|█| 91/91 [00:05<00:00, 16.83it/s]
[train epoch 18] loss: 1.075, acc: 0.646: 100%|█| 366/366 [00:33<00:00, 11.07it/
[valid epoch 18] loss: 0.556, acc: 0.860: 100%|█| 91/91 [00:05<00:00, 16.73it/s]
[train epoch 19] loss: 1.039, acc: 0.658: 100%|█| 366/366 [00:33<00:00, 11.04it/
[valid epoch 19] loss: 0.556, acc: 0.850: 100%|█| 91/91 [00:05<00:00, 16.85it/s]
[train epoch 20] loss: 1.016, acc: 0.665: 100%|█| 366/366 [00:32<00:00, 11.31it/
[valid epoch 20] loss: 0.536, acc: 0.874: 100%|█| 91/91 [00:05<00:00, 16.24it/s]
Best model (head+MLP+last4Attn Stage 1) saved with accuracy: 0.8735
[train epoch 21] loss: 1.018, acc: 0.667: 100%|█| 366/366 [00:32<00:00, 11.25it/
[valid epoch 21] loss: 0.530, acc: 0.869: 100%|█| 91/91 [00:05<00:00, 16.78it/s]
[train epoch 22] loss: 1.012, acc: 0.665: 100%|█| 366/366 [00:32<00:00, 11.34it/
[valid epoch 22] loss: 0.529, acc: 0.867: 100%|█| 91/91 [00:05<00:00, 16.70it/s]
[train epoch 23] loss: 0.997, acc: 0.675: 100%|█| 366/366 [00:32<00:00, 11.16it/
[valid epoch 23] loss: 0.526, acc: 0.869: 100%|█| 91/91 [00:05<00:00, 16.87it/s]
[train epoch 24] loss: 1.002, acc: 0.669: 100%|█| 366/366 [00:31<00:00, 11.54it/
[valid epoch 24] loss: 0.523, acc: 0.866: 100%|█| 91/91 [00:05<00:00, 16.80it/s]
Stage 1 (head+MLP+last4Attn) finished. Best acc: 0.8735

=== QAT Stage 2 (6bit, head+MLP+last4Attn) ===
[train epoch 25] loss: 0.852, acc: 0.662: 100%|█| 366/366 [00:32<00:00, 11.40it/
[valid epoch 25] loss: 0.557, acc: 0.863: 100%|█| 91/91 [00:05<00:00, 16.81it/s]
Best model (head+MLP+last4Attn Stage 2) saved with accuracy: 0.8632
[train epoch 26] loss: 0.847, acc: 0.654: 100%|█| 366/366 [00:31<00:00, 11.48it/
[valid epoch 26] loss: 0.558, acc: 0.854: 100%|█| 91/91 [00:05<00:00, 16.72it/s]
[train epoch 27] loss: 0.869, acc: 0.643: 100%|█| 366/366 [00:32<00:00, 11.20it/
[valid epoch 27] loss: 0.548, acc: 0.865: 100%|█| 91/91 [00:05<00:00, 16.55it/s]
Best model (head+MLP+last4Attn Stage 2) saved with accuracy: 0.8646
[train epoch 28] loss: 0.853, acc: 0.652: 100%|█| 366/366 [00:32<00:00, 11.35it/
[valid epoch 28] loss: 0.550, acc: 0.867: 100%|█| 91/91 [00:05<00:00, 16.56it/s]
Best model (head+MLP+last4Attn Stage 2) saved with accuracy: 0.8667
[train epoch 29] loss: 0.846, acc: 0.652: 100%|█| 366/366 [00:33<00:00, 10.95it/
[valid epoch 29] loss: 0.545, acc: 0.854: 100%|█| 91/91 [00:05<00:00, 16.62it/s]
[train epoch 30] loss: 0.856, acc: 0.648: 100%|█| 366/366 [00:33<00:00, 11.09it/
[valid epoch 30] loss: 0.558, acc: 0.858: 100%|█| 91/91 [00:05<00:00, 16.71it/s]
[train epoch 31] loss: 0.840, acc: 0.659: 100%|█| 366/366 [00:32<00:00, 11.26it/
[valid epoch 31] loss: 0.533, acc: 0.878: 100%|█| 91/91 [00:05<00:00, 16.72it/s]
Best model (head+MLP+last4Attn Stage 2) saved with accuracy: 0.8777
[train epoch 32] loss: 0.847, acc: 0.656: 100%|█| 366/366 [00:32<00:00, 11.26it/
[valid epoch 32] loss: 0.538, acc: 0.869: 100%|█| 91/91 [00:05<00:00, 16.72it/s]
[train epoch 33] loss: 0.814, acc: 0.664: 100%|█| 366/366 [00:32<00:00, 11.14it/
[valid epoch 33] loss: 0.545, acc: 0.862: 100%|█| 91/91 [00:05<00:00, 16.57it/s]
[train epoch 34] loss: 0.815, acc: 0.671: 100%|█| 366/366 [00:33<00:00, 11.03it/
[valid epoch 34] loss: 0.531, acc: 0.868: 100%|█| 91/91 [00:05<00:00, 16.71it/s]
[train epoch 35] loss: 0.813, acc: 0.673: 100%|█| 366/366 [00:33<00:00, 10.87it/
[valid epoch 35] loss: 0.525, acc: 0.866: 100%|█| 91/91 [00:05<00:00, 16.73it/s]
[train epoch 36] loss: 0.744, acc: 0.657: 100%|█| 366/366 [00:34<00:00, 10.60it/
[valid epoch 36] loss: 0.547, acc: 0.862: 100%|█| 91/91 [00:05<00:00, 16.55it/s]
[train epoch 37] loss: 0.717, acc: 0.666: 100%|█| 366/366 [00:33<00:00, 11.00it/
[valid epoch 37] loss: 0.527, acc: 0.871: 100%|█| 91/91 [00:05<00:00, 16.53it/s]
[train epoch 38] loss: 0.720, acc: 0.664: 100%|█| 366/366 [00:32<00:00, 11.24it/
[valid epoch 38] loss: 0.529, acc: 0.867: 100%|█| 91/91 [00:05<00:00, 16.18it/s]
[train epoch 39] loss: 0.712, acc: 0.668: 100%|█| 366/366 [00:32<00:00, 11.19it/
[valid epoch 39] loss: 0.526, acc: 0.867: 100%|█| 91/91 [00:05<00:00, 16.64it/s]
[train epoch 40] loss: 0.705, acc: 0.671: 100%|█| 366/366 [00:32<00:00, 11.09it/
[valid epoch 40] loss: 0.519, acc: 0.869: 100%|█| 91/91 [00:05<00:00, 16.72it/s]
[train epoch 41] loss: 0.716, acc: 0.665: 100%|█| 366/366 [00:32<00:00, 11.42it/
[valid epoch 41] loss: 0.523, acc: 0.878: 100%|█| 91/91 [00:05<00:00, 16.70it/s]
Best model (head+MLP+last4Attn Stage 2) saved with accuracy: 0.8784
[train epoch 42] loss: 0.715, acc: 0.660: 100%|█| 366/366 [00:31<00:00, 11.59it/
[valid epoch 42] loss: 0.519, acc: 0.878: 100%|█| 91/91 [00:05<00:00, 16.85it/s]
[train epoch 43] loss: 0.685, acc: 0.682: 100%|█| 366/366 [00:31<00:00, 11.48it/
[valid epoch 43] loss: 0.512, acc: 0.881: 100%|█| 91/91 [00:05<00:00, 16.77it/s]
Best model (head+MLP+last4Attn Stage 2) saved with accuracy: 0.8811
[train epoch 44] loss: 0.697, acc: 0.675: 100%|█| 366/366 [00:31<00:00, 11.52it/
[valid epoch 44] loss: 0.507, acc: 0.881: 100%|█| 91/91 [00:05<00:00, 16.75it/s]
[train epoch 45] loss: 0.710, acc: 0.667: 100%|█| 366/366 [00:32<00:00, 11.22it/
[valid epoch 45] loss: 0.508, acc: 0.882: 100%|█| 91/91 [00:05<00:00, 16.68it/s]
Best model (head+MLP+last4Attn Stage 2) saved with accuracy: 0.8818
[train epoch 46] loss: 0.718, acc: 0.664: 100%|█| 366/366 [00:33<00:00, 10.94it/
[valid epoch 46] loss: 0.510, acc: 0.883: 100%|█| 91/91 [00:05<00:00, 16.28it/s]
Best model (head+MLP+last4Attn Stage 2) saved with accuracy: 0.8832
[train epoch 47] loss: 0.683, acc: 0.687: 100%|█| 366/366 [00:32<00:00, 11.35it/
[valid epoch 47] loss: 0.507, acc: 0.880: 100%|█| 91/91 [00:05<00:00, 16.38it/s]
[train epoch 48] loss: 0.720, acc: 0.662: 100%|█| 366/366 [00:31<00:00, 11.64it/
[valid epoch 48] loss: 0.510, acc: 0.882: 100%|█| 91/91 [00:05<00:00, 16.51it/s]
[train epoch 49] loss: 0.687, acc: 0.680: 100%|█| 366/366 [00:31<00:00, 11.67it/
[valid epoch 49] loss: 0.508, acc: 0.882: 100%|█| 91/91 [00:05<00:00, 16.45it/s]
Stage 2 (head+MLP+last4Attn) finished. Best acc: 0.8832

=== QAT Stage 3 (4bit, head+MLP+last4Attn) ===
[train epoch 50] loss: 0.565, acc: 0.554: 100%|█| 366/366 [00:31<00:00, 11.76it/
[valid epoch 50] loss: 0.786, acc: 0.791: 100%|█| 91/91 [00:05<00:00, 16.44it/s]
Best model (head+MLP+last4Attn Stage 3) saved with accuracy: 0.7911
[train epoch 51] loss: 0.503, acc: 0.577: 100%|█| 366/366 [00:31<00:00, 11.73it/
[valid epoch 51] loss: 0.792, acc: 0.790: 100%|█| 91/91 [00:05<00:00, 16.67it/s]
[train epoch 52] loss: 0.473, acc: 0.596: 100%|█| 366/366 [00:31<00:00, 11.74it/
[valid epoch 52] loss: 0.780, acc: 0.796: 100%|█| 91/91 [00:05<00:00, 16.56it/s]
Best model (head+MLP+last4Attn Stage 3) saved with accuracy: 0.7959
[train epoch 53] loss: 0.468, acc: 0.583: 100%|█| 366/366 [00:31<00:00, 11.46it/
[valid epoch 53] loss: 0.730, acc: 0.811: 100%|█| 91/91 [00:05<00:00, 16.59it/s]
Best model (head+MLP+last4Attn Stage 3) saved with accuracy: 0.8110
[train epoch 54] loss: 0.452, acc: 0.594: 100%|█| 366/366 [00:31<00:00, 11.64it/
[valid epoch 54] loss: 0.740, acc: 0.802: 100%|█| 91/91 [00:05<00:00, 16.60it/s]
[train epoch 55] loss: 0.451, acc: 0.603: 100%|█| 366/366 [00:31<00:00, 11.54it/
[valid epoch 55] loss: 0.745, acc: 0.797: 100%|█| 91/91 [00:05<00:00, 16.50it/s]
[train epoch 56] loss: 0.442, acc: 0.605: 100%|█| 366/366 [00:32<00:00, 11.42it/
[valid epoch 56] loss: 0.710, acc: 0.812: 100%|█| 91/91 [00:05<00:00, 16.18it/s]
Best model (head+MLP+last4Attn Stage 3) saved with accuracy: 0.8124
[train epoch 57] loss: 0.441, acc: 0.600: 100%|█| 366/366 [00:31<00:00, 11.76it/
[valid epoch 57] loss: 0.732, acc: 0.811: 100%|█| 91/91 [00:05<00:00, 16.42it/s]
[train epoch 58] loss: 0.426, acc: 0.609: 100%|█| 366/366 [00:32<00:00, 11.42it/
[valid epoch 58] loss: 0.713, acc: 0.812: 100%|█| 91/91 [00:05<00:00, 16.59it/s]
[train epoch 59] loss: 0.428, acc: 0.604: 100%|█| 366/366 [00:33<00:00, 10.90it/
[valid epoch 59] loss: 0.704, acc: 0.803: 100%|█| 91/91 [00:05<00:00, 16.55it/s]
[train epoch 60] loss: 0.425, acc: 0.600: 100%|█| 366/366 [00:32<00:00, 11.43it/
[valid epoch 60] loss: 0.725, acc: 0.798: 100%|█| 91/91 [00:05<00:00, 16.36it/s]
[train epoch 61] loss: 0.432, acc: 0.600: 100%|█| 366/366 [00:31<00:00, 11.50it/
[valid epoch 61] loss: 0.703, acc: 0.808: 100%|█| 91/91 [00:05<00:00, 16.20it/s]
[train epoch 62] loss: 0.412, acc: 0.605: 100%|█| 366/366 [00:31<00:00, 11.62it/
[valid epoch 62] loss: 0.704, acc: 0.811: 100%|█| 91/91 [00:05<00:00, 16.71it/s]
[train epoch 63] loss: 0.420, acc: 0.607: 100%|█| 366/366 [00:32<00:00, 11.17it/
[valid epoch 63] loss: 0.704, acc: 0.804: 100%|█| 91/91 [00:05<00:00, 16.17it/s]
[train epoch 64] loss: 0.414, acc: 0.603: 100%|█| 366/366 [00:31<00:00, 11.54it/
[valid epoch 64] loss: 0.697, acc: 0.808: 100%|█| 91/91 [00:05<00:00, 16.58it/s]
[train epoch 65] loss: 0.581, acc: 0.596: 100%|█| 366/366 [00:32<00:00, 11.33it/
[valid epoch 65] loss: 0.686, acc: 0.818: 100%|█| 91/91 [00:05<00:00, 16.40it/s]
Best model (head+MLP+last4Attn Stage 3) saved with accuracy: 0.8179
[train epoch 66] loss: 0.561, acc: 0.615: 100%|█| 366/366 [00:32<00:00, 11.39it/
[valid epoch 66] loss: 0.671, acc: 0.814: 100%|█| 91/91 [00:08<00:00, 10.93it/s]
[train epoch 67] loss: 0.552, acc: 0.611: 100%|█| 366/366 [00:34<00:00, 10.60it/
[valid epoch 67] loss: 0.679, acc: 0.815: 100%|█| 91/91 [00:05<00:00, 16.55it/s]
[train epoch 68] loss: 0.544, acc: 0.618: 100%|█| 366/366 [00:32<00:00, 11.16it/
[valid epoch 68] loss: 0.646, acc: 0.827: 100%|█| 91/91 [00:05<00:00, 16.45it/s]
Best model (head+MLP+last4Attn Stage 3) saved with accuracy: 0.8275
[train epoch 69] loss: 0.544, acc: 0.611: 100%|█| 366/366 [00:31<00:00, 11.56it/
[valid epoch 69] loss: 0.637, acc: 0.829: 100%|█| 91/91 [00:22<00:00,  3.99it/s]
Best model (head+MLP+last4Attn Stage 3) saved with accuracy: 0.8289
[train epoch 70] loss: 0.515, acc: 0.643: 100%|█| 366/366 [00:35<00:00, 10.34it/
[valid epoch 70] loss: 0.645, acc: 0.820: 100%|█| 91/91 [00:05<00:00, 16.41it/s]
[train epoch 71] loss: 0.553, acc: 0.612: 100%|█| 366/366 [00:31<00:00, 11.59it/
[valid epoch 71] loss: 0.640, acc: 0.828: 100%|█| 91/91 [00:05<00:00, 16.52it/s]
[train epoch 72] loss: 0.535, acc: 0.618: 100%|█| 366/366 [00:31<00:00, 11.70it/
[valid epoch 72] loss: 0.633, acc: 0.827: 100%|█| 91/91 [00:05<00:00, 16.62it/s]
[train epoch 73] loss: 0.533, acc: 0.628: 100%|█| 366/366 [00:31<00:00, 11.57it/
[valid epoch 73] loss: 0.636, acc: 0.831: 100%|█| 91/91 [00:05<00:00, 16.50it/s]
Best model (head+MLP+last4Attn Stage 3) saved with accuracy: 0.8309
[train epoch 74] loss: 0.516, acc: 0.636: 100%|█| 366/366 [00:31<00:00, 11.64it/
[valid epoch 74] loss: 0.626, acc: 0.832: 100%|█| 91/91 [00:05<00:00, 16.69it/s]
Best model (head+MLP+last4Attn Stage 3) saved with accuracy: 0.8316
[train epoch 75] loss: 0.529, acc: 0.623: 100%|█| 366/366 [00:32<00:00, 11.42it/
[valid epoch 75] loss: 0.632, acc: 0.825: 100%|█| 91/91 [00:05<00:00, 16.49it/s]
[train epoch 76] loss: 0.526, acc: 0.626: 100%|█| 366/366 [00:30<00:00, 11.84it/
[valid epoch 76] loss: 0.637, acc: 0.827: 100%|█| 91/91 [00:05<00:00, 16.57it/s]
[train epoch 77] loss: 0.521, acc: 0.632: 100%|█| 366/366 [00:49<00:00,  7.33it/
[valid epoch 77] loss: 0.632, acc: 0.827: 100%|█| 91/91 [00:05<00:00, 16.06it/s]
[train epoch 78] loss: 0.521, acc: 0.630: 100%|█| 366/366 [00:44<00:00,  8.19it/
[valid epoch 78] loss: 0.629, acc: 0.832: 100%|█| 91/91 [00:05<00:00, 16.00it/s]
Best model (head+MLP+last4Attn Stage 3) saved with accuracy: 0.8323
[train epoch 79] loss: 0.515, acc: 0.635: 100%|█| 366/366 [00:31<00:00, 11.64it/
[valid epoch 79] loss: 0.630, acc: 0.832: 100%|█| 91/91 [00:05<00:00, 16.45it/s]
Stage 3 (head+MLP+last4Attn) finished. Best acc: 0.8323
Progressive QAT completed. Best validation accuracy: 0.8832

==== Sweep 5: head+MLP+last5Attn ====

=== QAT Stage 1 (8bit, head+MLP+last5Attn) ===
[train epoch 0] loss: 1.487, acc: 0.475: 100%|█| 366/366 [00:32<00:00, 11.28it/s
[valid epoch 0] loss: 1.024, acc: 0.700: 100%|██| 91/91 [00:05<00:00, 16.54it/s]
Best model (head+MLP+last5Attn Stage 1) saved with accuracy: 0.6997
[train epoch 1] loss: 1.404, acc: 0.515: 100%|█| 366/366 [00:32<00:00, 11.29it/s
[valid epoch 1] loss: 0.962, acc: 0.729: 100%|██| 91/91 [00:05<00:00, 16.30it/s]
Best model (head+MLP+last5Attn Stage 1) saved with accuracy: 0.7285
[train epoch 2] loss: 1.363, acc: 0.528: 100%|█| 366/366 [00:39<00:00,  9.16it/s
[valid epoch 2] loss: 0.920, acc: 0.750: 100%|██| 91/91 [00:05<00:00, 16.20it/s]
Best model (head+MLP+last5Attn Stage 1) saved with accuracy: 0.7498
[train epoch 3] loss: 1.317, acc: 0.553: 100%|█| 366/366 [00:31<00:00, 11.53it/s
[valid epoch 3] loss: 0.886, acc: 0.745: 100%|██| 91/91 [00:05<00:00, 16.41it/s]
[train epoch 4] loss: 1.332, acc: 0.542: 100%|█| 366/366 [00:31<00:00, 11.51it/s
[valid epoch 4] loss: 0.926, acc: 0.740: 100%|██| 91/91 [00:05<00:00, 16.45it/s]
[train epoch 5] loss: 1.289, acc: 0.567: 100%|█| 366/366 [00:31<00:00, 11.44it/s
[valid epoch 5] loss: 0.884, acc: 0.754: 100%|██| 91/91 [00:05<00:00, 16.34it/s]
Best model (head+MLP+last5Attn Stage 1) saved with accuracy: 0.7540
[train epoch 6] loss: 1.312, acc: 0.554: 100%|█| 366/366 [00:31<00:00, 11.55it/s
[valid epoch 6] loss: 0.876, acc: 0.768: 100%|██| 91/91 [00:05<00:00, 16.46it/s]
Best model (head+MLP+last5Attn Stage 1) saved with accuracy: 0.7684
[train epoch 7] loss: 1.283, acc: 0.564: 100%|█| 366/366 [00:32<00:00, 11.26it/s
[valid epoch 7] loss: 0.837, acc: 0.768: 100%|██| 91/91 [00:05<00:00, 16.50it/s]
[train epoch 8] loss: 1.290, acc: 0.564: 100%|█| 366/366 [00:32<00:00, 11.27it/s
[valid epoch 8] loss: 0.816, acc: 0.785: 100%|██| 91/91 [00:05<00:00, 16.44it/s]
Best model (head+MLP+last5Attn Stage 1) saved with accuracy: 0.7849
[train epoch 9] loss: 1.294, acc: 0.557: 100%|█| 366/366 [00:32<00:00, 11.14it/s
[valid epoch 9] loss: 0.826, acc: 0.777: 100%|██| 91/91 [00:05<00:00, 16.34it/s]
[train epoch 10] loss: 1.260, acc: 0.572: 100%|█| 366/366 [00:39<00:00,  9.16it/
[valid epoch 10] loss: 0.807, acc: 0.772: 100%|█| 91/91 [00:05<00:00, 16.35it/s]
[train epoch 11] loss: 1.265, acc: 0.578: 100%|█| 366/366 [00:37<00:00,  9.70it/
[valid epoch 11] loss: 0.764, acc: 0.799: 100%|█| 91/91 [00:05<00:00, 15.47it/s]
Best model (head+MLP+last5Attn Stage 1) saved with accuracy: 0.7993
[train epoch 12] loss: 1.221, acc: 0.586: 100%|█| 366/366 [00:32<00:00, 11.26it/
[valid epoch 12] loss: 0.741, acc: 0.791: 100%|█| 91/91 [00:05<00:00, 16.21it/s]
[train epoch 13] loss: 1.237, acc: 0.581: 100%|█| 366/366 [00:32<00:00, 11.16it/
[valid epoch 13] loss: 0.815, acc: 0.768: 100%|█| 91/91 [00:05<00:00, 16.36it/s]
[train epoch 14] loss: 1.207, acc: 0.596: 100%|█| 366/366 [00:36<00:00, 10.10it/
[valid epoch 14] loss: 0.779, acc: 0.769: 100%|█| 91/91 [00:05<00:00, 15.84it/s]
[train epoch 15] loss: 1.233, acc: 0.583: 100%|█| 366/366 [00:32<00:00, 11.23it/
[valid epoch 15] loss: 0.734, acc: 0.795: 100%|█| 91/91 [00:05<00:00, 16.05it/s]
[train epoch 16] loss: 1.202, acc: 0.592: 100%|█| 366/366 [00:33<00:00, 10.81it/
[valid epoch 16] loss: 0.726, acc: 0.805: 100%|█| 91/91 [00:05<00:00, 16.11it/s]
Best model (head+MLP+last5Attn Stage 1) saved with accuracy: 0.8055
[train epoch 17] loss: 1.198, acc: 0.593: 100%|█| 366/366 [00:32<00:00, 11.10it/
[valid epoch 17] loss: 0.722, acc: 0.800: 100%|█| 91/91 [00:05<00:00, 16.35it/s]
[train epoch 18] loss: 1.177, acc: 0.607: 100%|█| 366/366 [00:34<00:00, 10.55it/
[valid epoch 18] loss: 0.704, acc: 0.811: 100%|█| 91/91 [00:06<00:00, 13.64it/s]
Best model (head+MLP+last5Attn Stage 1) saved with accuracy: 0.8110
[train epoch 19] loss: 1.143, acc: 0.620: 100%|█| 366/366 [00:35<00:00, 10.31it/
[valid epoch 19] loss: 0.706, acc: 0.810: 100%|█| 91/91 [00:05<00:00, 16.24it/s]
[train epoch 20] loss: 1.143, acc: 0.616: 100%|█| 366/366 [00:36<00:00,  9.99it/
[valid epoch 20] loss: 0.682, acc: 0.824: 100%|█| 91/91 [00:05<00:00, 15.60it/s]
Best model (head+MLP+last5Attn Stage 1) saved with accuracy: 0.8241
[train epoch 21] loss: 1.149, acc: 0.613: 100%|█| 366/366 [00:36<00:00, 10.08it/
[valid epoch 21] loss: 0.695, acc: 0.816: 100%|█| 91/91 [00:05<00:00, 16.10it/s]
[train epoch 22] loss: 1.161, acc: 0.610: 100%|█| 366/366 [00:35<00:00, 10.37it/
[valid epoch 22] loss: 0.650, acc: 0.827: 100%|█| 91/91 [00:05<00:00, 16.07it/s]
Best model (head+MLP+last5Attn Stage 1) saved with accuracy: 0.8275
[train epoch 23] loss: 1.118, acc: 0.627: 100%|█| 366/366 [00:33<00:00, 10.81it/
[valid epoch 23] loss: 0.638, acc: 0.829: 100%|█| 91/91 [00:05<00:00, 16.21it/s]
Best model (head+MLP+last5Attn Stage 1) saved with accuracy: 0.8289
[train epoch 24] loss: 1.115, acc: 0.631: 100%|█| 366/366 [00:33<00:00, 10.97it/
[valid epoch 24] loss: 0.655, acc: 0.818: 100%|█| 91/91 [00:05<00:00, 16.37it/s]
[train epoch 25] loss: 1.088, acc: 0.638: 100%|█| 366/366 [00:33<00:00, 10.93it/
[valid epoch 25] loss: 0.653, acc: 0.825: 100%|█| 91/91 [00:05<00:00, 15.97it/s]
[train epoch 26] loss: 1.082, acc: 0.644: 100%|█| 366/366 [00:33<00:00, 10.86it/
[valid epoch 26] loss: 0.623, acc: 0.838: 100%|█| 91/91 [00:05<00:00, 16.35it/s]
Best model (head+MLP+last5Attn Stage 1) saved with accuracy: 0.8385
[train epoch 27] loss: 1.071, acc: 0.641: 100%|█| 366/366 [00:35<00:00, 10.43it/
[valid epoch 27] loss: 0.622, acc: 0.842: 100%|█| 91/91 [00:05<00:00, 15.67it/s]
Best model (head+MLP+last5Attn Stage 1) saved with accuracy: 0.8419
[train epoch 28] loss: 1.108, acc: 0.632: 100%|█| 366/366 [00:34<00:00, 10.58it/
[valid epoch 28] loss: 0.608, acc: 0.836: 100%|█| 91/91 [00:05<00:00, 16.60it/s]
[train epoch 29] loss: 1.083, acc: 0.639: 100%|█| 366/366 [00:32<00:00, 11.11it/
[valid epoch 29] loss: 0.601, acc: 0.843: 100%|█| 91/91 [00:05<00:00, 16.47it/s]
Best model (head+MLP+last5Attn Stage 1) saved with accuracy: 0.8426
[train epoch 30] loss: 1.072, acc: 0.643: 100%|█| 366/366 [00:32<00:00, 11.16it/
[valid epoch 30] loss: 0.587, acc: 0.848: 100%|█| 91/91 [00:05<00:00, 16.47it/s]
Best model (head+MLP+last5Attn Stage 1) saved with accuracy: 0.8481
[train epoch 31] loss: 1.073, acc: 0.646: 100%|█| 366/366 [00:32<00:00, 11.36it/
[valid epoch 31] loss: 0.588, acc: 0.850: 100%|█| 91/91 [00:05<00:00, 16.43it/s]
Best model (head+MLP+last5Attn Stage 1) saved with accuracy: 0.8502
[train epoch 32] loss: 1.051, acc: 0.652: 100%|█| 366/366 [00:32<00:00, 11.21it/
[valid epoch 32] loss: 0.573, acc: 0.852: 100%|█| 91/91 [00:05<00:00, 16.48it/s]
Best model (head+MLP+last5Attn Stage 1) saved with accuracy: 0.8515
[train epoch 33] loss: 1.031, acc: 0.662: 100%|█| 366/366 [00:32<00:00, 11.30it/
[valid epoch 33] loss: 0.576, acc: 0.854: 100%|█| 91/91 [00:05<00:00, 15.98it/s]
Best model (head+MLP+last5Attn Stage 1) saved with accuracy: 0.8536
[train epoch 34] loss: 1.073, acc: 0.643: 100%|█| 366/366 [00:32<00:00, 11.34it/
[valid epoch 34] loss: 0.564, acc: 0.856: 100%|█| 91/91 [00:05<00:00, 16.07it/s]
Best model (head+MLP+last5Attn Stage 1) saved with accuracy: 0.8557
[train epoch 35] loss: 1.014, acc: 0.666: 100%|█| 366/366 [00:33<00:00, 10.89it/
[valid epoch 35] loss: 0.557, acc: 0.860: 100%|█| 91/91 [00:05<00:00, 16.52it/s]
Best model (head+MLP+last5Attn Stage 1) saved with accuracy: 0.8605
[train epoch 36] loss: 1.036, acc: 0.655: 100%|█| 366/366 [00:32<00:00, 11.18it/
[valid epoch 36] loss: 0.554, acc: 0.857: 100%|█| 91/91 [00:05<00:00, 16.45it/s]
[train epoch 37] loss: 1.025, acc: 0.666: 100%|█| 366/366 [00:32<00:00, 11.17it/
[valid epoch 37] loss: 0.558, acc: 0.859: 100%|█| 91/91 [00:05<00:00, 16.50it/s]
[train epoch 38] loss: 1.031, acc: 0.659: 100%|█| 366/366 [00:32<00:00, 11.31it/
[valid epoch 38] loss: 0.556, acc: 0.862: 100%|█| 91/91 [00:05<00:00, 16.42it/s]
Best model (head+MLP+last5Attn Stage 1) saved with accuracy: 0.8619
[train epoch 39] loss: 1.029, acc: 0.660: 100%|█| 366/366 [00:32<00:00, 11.09it/
[valid epoch 39] loss: 0.552, acc: 0.865: 100%|█| 91/91 [00:05<00:00, 15.73it/s]
Best model (head+MLP+last5Attn Stage 1) saved with accuracy: 0.8646
Stage 1 (head+MLP+last5Attn) finished. Best acc: 0.8646

=== QAT Stage 2 (6bit, head+MLP+last5Attn) ===
[train epoch 40] loss: 0.884, acc: 0.645: 100%|█| 366/366 [00:33<00:00, 10.82it/
[valid epoch 40] loss: 0.620, acc: 0.845: 100%|█| 91/91 [00:05<00:00, 16.30it/s]
Best model (head+MLP+last5Attn Stage 2) saved with accuracy: 0.8447
[train epoch 41] loss: 0.915, acc: 0.624: 100%|█| 366/366 [00:33<00:00, 11.02it/
[valid epoch 41] loss: 0.617, acc: 0.834: 100%|█| 91/91 [00:05<00:00, 16.36it/s]
[train epoch 42] loss: 0.899, acc: 0.633: 100%|█| 366/366 [00:33<00:00, 10.97it/
[valid epoch 42] loss: 0.629, acc: 0.830: 100%|█| 91/91 [00:05<00:00, 15.92it/s]
[train epoch 43] loss: 0.878, acc: 0.639: 100%|█| 366/366 [00:32<00:00, 11.12it/
[valid epoch 43] loss: 0.611, acc: 0.844: 100%|█| 91/91 [00:05<00:00, 16.55it/s]
[train epoch 44] loss: 0.897, acc: 0.637: 100%|█| 366/366 [00:32<00:00, 11.27it/
[valid epoch 44] loss: 0.603, acc: 0.849: 100%|█| 91/91 [00:05<00:00, 15.99it/s]
Best model (head+MLP+last5Attn Stage 2) saved with accuracy: 0.8495
[train epoch 45] loss: 0.885, acc: 0.640: 100%|█| 366/366 [00:32<00:00, 11.23it/
[valid epoch 45] loss: 0.603, acc: 0.852: 100%|█| 91/91 [00:05<00:00, 16.37it/s]
Best model (head+MLP+last5Attn Stage 2) saved with accuracy: 0.8515
[train epoch 46] loss: 0.858, acc: 0.653: 100%|█| 366/366 [00:32<00:00, 11.29it/
[valid epoch 46] loss: 0.585, acc: 0.850: 100%|█| 91/91 [00:05<00:00, 16.43it/s]
[train epoch 47] loss: 0.898, acc: 0.636: 100%|█| 366/366 [00:33<00:00, 11.08it/
[valid epoch 47] loss: 0.623, acc: 0.830: 100%|█| 91/91 [00:05<00:00, 16.41it/s]
[train epoch 48] loss: 0.882, acc: 0.644: 100%|█| 366/366 [00:32<00:00, 11.15it/
[valid epoch 48] loss: 0.591, acc: 0.849: 100%|█| 91/91 [00:05<00:00, 16.39it/s]
[train epoch 49] loss: 0.888, acc: 0.636: 100%|█| 366/366 [00:33<00:00, 11.02it/
[valid epoch 49] loss: 0.578, acc: 0.858: 100%|█| 91/91 [00:05<00:00, 16.43it/s]
Best model (head+MLP+last5Attn Stage 2) saved with accuracy: 0.8577
[train epoch 50] loss: 0.869, acc: 0.646: 100%|█| 366/366 [00:32<00:00, 11.24it/
[valid epoch 50] loss: 0.576, acc: 0.854: 100%|█| 91/91 [00:05<00:00, 16.40it/s]
[train epoch 51] loss: 0.755, acc: 0.652: 100%|█| 366/366 [00:33<00:00, 11.08it/
[valid epoch 51] loss: 0.601, acc: 0.847: 100%|█| 91/91 [00:05<00:00, 16.33it/s]
[train epoch 52] loss: 0.759, acc: 0.650: 100%|█| 366/366 [00:33<00:00, 11.08it/
[valid epoch 52] loss: 0.575, acc: 0.852: 100%|█| 91/91 [00:05<00:00, 16.43it/s]
[train epoch 53] loss: 0.754, acc: 0.651: 100%|█| 366/366 [00:32<00:00, 11.27it/
[valid epoch 53] loss: 0.581, acc: 0.850: 100%|█| 91/91 [00:05<00:00, 16.37it/s]
[train epoch 54] loss: 0.740, acc: 0.658: 100%|█| 366/366 [00:32<00:00, 11.32it/
[valid epoch 54] loss: 0.582, acc: 0.854: 100%|█| 91/91 [00:05<00:00, 16.50it/s]
[train epoch 55] loss: 0.760, acc: 0.638: 100%|█| 366/366 [00:32<00:00, 11.35it/
[valid epoch 55] loss: 0.585, acc: 0.845: 100%|█| 91/91 [00:05<00:00, 16.35it/s]
[train epoch 56] loss: 0.747, acc: 0.654: 100%|█| 366/366 [00:32<00:00, 11.24it/
[valid epoch 56] loss: 0.574, acc: 0.849: 100%|█| 91/91 [00:05<00:00, 16.02it/s]
[train epoch 57] loss: 0.748, acc: 0.653: 100%|█| 366/366 [00:32<00:00, 11.20it/
[valid epoch 57] loss: 0.580, acc: 0.849: 100%|█| 91/91 [00:05<00:00, 16.34it/s]
[train epoch 58] loss: 0.735, acc: 0.658: 100%|█| 366/366 [00:33<00:00, 11.00it/
[valid epoch 58] loss: 0.567, acc: 0.847: 100%|█| 91/91 [00:05<00:00, 16.38it/s]
[train epoch 59] loss: 0.739, acc: 0.653: 100%|█| 366/366 [00:32<00:00, 11.22it/
[valid epoch 59] loss: 0.562, acc: 0.851: 100%|█| 91/91 [00:05<00:00, 16.08it/s]
[train epoch 60] loss: 0.743, acc: 0.655: 100%|█| 366/366 [00:32<00:00, 11.11it/
[valid epoch 60] loss: 0.566, acc: 0.853: 100%|█| 91/91 [00:05<00:00, 16.39it/s]
[train epoch 61] loss: 0.733, acc: 0.659: 100%|█| 366/366 [00:33<00:00, 11.08it/
[valid epoch 61] loss: 0.557, acc: 0.861: 100%|█| 91/91 [00:05<00:00, 16.47it/s]
Best model (head+MLP+last5Attn Stage 2) saved with accuracy: 0.8612
[train epoch 62] loss: 0.715, acc: 0.669: 100%|█| 366/366 [00:32<00:00, 11.11it/
[valid epoch 62] loss: 0.555, acc: 0.852: 100%|█| 91/91 [00:05<00:00, 16.39it/s]
[train epoch 63] loss: 0.729, acc: 0.659: 100%|█| 366/366 [00:32<00:00, 11.30it/
[valid epoch 63] loss: 0.562, acc: 0.854: 100%|█| 91/91 [00:05<00:00, 16.22it/s]
[train epoch 64] loss: 0.735, acc: 0.654: 100%|█| 366/366 [00:31<00:00, 11.55it/
[valid epoch 64] loss: 0.555, acc: 0.854: 100%|█| 91/91 [00:05<00:00, 16.28it/s]
[train epoch 65] loss: 0.713, acc: 0.670: 100%|█| 366/366 [00:32<00:00, 11.26it/
[valid epoch 65] loss: 0.553, acc: 0.857: 100%|█| 91/91 [00:05<00:00, 16.37it/s]
[train epoch 66] loss: 0.725, acc: 0.658: 100%|█| 366/366 [00:34<00:00, 10.71it/
[valid epoch 66] loss: 0.553, acc: 0.861: 100%|█| 91/91 [00:05<00:00, 16.32it/s]
[train epoch 67] loss: 0.718, acc: 0.666: 100%|█| 366/366 [00:33<00:00, 10.93it/
[valid epoch 67] loss: 0.551, acc: 0.860: 100%|█| 91/91 [00:05<00:00, 16.30it/s]
[train epoch 68] loss: 0.713, acc: 0.671: 100%|█| 366/366 [00:33<00:00, 11.01it/
[valid epoch 68] loss: 0.551, acc: 0.863: 100%|█| 91/91 [00:05<00:00, 16.50it/s]
Best model (head+MLP+last5Attn Stage 2) saved with accuracy: 0.8632
[train epoch 69] loss: 0.705, acc: 0.673: 100%|█| 366/366 [00:32<00:00, 11.09it/
[valid epoch 69] loss: 0.550, acc: 0.863: 100%|█| 91/91 [00:05<00:00, 16.51it/s]
Stage 2 (head+MLP+last5Attn) finished. Best acc: 0.8632

=== QAT Stage 3 (4bit, head+MLP+last5Attn) ===
[train epoch 70] loss: 0.628, acc: 0.530: 100%|█| 366/366 [00:32<00:00, 11.24it/
[valid epoch 70] loss: 0.925, acc: 0.742: 100%|█| 91/91 [00:05<00:00, 16.34it/s]
Best model (head+MLP+last5Attn Stage 3) saved with accuracy: 0.7416
[train epoch 71] loss: 0.538, acc: 0.557: 100%|█| 366/366 [00:32<00:00, 11.28it/
[valid epoch 71] loss: 0.850, acc: 0.768: 100%|█| 91/91 [00:05<00:00, 15.93it/s]
Best model (head+MLP+last5Attn Stage 3) saved with accuracy: 0.7677
[train epoch 72] loss: 0.529, acc: 0.559: 100%|█| 366/366 [00:32<00:00, 11.40it/
[valid epoch 72] loss: 0.826, acc: 0.771: 100%|█| 91/91 [00:05<00:00, 15.67it/s]
Best model (head+MLP+last5Attn Stage 3) saved with accuracy: 0.7711
[train epoch 73] loss: 0.517, acc: 0.553: 100%|█| 366/366 [00:32<00:00, 11.17it/
[valid epoch 73] loss: 0.817, acc: 0.770: 100%|█| 91/91 [00:05<00:00, 16.18it/s]
[train epoch 74] loss: 0.499, acc: 0.567: 100%|█| 366/366 [00:32<00:00, 11.31it/
[valid epoch 74] loss: 0.797, acc: 0.788: 100%|█| 91/91 [00:05<00:00, 16.38it/s]
Best model (head+MLP+last5Attn Stage 3) saved with accuracy: 0.7883
[train epoch 75] loss: 0.478, acc: 0.582: 100%|█| 366/366 [00:32<00:00, 11.35it/
[valid epoch 75] loss: 0.826, acc: 0.764: 100%|█| 91/91 [00:05<00:00, 16.24it/s]
[train epoch 76] loss: 0.487, acc: 0.587: 100%|█| 366/366 [00:32<00:00, 11.22it/
[valid epoch 76] loss: 0.829, acc: 0.771: 100%|█| 91/91 [00:05<00:00, 16.20it/s]
[train epoch 77] loss: 0.482, acc: 0.570: 100%|█| 366/366 [00:32<00:00, 11.24it/
[valid epoch 77] loss: 0.797, acc: 0.772: 100%|█| 91/91 [00:05<00:00, 16.38it/s]
[train epoch 78] loss: 0.475, acc: 0.580: 100%|█| 366/366 [00:32<00:00, 11.29it/
[valid epoch 78] loss: 0.778, acc: 0.784: 100%|█| 91/91 [00:05<00:00, 16.29it/s]
[train epoch 79] loss: 0.465, acc: 0.581: 100%|█| 366/366 [00:32<00:00, 11.20it/
[valid epoch 79] loss: 0.769, acc: 0.783: 100%|█| 91/91 [00:05<00:00, 16.30it/s]
[train epoch 80] loss: 0.469, acc: 0.572: 100%|█| 366/366 [00:33<00:00, 11.00it/
[valid epoch 80] loss: 0.773, acc: 0.794: 100%|█| 91/91 [00:05<00:00, 16.33it/s]
Best model (head+MLP+last5Attn Stage 3) saved with accuracy: 0.7938
[train epoch 81] loss: 0.457, acc: 0.584: 100%|█| 366/366 [00:32<00:00, 11.10it/
[valid epoch 81] loss: 0.789, acc: 0.777: 100%|█| 91/91 [00:05<00:00, 16.38it/s]
[train epoch 82] loss: 0.463, acc: 0.579: 100%|█| 366/366 [00:32<00:00, 11.10it/
[valid epoch 82] loss: 0.790, acc: 0.779: 100%|█| 91/91 [00:05<00:00, 16.20it/s]
[train epoch 83] loss: 0.460, acc: 0.580: 100%|█| 366/366 [00:32<00:00, 11.35it/
[valid epoch 83] loss: 0.764, acc: 0.787: 100%|█| 91/91 [00:05<00:00, 16.39it/s]
[train epoch 84] loss: 0.446, acc: 0.592: 100%|█| 366/366 [00:32<00:00, 11.13it/
[valid epoch 84] loss: 0.800, acc: 0.782: 100%|█| 91/91 [00:05<00:00, 16.29it/s]
[train epoch 85] loss: 0.446, acc: 0.589: 100%|█| 366/366 [00:32<00:00, 11.19it/
[valid epoch 85] loss: 0.753, acc: 0.782: 100%|█| 91/91 [00:05<00:00, 16.14it/s]
[train epoch 86] loss: 0.440, acc: 0.592: 100%|█| 366/366 [00:33<00:00, 10.79it/
[valid epoch 86] loss: 0.745, acc: 0.784: 100%|█| 91/91 [00:05<00:00, 16.05it/s]
[train epoch 87] loss: 0.429, acc: 0.596: 100%|█| 366/366 [00:34<00:00, 10.60it/
[valid epoch 87] loss: 0.745, acc: 0.798: 100%|█| 91/91 [00:05<00:00, 16.23it/s]
Best model (head+MLP+last5Attn Stage 3) saved with accuracy: 0.7979
[train epoch 88] loss: 0.441, acc: 0.591: 100%|█| 366/366 [00:35<00:00, 10.30it/
[valid epoch 88] loss: 0.764, acc: 0.795: 100%|█| 91/91 [00:05<00:00, 15.93it/s]
[train epoch 89] loss: 0.436, acc: 0.586: 100%|█| 366/366 [00:36<00:00,  9.91it/
[valid epoch 89] loss: 0.726, acc: 0.792: 100%|█| 91/91 [00:05<00:00, 15.51it/s]
[train epoch 90] loss: 0.607, acc: 0.586: 100%|█| 366/366 [00:33<00:00, 11.04it/
[valid epoch 90] loss: 0.728, acc: 0.803: 100%|█| 91/91 [00:05<00:00, 15.87it/s]
Best model (head+MLP+last5Attn Stage 3) saved with accuracy: 0.8034
[train epoch 91] loss: 0.594, acc: 0.592: 100%|█| 366/366 [00:32<00:00, 11.12it/
[valid epoch 91] loss: 0.704, acc: 0.805: 100%|█| 91/91 [00:05<00:00, 16.21it/s]
Best model (head+MLP+last5Attn Stage 3) saved with accuracy: 0.8048
[train epoch 92] loss: 0.592, acc: 0.593: 100%|█| 366/366 [00:52<00:00,  7.03it/
[valid epoch 92] loss: 0.715, acc: 0.811: 100%|█| 91/91 [00:06<00:00, 14.16it/s]
Best model (head+MLP+last5Attn Stage 3) saved with accuracy: 0.8110
[train epoch 93] loss: 0.584, acc: 0.592: 100%|█| 366/366 [00:33<00:00, 10.90it/
[valid epoch 93] loss: 0.722, acc: 0.798: 100%|█| 91/91 [00:05<00:00, 15.90it/s]
[train epoch 94] loss: 0.581, acc: 0.596: 100%|█| 366/366 [00:45<00:00,  8.09it/
[valid epoch 94] loss: 0.695, acc: 0.814: 100%|█| 91/91 [00:07<00:00, 11.73it/s]
Best model (head+MLP+last5Attn Stage 3) saved with accuracy: 0.8144
[train epoch 95] loss: 0.565, acc: 0.603: 100%|█| 366/366 [00:40<00:00,  9.04it/
[valid epoch 95] loss: 0.685, acc: 0.813: 100%|█| 91/91 [00:08<00:00, 10.22it/s]
[train epoch 96] loss: 0.578, acc: 0.599: 100%|█| 366/366 [00:33<00:00, 10.81it/
[valid epoch 96] loss: 0.687, acc: 0.804: 100%|█| 91/91 [00:05<00:00, 16.07it/s]
[train epoch 97] loss: 0.563, acc: 0.611: 100%|█| 366/366 [00:33<00:00, 11.03it/
[valid epoch 97] loss: 0.693, acc: 0.812: 100%|█| 91/91 [00:05<00:00, 16.02it/s]
[train epoch 98] loss: 0.561, acc: 0.611: 100%|█| 366/366 [00:32<00:00, 11.27it/
[valid epoch 98] loss: 0.682, acc: 0.812: 100%|█| 91/91 [00:05<00:00, 16.15it/s]
[train epoch 99] loss: 0.546, acc: 0.616: 100%|█| 366/366 [00:32<00:00, 11.42it/
[valid epoch 99] loss: 0.665, acc: 0.817: 100%|█| 91/91 [00:05<00:00, 16.31it/s]
Best model (head+MLP+last5Attn Stage 3) saved with accuracy: 0.8172
[train epoch 100] loss: 0.553, acc: 0.617: 100%|█| 366/366 [00:32<00:00, 11.09it
[valid epoch 100] loss: 0.682, acc: 0.803: 100%|█| 91/91 [00:05<00:00, 16.22it/s
[train epoch 101] loss: 0.540, acc: 0.622: 100%|█| 366/366 [00:35<00:00, 10.17it
[valid epoch 101] loss: 0.671, acc: 0.816: 100%|█| 91/91 [00:06<00:00, 14.98it/s
[train epoch 102] loss: 0.558, acc: 0.607: 100%|█| 366/366 [00:32<00:00, 11.15it
[valid epoch 102] loss: 0.670, acc: 0.812: 100%|█| 91/91 [00:05<00:00, 15.77it/s
[train epoch 103] loss: 0.561, acc: 0.600: 100%|█| 366/366 [00:34<00:00, 10.63it
[valid epoch 103] loss: 0.666, acc: 0.820: 100%|█| 91/91 [00:05<00:00, 16.19it/s
Best model (head+MLP+last5Attn Stage 3) saved with accuracy: 0.8199
[train epoch 104] loss: 0.541, acc: 0.630: 100%|█| 366/366 [00:32<00:00, 11.30it
[valid epoch 104] loss: 0.666, acc: 0.810: 100%|█| 91/91 [00:05<00:00, 16.07it/s
[train epoch 105] loss: 0.564, acc: 0.602: 100%|█| 366/366 [00:33<00:00, 11.04it
[valid epoch 105] loss: 0.670, acc: 0.818: 100%|█| 91/91 [00:05<00:00, 16.21it/s
[train epoch 106] loss: 0.547, acc: 0.615: 100%|█| 366/366 [00:33<00:00, 11.03it
[valid epoch 106] loss: 0.664, acc: 0.823: 100%|█| 91/91 [00:05<00:00, 16.21it/s
Best model (head+MLP+last5Attn Stage 3) saved with accuracy: 0.8227
[train epoch 107] loss: 0.537, acc: 0.625: 100%|█| 366/366 [00:32<00:00, 11.13it
[valid epoch 107] loss: 0.662, acc: 0.819: 100%|█| 91/91 [00:05<00:00, 16.23it/s
[train epoch 108] loss: 0.549, acc: 0.613: 100%|█| 366/366 [00:33<00:00, 10.96it
[valid epoch 108] loss: 0.664, acc: 0.816: 100%|█| 91/91 [00:05<00:00, 16.37it/s
[train epoch 109] loss: 0.545, acc: 0.617: 100%|█| 366/366 [00:33<00:00, 11.06it
[valid epoch 109] loss: 0.660, acc: 0.819: 100%|█| 91/91 [00:05<00:00, 16.25it/s
Stage 3 (head+MLP+last5Attn) finished. Best acc: 0.8227
Progressive QAT completed. Best validation accuracy: 0.8646

==== Sweep 6: head+MLP+last6Attn ====

=== QAT Stage 1 (8bit, head+MLP+last6Attn) ===
[train epoch 0] loss: 1.609, acc: 0.441: 100%|█| 366/366 [00:33<00:00, 10.96it/s
[valid epoch 0] loss: 1.135, acc: 0.678: 100%|██| 91/91 [00:05<00:00, 16.16it/s]
Best model (head+MLP+last6Attn Stage 1) saved with accuracy: 0.6784
[train epoch 1] loss: 1.493, acc: 0.483: 100%|█| 366/366 [00:33<00:00, 10.77it/s
[valid epoch 1] loss: 1.045, acc: 0.699: 100%|██| 91/91 [00:05<00:00, 16.24it/s]
Best model (head+MLP+last6Attn Stage 1) saved with accuracy: 0.6990
[train epoch 2] loss: 1.453, acc: 0.496: 100%|█| 366/366 [00:33<00:00, 10.98it/s
[valid epoch 2] loss: 1.075, acc: 0.682: 100%|██| 91/91 [00:05<00:00, 16.08it/s]
[train epoch 3] loss: 1.420, acc: 0.507: 100%|█| 366/366 [00:33<00:00, 10.81it/s
[valid epoch 3] loss: 1.028, acc: 0.705: 100%|██| 91/91 [00:05<00:00, 16.14it/s]
Best model (head+MLP+last6Attn Stage 1) saved with accuracy: 0.7052
[train epoch 4] loss: 1.426, acc: 0.508: 100%|█| 366/366 [00:33<00:00, 10.79it/s
[valid epoch 4] loss: 0.948, acc: 0.729: 100%|██| 91/91 [00:05<00:00, 16.12it/s]
Best model (head+MLP+last6Attn Stage 1) saved with accuracy: 0.7285
[train epoch 5] loss: 1.412, acc: 0.514: 100%|█| 366/366 [00:33<00:00, 10.89it/s
[valid epoch 5] loss: 0.933, acc: 0.729: 100%|██| 91/91 [00:05<00:00, 16.12it/s]
[train epoch 6] loss: 1.412, acc: 0.514: 100%|█| 366/366 [00:37<00:00,  9.66it/s
[valid epoch 6] loss: 1.015, acc: 0.706: 100%|██| 91/91 [00:06<00:00, 13.78it/s]
[train epoch 7] loss: 1.361, acc: 0.535: 100%|█| 366/366 [00:34<00:00, 10.61it/s
[valid epoch 7] loss: 0.972, acc: 0.703: 100%|██| 91/91 [00:05<00:00, 16.14it/s]
[train epoch 8] loss: 1.374, acc: 0.529: 100%|█| 366/366 [00:37<00:00,  9.81it/s
[valid epoch 8] loss: 0.895, acc: 0.753: 100%|██| 91/91 [00:05<00:00, 15.85it/s]
Best model (head+MLP+last6Attn Stage 1) saved with accuracy: 0.7533
[train epoch 9] loss: 1.368, acc: 0.533: 100%|█| 366/366 [00:34<00:00, 10.71it/s
[valid epoch 9] loss: 0.909, acc: 0.738: 100%|██| 91/91 [00:05<00:00, 16.12it/s]
[train epoch 10] loss: 1.341, acc: 0.537: 100%|█| 366/366 [00:34<00:00, 10.69it/
[valid epoch 10] loss: 0.915, acc: 0.750: 100%|█| 91/91 [00:05<00:00, 16.16it/s]
[train epoch 11] loss: 1.314, acc: 0.552: 100%|█| 366/366 [00:34<00:00, 10.65it/
[valid epoch 11] loss: 0.906, acc: 0.731: 100%|█| 91/91 [00:05<00:00, 16.23it/s]
[train epoch 12] loss: 1.334, acc: 0.547: 100%|█| 366/366 [00:33<00:00, 10.91it/
[valid epoch 12] loss: 0.912, acc: 0.744: 100%|█| 91/91 [00:05<00:00, 16.17it/s]
[train epoch 13] loss: 1.303, acc: 0.555: 100%|█| 366/366 [00:33<00:00, 10.83it/
[valid epoch 13] loss: 0.875, acc: 0.760: 100%|█| 91/91 [00:05<00:00, 16.21it/s]
Best model (head+MLP+last6Attn Stage 1) saved with accuracy: 0.7601
[train epoch 14] loss: 1.285, acc: 0.564: 100%|█| 366/366 [00:33<00:00, 10.93it/
[valid epoch 14] loss: 0.838, acc: 0.771: 100%|█| 91/91 [00:05<00:00, 16.13it/s]
Best model (head+MLP+last6Attn Stage 1) saved with accuracy: 0.7711
[train epoch 15] loss: 1.286, acc: 0.558: 100%|█| 366/366 [00:35<00:00, 10.37it/
[valid epoch 15] loss: 0.843, acc: 0.777: 100%|█| 91/91 [00:05<00:00, 16.01it/s]
Best model (head+MLP+last6Attn Stage 1) saved with accuracy: 0.7773
[train epoch 16] loss: 1.269, acc: 0.571: 100%|█| 366/366 [00:33<00:00, 10.94it/
[valid epoch 16] loss: 0.835, acc: 0.777: 100%|█| 91/91 [00:05<00:00, 16.18it/s]
[train epoch 17] loss: 1.259, acc: 0.572: 100%|█| 366/366 [00:34<00:00, 10.75it/
[valid epoch 17] loss: 0.804, acc: 0.778: 100%|█| 91/91 [00:05<00:00, 15.88it/s]
Best model (head+MLP+last6Attn Stage 1) saved with accuracy: 0.7780
[train epoch 18] loss: 1.241, acc: 0.578: 100%|█| 366/366 [00:33<00:00, 10.84it/
[valid epoch 18] loss: 0.813, acc: 0.784: 100%|█| 91/91 [00:05<00:00, 16.16it/s]
Best model (head+MLP+last6Attn Stage 1) saved with accuracy: 0.7835
[train epoch 19] loss: 1.234, acc: 0.573: 100%|█| 366/366 [00:34<00:00, 10.47it/
[valid epoch 19] loss: 0.826, acc: 0.768: 100%|█| 91/91 [00:05<00:00, 15.32it/s]
[train epoch 20] loss: 1.228, acc: 0.583: 100%|█| 366/366 [00:34<00:00, 10.76it/
[valid epoch 20] loss: 0.754, acc: 0.795: 100%|█| 91/91 [00:05<00:00, 15.52it/s]
Best model (head+MLP+last6Attn Stage 1) saved with accuracy: 0.7952
[train epoch 21] loss: 1.208, acc: 0.591: 100%|█| 366/366 [00:35<00:00, 10.20it/
[valid epoch 21] loss: 0.742, acc: 0.807: 100%|█| 91/91 [00:05<00:00, 16.11it/s]
Best model (head+MLP+last6Attn Stage 1) saved with accuracy: 0.8069
[train epoch 22] loss: 1.223, acc: 0.584: 100%|█| 366/366 [00:33<00:00, 10.85it/
[valid epoch 22] loss: 0.795, acc: 0.781: 100%|█| 91/91 [00:05<00:00, 16.28it/s]
[train epoch 23] loss: 1.176, acc: 0.600: 100%|█| 366/366 [00:33<00:00, 11.02it/
[valid epoch 23] loss: 0.707, acc: 0.807: 100%|█| 91/91 [00:05<00:00, 16.36it/s]
[train epoch 24] loss: 1.205, acc: 0.587: 100%|█| 366/366 [00:34<00:00, 10.73it/
[valid epoch 24] loss: 0.714, acc: 0.808: 100%|█| 91/91 [00:05<00:00, 16.43it/s]
Best model (head+MLP+last6Attn Stage 1) saved with accuracy: 0.8076
[train epoch 25] loss: 1.167, acc: 0.607: 100%|█| 366/366 [00:33<00:00, 11.01it/
[valid epoch 25] loss: 0.716, acc: 0.808: 100%|█| 91/91 [00:05<00:00, 16.25it/s]
[train epoch 26] loss: 1.176, acc: 0.602: 100%|█| 366/366 [00:33<00:00, 10.77it/
[valid epoch 26] loss: 0.684, acc: 0.817: 100%|█| 91/91 [00:05<00:00, 15.98it/s]
Best model (head+MLP+last6Attn Stage 1) saved with accuracy: 0.8172
[train epoch 27] loss: 1.147, acc: 0.614: 100%|█| 366/366 [00:33<00:00, 10.93it/
[valid epoch 27] loss: 0.670, acc: 0.821: 100%|█| 91/91 [00:05<00:00, 16.46it/s]
Best model (head+MLP+last6Attn Stage 1) saved with accuracy: 0.8206
[train epoch 28] loss: 1.111, acc: 0.627: 100%|█| 366/366 [00:34<00:00, 10.72it/
[valid epoch 28] loss: 0.653, acc: 0.824: 100%|█| 91/91 [00:05<00:00, 16.15it/s]
Best model (head+MLP+last6Attn Stage 1) saved with accuracy: 0.8241
[train epoch 29] loss: 1.141, acc: 0.617: 100%|█| 366/366 [00:34<00:00, 10.72it/
[valid epoch 29] loss: 0.668, acc: 0.821: 100%|█| 91/91 [00:05<00:00, 16.40it/s]
[train epoch 30] loss: 1.101, acc: 0.632: 100%|█| 366/366 [00:33<00:00, 10.91it/
[valid epoch 30] loss: 0.644, acc: 0.829: 100%|█| 91/91 [00:05<00:00, 16.05it/s]
Best model (head+MLP+last6Attn Stage 1) saved with accuracy: 0.8289
[train epoch 31] loss: 1.128, acc: 0.620: 100%|█| 366/366 [00:34<00:00, 10.65it/
[valid epoch 31] loss: 0.647, acc: 0.828: 100%|█| 91/91 [00:05<00:00, 16.04it/s]
[train epoch 32] loss: 1.098, acc: 0.632: 100%|█| 366/366 [00:33<00:00, 10.82it/
[valid epoch 32] loss: 0.643, acc: 0.828: 100%|█| 91/91 [00:05<00:00, 16.10it/s]
[train epoch 33] loss: 1.116, acc: 0.626: 100%|█| 366/366 [00:35<00:00, 10.41it/
[valid epoch 33] loss: 0.627, acc: 0.843: 100%|█| 91/91 [00:05<00:00, 16.20it/s]
Best model (head+MLP+last6Attn Stage 1) saved with accuracy: 0.8426
[train epoch 34] loss: 1.087, acc: 0.640: 100%|█| 366/366 [00:33<00:00, 10.87it/
[valid epoch 34] loss: 0.614, acc: 0.841: 100%|█| 91/91 [00:05<00:00, 16.27it/s]
[train epoch 35] loss: 1.075, acc: 0.645: 100%|█| 366/366 [00:34<00:00, 10.71it/
[valid epoch 35] loss: 0.615, acc: 0.843: 100%|█| 91/91 [00:05<00:00, 16.30it/s]
[train epoch 36] loss: 1.054, acc: 0.654: 100%|█| 366/366 [00:33<00:00, 10.77it/
[valid epoch 36] loss: 0.605, acc: 0.845: 100%|█| 91/91 [00:05<00:00, 16.14it/s]
Best model (head+MLP+last6Attn Stage 1) saved with accuracy: 0.8454
[train epoch 37] loss: 1.054, acc: 0.648: 100%|█| 366/366 [00:33<00:00, 10.78it/
[valid epoch 37] loss: 0.604, acc: 0.848: 100%|█| 91/91 [00:05<00:00, 16.22it/s]
Best model (head+MLP+last6Attn Stage 1) saved with accuracy: 0.8481
[train epoch 38] loss: 1.093, acc: 0.634: 100%|█| 366/366 [00:34<00:00, 10.75it/
[valid epoch 38] loss: 0.603, acc: 0.849: 100%|█| 91/91 [00:05<00:00, 16.41it/s]
Best model (head+MLP+last6Attn Stage 1) saved with accuracy: 0.8488
[train epoch 39] loss: 1.074, acc: 0.646: 100%|█| 366/366 [00:34<00:00, 10.60it/
[valid epoch 39] loss: 0.604, acc: 0.844: 100%|█| 91/91 [00:05<00:00, 16.26it/s]
Stage 1 (head+MLP+last6Attn) finished. Best acc: 0.8488

=== QAT Stage 2 (6bit, head+MLP+last6Attn) ===
[train epoch 40] loss: 0.957, acc: 0.614: 100%|█| 366/366 [00:33<00:00, 10.83it/
[valid epoch 40] loss: 0.656, acc: 0.824: 100%|█| 91/91 [00:05<00:00, 16.25it/s]
Best model (head+MLP+last6Attn Stage 2) saved with accuracy: 0.8241
[train epoch 41] loss: 0.947, acc: 0.614: 100%|█| 366/366 [00:34<00:00, 10.46it/
[valid epoch 41] loss: 0.669, acc: 0.817: 100%|█| 91/91 [00:05<00:00, 15.60it/s]
[train epoch 42] loss: 0.955, acc: 0.620: 100%|█| 366/366 [00:37<00:00,  9.89it/
[valid epoch 42] loss: 0.676, acc: 0.812: 100%|█| 91/91 [00:05<00:00, 16.05it/s]
[train epoch 43] loss: 0.927, acc: 0.624: 100%|█| 366/366 [00:35<00:00, 10.27it/
[valid epoch 43] loss: 0.657, acc: 0.823: 100%|█| 91/91 [00:05<00:00, 16.15it/s]
[train epoch 44] loss: 0.917, acc: 0.629: 100%|█| 366/366 [00:35<00:00, 10.29it/
[valid epoch 44] loss: 0.647, acc: 0.829: 100%|█| 91/91 [00:05<00:00, 16.01it/s]
Best model (head+MLP+last6Attn Stage 2) saved with accuracy: 0.8289
[train epoch 45] loss: 0.972, acc: 0.600: 100%|█| 366/366 [00:36<00:00, 10.05it/
[valid epoch 45] loss: 0.651, acc: 0.832: 100%|█| 91/91 [00:05<00:00, 15.77it/s]
Best model (head+MLP+last6Attn Stage 2) saved with accuracy: 0.8316
[train epoch 46] loss: 0.932, acc: 0.617: 100%|█| 366/366 [00:35<00:00, 10.22it/
[valid epoch 46] loss: 0.656, acc: 0.821: 100%|█| 91/91 [00:05<00:00, 16.30it/s]
[train epoch 47] loss: 0.914, acc: 0.630: 100%|█| 366/366 [00:37<00:00,  9.82it/
[valid epoch 47] loss: 0.664, acc: 0.821: 100%|█| 91/91 [00:05<00:00, 16.14it/s]
[train epoch 48] loss: 0.916, acc: 0.629: 100%|█| 366/366 [00:36<00:00, 10.14it/
[valid epoch 48] loss: 0.636, acc: 0.830: 100%|█| 91/91 [00:05<00:00, 16.30it/s]
[train epoch 49] loss: 0.914, acc: 0.633: 100%|█| 366/366 [00:35<00:00, 10.29it/
[valid epoch 49] loss: 0.652, acc: 0.822: 100%|█| 91/91 [00:05<00:00, 16.34it/s]
[train epoch 50] loss: 0.922, acc: 0.622: 100%|█| 366/366 [00:36<00:00,  9.97it/
[valid epoch 50] loss: 0.634, acc: 0.834: 100%|█| 91/91 [00:05<00:00, 16.19it/s]
Best model (head+MLP+last6Attn Stage 2) saved with accuracy: 0.8337
[train epoch 51] loss: 0.828, acc: 0.617: 100%|█| 366/366 [00:36<00:00, 10.03it/
[valid epoch 51] loss: 0.642, acc: 0.835: 100%|█| 91/91 [00:05<00:00, 16.45it/s]
Best model (head+MLP+last6Attn Stage 2) saved with accuracy: 0.8351
[train epoch 52] loss: 0.822, acc: 0.617: 100%|█| 366/366 [00:36<00:00,  9.97it/
[valid epoch 52] loss: 0.654, acc: 0.822: 100%|█| 91/91 [00:05<00:00, 16.20it/s]
[train epoch 53] loss: 0.781, acc: 0.641: 100%|█| 366/366 [00:35<00:00, 10.24it/
[valid epoch 53] loss: 0.632, acc: 0.832: 100%|█| 91/91 [00:05<00:00, 16.36it/s]
[train epoch 54] loss: 0.785, acc: 0.639: 100%|█| 366/366 [00:35<00:00, 10.21it/
[valid epoch 54] loss: 0.639, acc: 0.827: 100%|█| 91/91 [00:05<00:00, 15.98it/s]
[train epoch 55] loss: 0.791, acc: 0.633: 100%|█| 366/366 [00:36<00:00, 10.16it/
[valid epoch 55] loss: 0.642, acc: 0.829: 100%|█| 91/91 [00:05<00:00, 16.32it/s]
[train epoch 56] loss: 0.819, acc: 0.623: 100%|█| 366/366 [00:36<00:00, 10.13it/
[valid epoch 56] loss: 0.641, acc: 0.836: 100%|█| 91/91 [00:05<00:00, 16.25it/s]
Best model (head+MLP+last6Attn Stage 2) saved with accuracy: 0.8357
[train epoch 57] loss: 0.808, acc: 0.622: 100%|█| 366/366 [00:36<00:00,  9.91it/
[valid epoch 57] loss: 0.631, acc: 0.840: 100%|█| 91/91 [00:05<00:00, 15.93it/s]
Best model (head+MLP+last6Attn Stage 2) saved with accuracy: 0.8399
[train epoch 58] loss: 0.789, acc: 0.637: 100%|█| 366/366 [00:36<00:00, 10.13it/
[valid epoch 58] loss: 0.603, acc: 0.845: 100%|█| 91/91 [00:05<00:00, 16.20it/s]
Best model (head+MLP+last6Attn Stage 2) saved with accuracy: 0.8454
[train epoch 59] loss: 0.788, acc: 0.636: 100%|█| 366/366 [00:36<00:00, 10.12it/
[valid epoch 59] loss: 0.617, acc: 0.836: 100%|█| 91/91 [00:05<00:00, 16.34it/s]
[train epoch 60] loss: 0.753, acc: 0.655: 100%|█| 366/366 [00:36<00:00,  9.99it/
[valid epoch 60] loss: 0.606, acc: 0.838: 100%|█| 91/91 [00:05<00:00, 16.17it/s]
[train epoch 61] loss: 0.766, acc: 0.644: 100%|█| 366/366 [00:35<00:00, 10.25it/
[valid epoch 61] loss: 0.618, acc: 0.836: 100%|█| 91/91 [00:05<00:00, 16.06it/s]
[train epoch 62] loss: 0.783, acc: 0.638: 100%|█| 366/366 [00:42<00:00,  8.54it/
[valid epoch 62] loss: 0.613, acc: 0.839: 100%|█| 91/91 [00:05<00:00, 16.16it/s]
[train epoch 63] loss: 0.803, acc: 0.620: 100%|█| 366/366 [00:37<00:00,  9.83it/
[valid epoch 63] loss: 0.604, acc: 0.843: 100%|█| 91/91 [00:05<00:00, 16.30it/s]
[train epoch 64] loss: 0.763, acc: 0.648: 100%|█| 366/366 [00:36<00:00,  9.91it/
[valid epoch 64] loss: 0.606, acc: 0.841: 100%|█| 91/91 [00:05<00:00, 15.62it/s]
[train epoch 65] loss: 0.794, acc: 0.630: 100%|█| 366/366 [00:37<00:00,  9.78it/
[valid epoch 65] loss: 0.606, acc: 0.838: 100%|█| 91/91 [00:05<00:00, 16.09it/s]
[train epoch 66] loss: 0.756, acc: 0.648: 100%|█| 366/366 [00:36<00:00,  9.99it/
[valid epoch 66] loss: 0.603, acc: 0.841: 100%|█| 91/91 [00:05<00:00, 16.15it/s]
[train epoch 67] loss: 0.770, acc: 0.643: 100%|█| 366/366 [00:37<00:00,  9.79it/
[valid epoch 67] loss: 0.604, acc: 0.841: 100%|█| 91/91 [00:05<00:00, 16.11it/s]
[train epoch 68] loss: 0.768, acc: 0.642: 100%|█| 366/366 [00:36<00:00,  9.94it/
[valid epoch 68] loss: 0.602, acc: 0.841: 100%|█| 91/91 [00:05<00:00, 16.12it/s]
[train epoch 69] loss: 0.777, acc: 0.638: 100%|█| 366/366 [00:36<00:00, 10.14it/
[valid epoch 69] loss: 0.600, acc: 0.840: 100%|█| 91/91 [00:05<00:00, 15.95it/s]
Stage 2 (head+MLP+last6Attn) finished. Best acc: 0.8454

=== QAT Stage 3 (4bit, head+MLP+last6Attn) ===
[train epoch 70] loss: 0.694, acc: 0.506: 100%|█| 366/366 [00:36<00:00,  9.98it/
[valid epoch 70] loss: 1.016, acc: 0.711: 100%|█| 91/91 [00:05<00:00, 16.22it/s]
Best model (head+MLP+last6Attn Stage 3) saved with accuracy: 0.7113
[train epoch 71] loss: 0.604, acc: 0.530: 100%|█| 366/366 [00:37<00:00,  9.78it/
[valid epoch 71] loss: 0.962, acc: 0.729: 100%|█| 91/91 [00:05<00:00, 16.28it/s]
Best model (head+MLP+last6Attn Stage 3) saved with accuracy: 0.7292
[train epoch 72] loss: 0.572, acc: 0.528: 100%|█| 366/366 [00:36<00:00, 10.02it/
[valid epoch 72] loss: 0.914, acc: 0.748: 100%|█| 91/91 [00:05<00:00, 16.33it/s]
Best model (head+MLP+last6Attn Stage 3) saved with accuracy: 0.7485
[train epoch 73] loss: 0.565, acc: 0.541: 100%|█| 366/366 [00:37<00:00,  9.76it/
[valid epoch 73] loss: 0.944, acc: 0.731: 100%|█| 91/91 [00:05<00:00, 16.39it/s]
[train epoch 74] loss: 0.554, acc: 0.547: 100%|█| 366/366 [00:55<00:00,  6.63it/
[valid epoch 74] loss: 0.879, acc: 0.744: 100%|█| 91/91 [00:05<00:00, 16.06it/s]
[train epoch 75] loss: 0.542, acc: 0.556: 100%|█| 366/366 [00:37<00:00,  9.79it/
[valid epoch 75] loss: 0.864, acc: 0.758: 100%|█| 91/91 [00:05<00:00, 16.41it/s]
Best model (head+MLP+last6Attn Stage 3) saved with accuracy: 0.7581
[train epoch 76] loss: 0.548, acc: 0.543: 100%|█| 366/366 [00:37<00:00,  9.64it/
[valid epoch 76] loss: 0.856, acc: 0.767: 100%|█| 91/91 [00:05<00:00, 16.20it/s]
Best model (head+MLP+last6Attn Stage 3) saved with accuracy: 0.7670
[train epoch 77] loss: 0.529, acc: 0.551: 100%|█| 366/366 [00:35<00:00, 10.17it/
[valid epoch 77] loss: 0.864, acc: 0.766: 100%|█| 91/91 [00:05<00:00, 16.46it/s]
[train epoch 78] loss: 0.521, acc: 0.557: 100%|█| 366/366 [01:21<00:00,  4.48it/
[valid epoch 78] loss: 0.845, acc: 0.759: 100%|█| 91/91 [00:07<00:00, 12.15it/s]
[train epoch 79] loss: 0.515, acc: 0.552: 100%|█| 366/366 [00:37<00:00,  9.75it/
[valid epoch 79] loss: 0.877, acc: 0.759: 100%|█| 91/91 [00:05<00:00, 15.79it/s]
[train epoch 80] loss: 0.506, acc: 0.554: 100%|█| 366/366 [00:36<00:00, 10.06it/
[valid epoch 80] loss: 0.861, acc: 0.757: 100%|█| 91/91 [00:05<00:00, 16.86it/s]
[train epoch 81] loss: 0.517, acc: 0.538: 100%|█| 366/366 [00:36<00:00, 10.13it/
[valid epoch 81] loss: 0.830, acc: 0.770: 100%|█| 91/91 [00:05<00:00, 16.87it/s]
Best model (head+MLP+last6Attn Stage 3) saved with accuracy: 0.7704
[train epoch 82] loss: 0.505, acc: 0.560: 100%|█| 366/366 [00:35<00:00, 10.29it/
[valid epoch 82] loss: 0.827, acc: 0.785: 100%|█| 91/91 [00:05<00:00, 16.91it/s]
Best model (head+MLP+last6Attn Stage 3) saved with accuracy: 0.7849
[train epoch 83] loss: 0.512, acc: 0.558: 100%|█| 366/366 [00:35<00:00, 10.38it/
[valid epoch 83] loss: 0.830, acc: 0.760: 100%|█| 91/91 [00:05<00:00, 17.02it/s]
[train epoch 84] loss: 0.492, acc: 0.558: 100%|█| 366/366 [00:35<00:00, 10.21it/
[valid epoch 84] loss: 0.823, acc: 0.770: 100%|█| 91/91 [00:05<00:00, 16.78it/s]
[train epoch 85] loss: 0.504, acc: 0.555: 100%|█| 366/366 [00:47<00:00,  7.64it/
[valid epoch 85] loss: 0.833, acc: 0.777: 100%|█| 91/91 [00:06<00:00, 13.33it/s]
[train epoch 86] loss: 0.484, acc: 0.563: 100%|█| 366/366 [00:40<00:00,  9.03it/
[valid epoch 86] loss: 0.835, acc: 0.763: 100%|█| 91/91 [00:05<00:00, 15.96it/s]
[train epoch 87] loss: 0.493, acc: 0.552: 100%|█| 366/366 [00:35<00:00, 10.30it/
[valid epoch 87] loss: 0.823, acc: 0.777: 100%|█| 91/91 [00:05<00:00, 16.83it/s]
[train epoch 88] loss: 0.471, acc: 0.585: 100%|█| 366/366 [00:35<00:00, 10.21it/
[valid epoch 88] loss: 0.833, acc: 0.771: 100%|█| 91/91 [00:05<00:00, 16.48it/s]
[train epoch 89] loss: 0.466, acc: 0.576: 100%|█| 366/366 [00:35<00:00, 10.31it/
[valid epoch 89] loss: 0.778, acc: 0.787: 100%|█| 91/91 [00:05<00:00, 16.75it/s]
Best model (head+MLP+last6Attn Stage 3) saved with accuracy: 0.7869
[train epoch 90] loss: 0.647, acc: 0.574: 100%|█| 366/366 [00:35<00:00, 10.30it/
[valid epoch 90] loss: 0.777, acc: 0.779: 100%|█| 91/91 [00:05<00:00, 17.05it/s]
[train epoch 91] loss: 0.648, acc: 0.580: 100%|█| 366/366 [00:35<00:00, 10.26it/
[valid epoch 91] loss: 0.765, acc: 0.782: 100%|█| 91/91 [00:05<00:00, 16.82it/s]
[train epoch 92] loss: 0.631, acc: 0.582: 100%|█| 366/366 [00:35<00:00, 10.38it/
[valid epoch 92] loss: 0.778, acc: 0.781: 100%|█| 91/91 [00:05<00:00, 16.92it/s]
[train epoch 93] loss: 0.617, acc: 0.585: 100%|█| 366/366 [00:34<00:00, 10.57it/
[valid epoch 93] loss: 0.764, acc: 0.781: 100%|█| 91/91 [00:05<00:00, 16.63it/s]
[train epoch 94] loss: 0.603, acc: 0.599: 100%|█| 366/366 [00:34<00:00, 10.61it/
[valid epoch 94] loss: 0.762, acc: 0.790: 100%|█| 91/91 [00:05<00:00, 17.02it/s]
Best model (head+MLP+last6Attn Stage 3) saved with accuracy: 0.7897
[train epoch 95] loss: 0.616, acc: 0.590: 100%|█| 366/366 [00:34<00:00, 10.46it/
[valid epoch 95] loss: 0.773, acc: 0.793: 100%|█| 91/91 [00:05<00:00, 16.91it/s]
Best model (head+MLP+last6Attn Stage 3) saved with accuracy: 0.7931
[train epoch 96] loss: 0.617, acc: 0.585: 100%|█| 366/366 [00:35<00:00, 10.40it/
[valid epoch 96] loss: 0.747, acc: 0.801: 100%|█| 91/91 [00:05<00:00, 16.90it/s]
Best model (head+MLP+last6Attn Stage 3) saved with accuracy: 0.8014
[train epoch 97] loss: 0.632, acc: 0.573: 100%|█| 366/366 [00:34<00:00, 10.48it/
[valid epoch 97] loss: 0.741, acc: 0.801: 100%|█| 91/91 [00:05<00:00, 17.09it/s]
[train epoch 98] loss: 0.606, acc: 0.592: 100%|█| 366/366 [00:35<00:00, 10.44it/
[valid epoch 98] loss: 0.744, acc: 0.790: 100%|█| 91/91 [00:05<00:00, 16.69it/s]
[train epoch 99] loss: 0.605, acc: 0.590: 100%|█| 366/366 [00:37<00:00,  9.89it/
[valid epoch 99] loss: 0.742, acc: 0.803: 100%|█| 91/91 [00:06<00:00, 14.98it/s]
Best model (head+MLP+last6Attn Stage 3) saved with accuracy: 0.8027
[train epoch 100] loss: 0.599, acc: 0.592: 100%|█| 366/366 [00:35<00:00, 10.44it
[valid epoch 100] loss: 0.739, acc: 0.799: 100%|█| 91/91 [00:05<00:00, 16.93it/s
[train epoch 101] loss: 0.597, acc: 0.591: 100%|█| 366/366 [00:35<00:00, 10.24it
[valid epoch 101] loss: 0.733, acc: 0.803: 100%|█| 91/91 [00:05<00:00, 16.63it/s
[train epoch 102] loss: 0.593, acc: 0.595: 100%|█| 366/366 [00:36<00:00, 10.14it
[valid epoch 102] loss: 0.723, acc: 0.803: 100%|█| 91/91 [00:05<00:00, 16.96it/s
[train epoch 103] loss: 0.603, acc: 0.589: 100%|█| 366/366 [00:35<00:00, 10.17it
[valid epoch 103] loss: 0.727, acc: 0.799: 100%|█| 91/91 [00:05<00:00, 16.88it/s
[train epoch 104] loss: 0.582, acc: 0.604: 100%|█| 366/366 [00:36<00:00,  9.91it
[valid epoch 104] loss: 0.723, acc: 0.805: 100%|█| 91/91 [00:05<00:00, 17.03it/s
Best model (head+MLP+last6Attn Stage 3) saved with accuracy: 0.8048
[train epoch 105] loss: 0.597, acc: 0.603: 100%|█| 366/366 [00:34<00:00, 10.50it
[valid epoch 105] loss: 0.725, acc: 0.801: 100%|█| 91/91 [00:05<00:00, 16.94it/s
[train epoch 106] loss: 0.604, acc: 0.585: 100%|█| 366/366 [00:34<00:00, 10.65it
[valid epoch 106] loss: 0.724, acc: 0.801: 100%|█| 91/91 [00:05<00:00, 16.86it/s
[train epoch 107] loss: 0.586, acc: 0.603: 100%|█| 366/366 [00:34<00:00, 10.52it
[valid epoch 107] loss: 0.718, acc: 0.803: 100%|█| 91/91 [00:05<00:00, 17.02it/s
[train epoch 108] loss: 0.575, acc: 0.600: 100%|█| 366/366 [00:34<00:00, 10.48it
[valid epoch 108] loss: 0.718, acc: 0.801: 100%|█| 91/91 [00:05<00:00, 16.90it/s
[train epoch 109] loss: 0.592, acc: 0.598: 100%|█| 366/366 [00:33<00:00, 10.82it
[valid epoch 109] loss: 0.720, acc: 0.802: 100%|█| 91/91 [00:05<00:00, 16.96it/s
Stage 3 (head+MLP+last6Attn) finished. Best acc: 0.8048
Progressive QAT completed. Best validation accuracy: 0.8488

==== Sweep 7: head+MLP+last7Attn ====

=== QAT Stage 1 (8bit, head+MLP+last7Attn) ===
[train epoch 0] loss: 1.871, acc: 0.344: 100%|█| 366/366 [00:35<00:00, 10.29it/s
[valid epoch 0] loss: 1.545, acc: 0.525: 100%|██| 91/91 [00:05<00:00, 16.80it/s]
Best model (head+MLP+last7Attn Stage 1) saved with accuracy: 0.5251
[train epoch 1] loss: 1.675, acc: 0.412: 100%|█| 366/366 [00:36<00:00,  9.90it/s
[valid epoch 1] loss: 1.338, acc: 0.616: 100%|██| 91/91 [00:05<00:00, 16.54it/s]
Best model (head+MLP+last7Attn Stage 1) saved with accuracy: 0.6165
[train epoch 2] loss: 1.618, acc: 0.438: 100%|█| 366/366 [00:35<00:00, 10.32it/s
[valid epoch 2] loss: 1.523, acc: 0.543: 100%|██| 91/91 [00:05<00:00, 15.40it/s]
[train epoch 3] loss: 1.597, acc: 0.445: 100%|█| 366/366 [00:35<00:00, 10.30it/s
[valid epoch 3] loss: 1.204, acc: 0.642: 100%|██| 91/91 [00:05<00:00, 16.85it/s]
Best model (head+MLP+last7Attn Stage 1) saved with accuracy: 0.6419
[train epoch 4] loss: 1.558, acc: 0.459: 100%|█| 366/366 [00:35<00:00, 10.45it/s
[valid epoch 4] loss: 1.228, acc: 0.646: 100%|██| 91/91 [00:05<00:00, 16.77it/s]
Best model (head+MLP+last7Attn Stage 1) saved with accuracy: 0.6460
[train epoch 5] loss: 1.573, acc: 0.457: 100%|█| 366/366 [00:34<00:00, 10.48it/s
[valid epoch 5] loss: 1.190, acc: 0.657: 100%|██| 91/91 [00:05<00:00, 16.52it/s]
Best model (head+MLP+last7Attn Stage 1) saved with accuracy: 0.6570
[train epoch 6] loss: 1.541, acc: 0.469: 100%|█| 366/366 [00:35<00:00, 10.41it/s
[valid epoch 6] loss: 1.202, acc: 0.652: 100%|██| 91/91 [00:05<00:00, 16.71it/s]
[train epoch 7] loss: 1.518, acc: 0.476: 100%|█| 366/366 [00:35<00:00, 10.25it/s
[valid epoch 7] loss: 1.223, acc: 0.640: 100%|██| 91/91 [00:05<00:00, 16.48it/s]
[train epoch 8] loss: 1.502, acc: 0.475: 100%|█| 366/366 [00:35<00:00, 10.29it/s
[valid epoch 8] loss: 1.150, acc: 0.693: 100%|██| 91/91 [00:05<00:00, 16.66it/s]
Best model (head+MLP+last7Attn Stage 1) saved with accuracy: 0.6935
[train epoch 9] loss: 1.462, acc: 0.497: 100%|█| 366/366 [00:35<00:00, 10.29it/s
[valid epoch 9] loss: 1.077, acc: 0.687: 100%|██| 91/91 [00:05<00:00, 16.68it/s]
[train epoch 10] loss: 1.507, acc: 0.476: 100%|█| 366/366 [00:38<00:00,  9.57it/
[valid epoch 10] loss: 1.085, acc: 0.687: 100%|█| 91/91 [00:05<00:00, 16.38it/s]
[train epoch 11] loss: 1.454, acc: 0.498: 100%|█| 366/366 [00:36<00:00, 10.02it/
[valid epoch 11] loss: 1.071, acc: 0.700: 100%|█| 91/91 [00:05<00:00, 16.56it/s]
Best model (head+MLP+last7Attn Stage 1) saved with accuracy: 0.7003
[train epoch 12] loss: 1.429, acc: 0.509: 100%|█| 366/366 [00:35<00:00, 10.39it/
[valid epoch 12] loss: 1.011, acc: 0.698: 100%|█| 91/91 [00:05<00:00, 16.23it/s]
[train epoch 13] loss: 1.427, acc: 0.502: 100%|█| 366/366 [00:34<00:00, 10.48it/
[valid epoch 13] loss: 1.024, acc: 0.712: 100%|█| 91/91 [00:05<00:00, 16.32it/s]
Best model (head+MLP+last7Attn Stage 1) saved with accuracy: 0.7120
[train epoch 14] loss: 1.409, acc: 0.513: 100%|█| 366/366 [00:35<00:00, 10.30it/
[valid epoch 14] loss: 0.993, acc: 0.724: 100%|█| 91/91 [00:05<00:00, 16.73it/s]
Best model (head+MLP+last7Attn Stage 1) saved with accuracy: 0.7244
[train epoch 15] loss: 1.399, acc: 0.519: 100%|█| 366/366 [00:35<00:00, 10.29it/
[valid epoch 15] loss: 1.025, acc: 0.727: 100%|█| 91/91 [00:05<00:00, 16.76it/s]
Best model (head+MLP+last7Attn Stage 1) saved with accuracy: 0.7271
[train epoch 16] loss: 1.388, acc: 0.519: 100%|█| 366/366 [00:35<00:00, 10.35it/
[valid epoch 16] loss: 1.024, acc: 0.743: 100%|█| 91/91 [00:05<00:00, 16.70it/s]
Best model (head+MLP+last7Attn Stage 1) saved with accuracy: 0.7430
[train epoch 17] loss: 1.381, acc: 0.524: 100%|█| 366/366 [00:35<00:00, 10.33it/
[valid epoch 17] loss: 0.949, acc: 0.742: 100%|█| 91/91 [00:05<00:00, 16.72it/s]
[train epoch 18] loss: 1.357, acc: 0.532: 100%|█| 366/366 [00:35<00:00, 10.41it/
[valid epoch 18] loss: 0.925, acc: 0.749: 100%|█| 91/91 [00:05<00:00, 16.68it/s]
Best model (head+MLP+last7Attn Stage 1) saved with accuracy: 0.7491
[train epoch 19] loss: 1.362, acc: 0.531: 100%|█| 366/366 [00:35<00:00, 10.24it/
[valid epoch 19] loss: 0.935, acc: 0.739: 100%|█| 91/91 [00:05<00:00, 16.56it/s]
[train epoch 20] loss: 1.309, acc: 0.556: 100%|█| 366/366 [00:35<00:00, 10.38it/
[valid epoch 20] loss: 0.888, acc: 0.745: 100%|█| 91/91 [00:05<00:00, 16.54it/s]
[train epoch 21] loss: 1.333, acc: 0.542: 100%|█| 366/366 [00:35<00:00, 10.27it/
[valid epoch 21] loss: 0.873, acc: 0.742: 100%|█| 91/91 [00:05<00:00, 16.53it/s]
[train epoch 22] loss: 1.293, acc: 0.557: 100%|█| 366/366 [00:35<00:00, 10.24it/
[valid epoch 22] loss: 0.869, acc: 0.763: 100%|█| 91/91 [00:09<00:00,  9.40it/s]
Best model (head+MLP+last7Attn Stage 1) saved with accuracy: 0.7629
[train epoch 23] loss: 1.268, acc: 0.571: 100%|█| 366/366 [00:37<00:00,  9.87it/
[valid epoch 23] loss: 0.862, acc: 0.764: 100%|█| 91/91 [00:05<00:00, 16.40it/s]
Best model (head+MLP+last7Attn Stage 1) saved with accuracy: 0.7636
[train epoch 24] loss: 1.291, acc: 0.556: 100%|█| 366/366 [00:38<00:00,  9.60it/
[valid epoch 24] loss: 0.849, acc: 0.746: 100%|█| 91/91 [00:05<00:00, 16.02it/s]
[train epoch 25] loss: 1.259, acc: 0.567: 100%|█| 366/366 [00:37<00:00,  9.88it/
[valid epoch 25] loss: 0.823, acc: 0.773: 100%|█| 91/91 [00:05<00:00, 16.31it/s]
Best model (head+MLP+last7Attn Stage 1) saved with accuracy: 0.7725
[train epoch 26] loss: 1.277, acc: 0.558: 100%|█| 366/366 [00:37<00:00,  9.64it/
[valid epoch 26] loss: 0.820, acc: 0.781: 100%|█| 91/91 [00:05<00:00, 15.28it/s]
Best model (head+MLP+last7Attn Stage 1) saved with accuracy: 0.7808
[train epoch 27] loss: 1.220, acc: 0.580: 100%|█| 366/366 [00:38<00:00,  9.57it/
[valid epoch 27] loss: 0.803, acc: 0.779: 100%|█| 91/91 [00:05<00:00, 16.56it/s]
[train epoch 28] loss: 1.227, acc: 0.584: 100%|█| 366/366 [00:38<00:00,  9.57it/
[valid epoch 28] loss: 0.792, acc: 0.779: 100%|█| 91/91 [00:05<00:00, 15.66it/s]
[train epoch 29] loss: 1.214, acc: 0.586: 100%|█| 366/366 [00:37<00:00,  9.81it/
[valid epoch 29] loss: 0.775, acc: 0.792: 100%|█| 91/91 [00:05<00:00, 16.56it/s]
Best model (head+MLP+last7Attn Stage 1) saved with accuracy: 0.7918
[train epoch 30] loss: 1.218, acc: 0.584: 100%|█| 366/366 [00:37<00:00,  9.79it/
[valid epoch 30] loss: 0.777, acc: 0.786: 100%|█| 91/91 [00:05<00:00, 16.60it/s]
[train epoch 31] loss: 1.209, acc: 0.591: 100%|█| 366/366 [00:37<00:00,  9.83it/
[valid epoch 31] loss: 0.755, acc: 0.788: 100%|█| 91/91 [00:05<00:00, 16.64it/s]
[train epoch 32] loss: 1.195, acc: 0.599: 100%|█| 366/366 [00:36<00:00, 10.12it/
[valid epoch 32] loss: 0.746, acc: 0.802: 100%|█| 91/91 [00:05<00:00, 16.15it/s]
Best model (head+MLP+last7Attn Stage 1) saved with accuracy: 0.8021
[train epoch 33] loss: 1.173, acc: 0.602: 100%|█| 366/366 [00:36<00:00, 10.15it/
[valid epoch 33] loss: 0.736, acc: 0.795: 100%|█| 91/91 [00:05<00:00, 16.21it/s]
[train epoch 34] loss: 1.219, acc: 0.579: 100%|█| 366/366 [00:35<00:00, 10.26it/
[valid epoch 34] loss: 0.741, acc: 0.803: 100%|█| 91/91 [00:05<00:00, 16.57it/s]
Best model (head+MLP+last7Attn Stage 1) saved with accuracy: 0.8027
[train epoch 35] loss: 1.173, acc: 0.600: 100%|█| 366/366 [00:35<00:00, 10.39it/
[valid epoch 35] loss: 0.734, acc: 0.801: 100%|█| 91/91 [00:05<00:00, 16.58it/s]
[train epoch 36] loss: 1.142, acc: 0.613: 100%|█| 366/366 [00:55<00:00,  6.54it/
[valid epoch 36] loss: 0.724, acc: 0.807: 100%|█| 91/91 [00:09<00:00,  9.75it/s]
Best model (head+MLP+last7Attn Stage 1) saved with accuracy: 0.8069
[train epoch 37] loss: 1.170, acc: 0.606: 100%|█| 366/366 [00:36<00:00, 10.15it/
[valid epoch 37] loss: 0.722, acc: 0.808: 100%|█| 91/91 [00:05<00:00, 16.17it/s]
Best model (head+MLP+last7Attn Stage 1) saved with accuracy: 0.8076
[train epoch 38] loss: 1.161, acc: 0.612: 100%|█| 366/366 [00:34<00:00, 10.53it/
[valid epoch 38] loss: 0.722, acc: 0.810: 100%|█| 91/91 [00:05<00:00, 16.42it/s]
Best model (head+MLP+last7Attn Stage 1) saved with accuracy: 0.8096
[train epoch 39] loss: 1.170, acc: 0.604: 100%|█| 366/366 [00:35<00:00, 10.25it/
[valid epoch 39] loss: 0.722, acc: 0.810: 100%|█| 91/91 [00:05<00:00, 16.57it/s]
Best model (head+MLP+last7Attn Stage 1) saved with accuracy: 0.8103
Stage 1 (head+MLP+last7Attn) finished. Best acc: 0.8103

=== QAT Stage 2 (6bit, head+MLP+last7Attn) ===
[train epoch 40] loss: 1.046, acc: 0.577: 100%|█| 366/366 [00:35<00:00, 10.43it/
[valid epoch 40] loss: 0.798, acc: 0.777: 100%|█| 91/91 [00:05<00:00, 16.06it/s]
Best model (head+MLP+last7Attn Stage 2) saved with accuracy: 0.7766
[train epoch 41] loss: 1.041, acc: 0.573: 100%|█| 366/366 [00:35<00:00, 10.45it/
[valid epoch 41] loss: 0.811, acc: 0.774: 100%|█| 91/91 [00:05<00:00, 16.41it/s]
[train epoch 42] loss: 1.022, acc: 0.586: 100%|█| 366/366 [00:34<00:00, 10.60it/
[valid epoch 42] loss: 0.783, acc: 0.790: 100%|█| 91/91 [00:05<00:00, 16.65it/s]
Best model (head+MLP+last7Attn Stage 2) saved with accuracy: 0.7904
[train epoch 43] loss: 1.044, acc: 0.576: 100%|█| 366/366 [00:35<00:00, 10.23it/
[valid epoch 43] loss: 0.775, acc: 0.784: 100%|█| 91/91 [00:05<00:00, 16.65it/s]
[train epoch 44] loss: 1.018, acc: 0.587: 100%|█| 366/366 [01:03<00:00,  5.75it/
[valid epoch 44] loss: 0.794, acc: 0.775: 100%|█| 91/91 [00:07<00:00, 12.23it/s]
[train epoch 45] loss: 1.007, acc: 0.589: 100%|█| 366/366 [00:35<00:00, 10.35it/
[valid epoch 45] loss: 0.760, acc: 0.801: 100%|█| 91/91 [00:05<00:00, 16.31it/s]
Best model (head+MLP+last7Attn Stage 2) saved with accuracy: 0.8007
[train epoch 46] loss: 1.029, acc: 0.578: 100%|█| 366/366 [00:35<00:00, 10.38it/
[valid epoch 46] loss: 0.767, acc: 0.799: 100%|█| 91/91 [00:13<00:00,  6.64it/s]
[train epoch 47] loss: 1.005, acc: 0.592: 100%|█| 366/366 [00:35<00:00, 10.23it/
[valid epoch 47] loss: 0.771, acc: 0.787: 100%|█| 91/91 [00:05<00:00, 16.45it/s]
[train epoch 48] loss: 0.998, acc: 0.587: 100%|█| 366/366 [00:35<00:00, 10.29it/
[valid epoch 48] loss: 0.783, acc: 0.788: 100%|█| 91/91 [00:05<00:00, 16.03it/s]
[train epoch 49] loss: 1.022, acc: 0.579: 100%|█| 366/366 [00:35<00:00, 10.35it/
[valid epoch 49] loss: 0.759, acc: 0.794: 100%|█| 91/91 [00:05<00:00, 16.27it/s]
[train epoch 50] loss: 1.010, acc: 0.584: 100%|█| 366/366 [00:35<00:00, 10.20it/
[valid epoch 50] loss: 0.748, acc: 0.799: 100%|█| 91/91 [00:05<00:00, 16.57it/s]
[train epoch 51] loss: 0.884, acc: 0.592: 100%|█| 366/366 [00:35<00:00, 10.33it/
[valid epoch 51] loss: 0.738, acc: 0.795: 100%|█| 91/91 [00:05<00:00, 16.65it/s]
[train epoch 52] loss: 0.867, acc: 0.603: 100%|█| 366/366 [00:35<00:00, 10.37it/
[valid epoch 52] loss: 0.730, acc: 0.801: 100%|█| 91/91 [00:05<00:00, 16.50it/s]
[train epoch 53] loss: 0.882, acc: 0.593: 100%|█| 366/366 [00:35<00:00, 10.35it/
[valid epoch 53] loss: 0.766, acc: 0.788: 100%|█| 91/91 [00:12<00:00,  7.06it/s]
[train epoch 54] loss: 0.885, acc: 0.594: 100%|█| 366/366 [00:42<00:00,  8.55it/
[valid epoch 54] loss: 0.731, acc: 0.793: 100%|█| 91/91 [00:05<00:00, 16.54it/s]
[train epoch 55] loss: 0.880, acc: 0.595: 100%|█| 366/366 [00:40<00:00,  9.08it/
[valid epoch 55] loss: 0.741, acc: 0.797: 100%|█| 91/91 [00:05<00:00, 16.63it/s]
[train epoch 56] loss: 0.866, acc: 0.606: 100%|█| 366/366 [00:34<00:00, 10.63it/
[valid epoch 56] loss: 0.733, acc: 0.801: 100%|█| 91/91 [00:05<00:00, 16.53it/s]
Best model (head+MLP+last7Attn Stage 2) saved with accuracy: 0.8014
[train epoch 57] loss: 0.887, acc: 0.586: 100%|█| 366/366 [00:34<00:00, 10.73it/
[valid epoch 57] loss: 0.728, acc: 0.800: 100%|█| 91/91 [00:05<00:00, 16.53it/s]
[train epoch 58] loss: 0.847, acc: 0.613: 100%|█| 366/366 [00:33<00:00, 10.84it/
[valid epoch 58] loss: 0.727, acc: 0.790: 100%|█| 91/91 [00:05<00:00, 16.79it/s]
[train epoch 59] loss: 0.854, acc: 0.602: 100%|█| 366/366 [00:33<00:00, 10.94it/
[valid epoch 59] loss: 0.718, acc: 0.808: 100%|█| 91/91 [00:05<00:00, 16.76it/s]
Best model (head+MLP+last7Attn Stage 2) saved with accuracy: 0.8076
[train epoch 60] loss: 0.831, acc: 0.617: 100%|█| 366/366 [00:34<00:00, 10.69it/
[valid epoch 60] loss: 0.719, acc: 0.804: 100%|█| 91/91 [00:05<00:00, 16.57it/s]
[train epoch 61] loss: 0.853, acc: 0.606: 100%|█| 366/366 [00:33<00:00, 10.87it/
[valid epoch 61] loss: 0.716, acc: 0.802: 100%|█| 91/91 [00:05<00:00, 16.54it/s]
[train epoch 62] loss: 0.852, acc: 0.605: 100%|█| 366/366 [00:34<00:00, 10.75it/
[valid epoch 62] loss: 0.711, acc: 0.803: 100%|█| 91/91 [00:05<00:00, 16.69it/s]
[train epoch 63] loss: 0.851, acc: 0.608: 100%|█| 366/366 [00:34<00:00, 10.61it/
[valid epoch 63] loss: 0.707, acc: 0.805: 100%|█| 91/91 [00:05<00:00, 16.57it/s]
[train epoch 64] loss: 0.821, acc: 0.625: 100%|█| 366/366 [00:34<00:00, 10.66it/
[valid epoch 64] loss: 0.703, acc: 0.804: 100%|█| 91/91 [00:05<00:00, 16.65it/s]
[train epoch 65] loss: 0.839, acc: 0.609: 100%|█| 366/366 [00:33<00:00, 11.02it/
[valid epoch 65] loss: 0.703, acc: 0.810: 100%|█| 91/91 [00:05<00:00, 16.64it/s]
Best model (head+MLP+last7Attn Stage 2) saved with accuracy: 0.8096
[train epoch 66] loss: 0.843, acc: 0.611: 100%|█| 366/366 [00:33<00:00, 10.81it/
[valid epoch 66] loss: 0.704, acc: 0.807: 100%|█| 91/91 [00:05<00:00, 16.79it/s]
[train epoch 67] loss: 0.839, acc: 0.611: 100%|█| 366/366 [00:34<00:00, 10.74it/
[valid epoch 67] loss: 0.701, acc: 0.805: 100%|█| 91/91 [00:05<00:00, 16.73it/s]
[train epoch 68] loss: 0.837, acc: 0.615: 100%|█| 366/366 [00:33<00:00, 10.80it/
[valid epoch 68] loss: 0.699, acc: 0.811: 100%|█| 91/91 [00:05<00:00, 16.76it/s]
Best model (head+MLP+last7Attn Stage 2) saved with accuracy: 0.8110
[train epoch 69] loss: 0.825, acc: 0.622: 100%|█| 366/366 [00:33<00:00, 10.78it/
[valid epoch 69] loss: 0.699, acc: 0.810: 100%|█| 91/91 [00:05<00:00, 16.73it/s]
Stage 2 (head+MLP+last7Attn) finished. Best acc: 0.8110

=== QAT Stage 3 (4bit, head+MLP+last7Attn) ===
[train epoch 70] loss: 0.802, acc: 0.440: 100%|█| 366/366 [00:34<00:00, 10.65it/
[valid epoch 70] loss: 1.243, acc: 0.650: 100%|█| 91/91 [00:05<00:00, 16.76it/s]
Best model (head+MLP+last7Attn Stage 3) saved with accuracy: 0.6502
[train epoch 71] loss: 0.701, acc: 0.479: 100%|█| 366/366 [00:34<00:00, 10.73it/
[valid epoch 71] loss: 1.140, acc: 0.673: 100%|█| 91/91 [00:05<00:00, 16.81it/s]
Best model (head+MLP+last7Attn Stage 3) saved with accuracy: 0.6729
[train epoch 72] loss: 0.654, acc: 0.497: 100%|█| 366/366 [00:33<00:00, 10.95it/
[valid epoch 72] loss: 1.085, acc: 0.680: 100%|█| 91/91 [00:05<00:00, 16.95it/s]
Best model (head+MLP+last7Attn Stage 3) saved with accuracy: 0.6797
[train epoch 73] loss: 0.641, acc: 0.502: 100%|█| 366/366 [00:33<00:00, 10.90it/
[valid epoch 73] loss: 1.089, acc: 0.693: 100%|█| 91/91 [00:05<00:00, 16.87it/s]
Best model (head+MLP+last7Attn Stage 3) saved with accuracy: 0.6928
[train epoch 74] loss: 0.625, acc: 0.507: 100%|█| 366/366 [00:34<00:00, 10.56it/
[valid epoch 74] loss: 1.054, acc: 0.683: 100%|█| 91/91 [00:05<00:00, 16.91it/s]
[train epoch 75] loss: 0.629, acc: 0.502: 100%|█| 366/366 [00:33<00:00, 10.77it/
[valid epoch 75] loss: 1.044, acc: 0.693: 100%|█| 91/91 [00:05<00:00, 16.79it/s]
[train epoch 76] loss: 0.616, acc: 0.515: 100%|█| 366/366 [00:33<00:00, 10.87it/
[valid epoch 76] loss: 1.011, acc: 0.703: 100%|█| 91/91 [00:05<00:00, 16.83it/s]
Best model (head+MLP+last7Attn Stage 3) saved with accuracy: 0.7031
[train epoch 77] loss: 0.616, acc: 0.516: 100%|█| 366/366 [00:34<00:00, 10.74it/
[valid epoch 77] loss: 1.040, acc: 0.693: 100%|█| 91/91 [00:05<00:00, 16.88it/s]
[train epoch 78] loss: 0.606, acc: 0.502: 100%|█| 366/366 [00:34<00:00, 10.67it/
[valid epoch 78] loss: 1.011, acc: 0.698: 100%|█| 91/91 [00:05<00:00, 16.99it/s]
[train epoch 79] loss: 0.595, acc: 0.517: 100%|█| 366/366 [00:34<00:00, 10.76it/
[valid epoch 79] loss: 1.020, acc: 0.700: 100%|█| 91/91 [00:05<00:00, 16.92it/s]
[train epoch 80] loss: 0.598, acc: 0.519: 100%|█| 366/366 [00:34<00:00, 10.69it/
[valid epoch 80] loss: 1.003, acc: 0.725: 100%|█| 91/91 [00:05<00:00, 16.83it/s]
Best model (head+MLP+last7Attn Stage 3) saved with accuracy: 0.7251
[train epoch 81] loss: 0.576, acc: 0.529: 100%|█| 366/366 [00:33<00:00, 10.89it/
[valid epoch 81] loss: 1.086, acc: 0.680: 100%|█| 91/91 [00:05<00:00, 16.93it/s]
[train epoch 82] loss: 0.590, acc: 0.522: 100%|█| 366/366 [00:35<00:00, 10.32it/
[valid epoch 82] loss: 0.981, acc: 0.711: 100%|█| 91/91 [00:05<00:00, 16.87it/s]
[train epoch 83] loss: 0.578, acc: 0.520: 100%|█| 366/366 [00:34<00:00, 10.72it/
[valid epoch 83] loss: 0.966, acc: 0.720: 100%|█| 91/91 [00:05<00:00, 16.91it/s]
[train epoch 84] loss: 0.570, acc: 0.525: 100%|█| 366/366 [00:34<00:00, 10.65it/
[valid epoch 84] loss: 1.010, acc: 0.698: 100%|█| 91/91 [00:05<00:00, 16.79it/s]
[train epoch 85] loss: 0.568, acc: 0.523: 100%|█| 366/366 [00:35<00:00, 10.32it/
[valid epoch 85] loss: 0.956, acc: 0.728: 100%|█| 91/91 [00:05<00:00, 16.80it/s]
Best model (head+MLP+last7Attn Stage 3) saved with accuracy: 0.7278
[train epoch 86] loss: 0.550, acc: 0.537: 100%|█| 366/366 [00:35<00:00, 10.18it/
[valid epoch 86] loss: 0.969, acc: 0.720: 100%|█| 91/91 [00:05<00:00, 16.37it/s]
[train epoch 87] loss: 0.565, acc: 0.521: 100%|█| 366/366 [00:35<00:00, 10.33it/
[valid epoch 87] loss: 0.950, acc: 0.719: 100%|█| 91/91 [00:05<00:00, 16.25it/s]
[train epoch 88] loss: 0.540, acc: 0.544: 100%|█| 366/366 [00:35<00:00, 10.23it/
[valid epoch 88] loss: 0.947, acc: 0.729: 100%|█| 91/91 [00:05<00:00, 16.69it/s]
Best model (head+MLP+last7Attn Stage 3) saved with accuracy: 0.7292
[train epoch 89] loss: 0.556, acc: 0.532: 100%|█| 366/366 [00:35<00:00, 10.43it/
[valid epoch 89] loss: 0.943, acc: 0.725: 100%|█| 91/91 [00:05<00:00, 16.73it/s]
[train epoch 90] loss: 0.724, acc: 0.532: 100%|█| 366/366 [00:34<00:00, 10.58it/
[valid epoch 90] loss: 0.928, acc: 0.733: 100%|█| 91/91 [00:05<00:00, 16.25it/s]
Best model (head+MLP+last7Attn Stage 3) saved with accuracy: 0.7333
[train epoch 91] loss: 0.715, acc: 0.553: 100%|█| 366/366 [00:35<00:00, 10.29it/
[valid epoch 91] loss: 0.940, acc: 0.719: 100%|█| 91/91 [00:05<00:00, 16.60it/s]
[train epoch 92] loss: 0.706, acc: 0.543: 100%|█| 366/366 [00:35<00:00, 10.29it/
[valid epoch 92] loss: 0.896, acc: 0.743: 100%|█| 91/91 [00:05<00:00, 16.74it/s]
Best model (head+MLP+last7Attn Stage 3) saved with accuracy: 0.7430
[train epoch 93] loss: 0.700, acc: 0.557: 100%|█| 366/366 [00:35<00:00, 10.20it/
[valid epoch 93] loss: 0.897, acc: 0.735: 100%|█| 91/91 [00:05<00:00, 16.64it/s]
[train epoch 94] loss: 0.690, acc: 0.547: 100%|█| 366/366 [00:35<00:00, 10.38it/
[valid epoch 94] loss: 0.907, acc: 0.735: 100%|█| 91/91 [00:05<00:00, 16.69it/s]
[train epoch 95] loss: 0.692, acc: 0.557: 100%|█| 366/366 [00:34<00:00, 10.48it/
[valid epoch 95] loss: 0.892, acc: 0.746: 100%|█| 91/91 [00:05<00:00, 16.79it/s]
Best model (head+MLP+last7Attn Stage 3) saved with accuracy: 0.7457
[train epoch 96] loss: 0.688, acc: 0.557: 100%|█| 366/366 [00:34<00:00, 10.47it/
[valid epoch 96] loss: 0.880, acc: 0.741: 100%|█| 91/91 [00:05<00:00, 16.68it/s]
[train epoch 97] loss: 0.684, acc: 0.554: 100%|█| 366/366 [00:34<00:00, 10.74it/
[valid epoch 97] loss: 0.891, acc: 0.749: 100%|█| 91/91 [00:05<00:00, 16.72it/s]
Best model (head+MLP+last7Attn Stage 3) saved with accuracy: 0.7491
[train epoch 98] loss: 0.664, acc: 0.562: 100%|█| 366/366 [00:34<00:00, 10.71it/
[valid epoch 98] loss: 0.868, acc: 0.756: 100%|█| 91/91 [00:05<00:00, 16.68it/s]
Best model (head+MLP+last7Attn Stage 3) saved with accuracy: 0.7560
[train epoch 99] loss: 0.678, acc: 0.553: 100%|█| 366/366 [00:33<00:00, 10.83it/
[valid epoch 99] loss: 0.861, acc: 0.761: 100%|█| 91/91 [00:05<00:00, 16.81it/s]
Best model (head+MLP+last7Attn Stage 3) saved with accuracy: 0.7608
[train epoch 100] loss: 0.672, acc: 0.558: 100%|█| 366/366 [00:34<00:00, 10.60it
[valid epoch 100] loss: 0.857, acc: 0.759: 100%|█| 91/91 [00:05<00:00, 17.00it/s
[train epoch 101] loss: 0.677, acc: 0.555: 100%|█| 366/366 [00:34<00:00, 10.69it
[valid epoch 101] loss: 0.865, acc: 0.759: 100%|█| 91/91 [00:05<00:00, 16.88it/s
[train epoch 102] loss: 0.660, acc: 0.560: 100%|█| 366/366 [00:35<00:00, 10.44it
[valid epoch 102] loss: 0.857, acc: 0.760: 100%|█| 91/91 [00:05<00:00, 16.77it/s
[train epoch 103] loss: 0.658, acc: 0.573: 100%|█| 366/366 [00:33<00:00, 10.96it
[valid epoch 103] loss: 0.845, acc: 0.764: 100%|█| 91/91 [00:05<00:00, 16.85it/s
Best model (head+MLP+last7Attn Stage 3) saved with accuracy: 0.7643
[train epoch 104] loss: 0.648, acc: 0.578: 100%|█| 366/366 [00:35<00:00, 10.20it
[valid epoch 104] loss: 0.857, acc: 0.755: 100%|█| 91/91 [00:05<00:00, 16.73it/s
[train epoch 105] loss: 0.681, acc: 0.551: 100%|█| 366/366 [00:36<00:00,  9.96it
[valid epoch 105] loss: 0.858, acc: 0.758: 100%|█| 91/91 [00:05<00:00, 16.78it/s
[train epoch 106] loss: 0.644, acc: 0.579: 100%|█| 366/366 [00:35<00:00, 10.42it
[valid epoch 106] loss: 0.848, acc: 0.762: 100%|█| 91/91 [00:05<00:00, 16.08it/s
[train epoch 107] loss: 0.653, acc: 0.570: 100%|█| 366/366 [00:34<00:00, 10.61it
[valid epoch 107] loss: 0.858, acc: 0.762: 100%|█| 91/91 [00:05<00:00, 16.76it/s
[train epoch 108] loss: 0.642, acc: 0.573: 100%|█| 366/366 [00:34<00:00, 10.49it
[valid epoch 108] loss: 0.853, acc: 0.759: 100%|█| 91/91 [00:05<00:00, 16.64it/s
[train epoch 109] loss: 0.643, acc: 0.581: 100%|█| 366/366 [00:35<00:00, 10.40it
[valid epoch 109] loss: 0.845, acc: 0.762: 100%|█| 91/91 [00:05<00:00, 16.90it/s
Stage 3 (head+MLP+last7Attn) finished. Best acc: 0.7643
Progressive QAT completed. Best validation accuracy: 0.8110

==== Sweep 8: head+MLP+last8Attn ====

=== QAT Stage 1 (8bit, head+MLP+last8Attn) ===
[train epoch 0] loss: 2.109, acc: 0.256: 100%|█| 366/366 [00:35<00:00, 10.24it/s
[valid epoch 0] loss: 1.819, acc: 0.428: 100%|██| 91/91 [00:05<00:00, 16.37it/s]
Best model (head+MLP+last8Attn Stage 1) saved with accuracy: 0.4282
[train epoch 1] loss: 1.860, acc: 0.344: 100%|█| 366/366 [00:35<00:00, 10.36it/s
[valid epoch 1] loss: 1.684, acc: 0.485: 100%|██| 91/91 [00:05<00:00, 16.44it/s]
Best model (head+MLP+last8Attn Stage 1) saved with accuracy: 0.4845
[train epoch 2] loss: 1.797, acc: 0.373: 100%|█| 366/366 [00:35<00:00, 10.26it/s
[valid epoch 2] loss: 1.587, acc: 0.514: 100%|██| 91/91 [00:05<00:00, 16.46it/s]
Best model (head+MLP+last8Attn Stage 1) saved with accuracy: 0.5141
[train epoch 3] loss: 1.754, acc: 0.385: 100%|█| 366/366 [00:34<00:00, 10.47it/s
[valid epoch 3] loss: 1.616, acc: 0.511: 100%|██| 91/91 [00:05<00:00, 16.57it/s]
[train epoch 4] loss: 1.710, acc: 0.403: 100%|█| 366/366 [00:35<00:00, 10.34it/s
[valid epoch 4] loss: 1.447, acc: 0.570: 100%|██| 91/91 [00:05<00:00, 16.32it/s]
Best model (head+MLP+last8Attn Stage 1) saved with accuracy: 0.5704
[train epoch 5] loss: 1.679, acc: 0.422: 100%|█| 366/366 [00:36<00:00, 10.10it/s
[valid epoch 5] loss: 1.415, acc: 0.582: 100%|██| 91/91 [00:05<00:00, 16.47it/s]
Best model (head+MLP+last8Attn Stage 1) saved with accuracy: 0.5821
[train epoch 6] loss: 1.692, acc: 0.410: 100%|█| 366/366 [00:35<00:00, 10.37it/s
[valid epoch 6] loss: 1.385, acc: 0.605: 100%|██| 91/91 [00:05<00:00, 16.44it/s]
Best model (head+MLP+last8Attn Stage 1) saved with accuracy: 0.6055
[train epoch 7] loss: 1.674, acc: 0.421: 100%|█| 366/366 [00:35<00:00, 10.28it/s
[valid epoch 7] loss: 1.390, acc: 0.599: 100%|██| 91/91 [00:05<00:00, 16.29it/s]
[train epoch 8] loss: 1.655, acc: 0.432: 100%|█| 366/366 [00:35<00:00, 10.31it/s
[valid epoch 8] loss: 1.387, acc: 0.606: 100%|██| 91/91 [00:05<00:00, 16.44it/s]
Best model (head+MLP+last8Attn Stage 1) saved with accuracy: 0.6062
[train epoch 9] loss: 1.618, acc: 0.443: 100%|█| 366/366 [00:35<00:00, 10.33it/s
[valid epoch 9] loss: 1.328, acc: 0.602: 100%|██| 91/91 [00:06<00:00, 15.07it/s]
[train epoch 10] loss: 1.628, acc: 0.436: 100%|█| 366/366 [00:35<00:00, 10.26it/
[valid epoch 10] loss: 1.307, acc: 0.614: 100%|█| 91/91 [00:05<00:00, 16.50it/s]
Best model (head+MLP+last8Attn Stage 1) saved with accuracy: 0.6144
[train epoch 11] loss: 1.599, acc: 0.443: 100%|█| 366/366 [00:35<00:00, 10.19it/
[valid epoch 11] loss: 1.281, acc: 0.624: 100%|█| 91/91 [00:05<00:00, 16.42it/s]
Best model (head+MLP+last8Attn Stage 1) saved with accuracy: 0.6241
[train epoch 12] loss: 1.592, acc: 0.451: 100%|█| 366/366 [00:35<00:00, 10.19it/
[valid epoch 12] loss: 1.272, acc: 0.619: 100%|█| 91/91 [00:05<00:00, 16.37it/s]
[train epoch 13] loss: 1.554, acc: 0.459: 100%|█| 366/366 [00:35<00:00, 10.20it/
[valid epoch 13] loss: 1.271, acc: 0.633: 100%|█| 91/91 [00:05<00:00, 16.48it/s]
Best model (head+MLP+last8Attn Stage 1) saved with accuracy: 0.6330
[train epoch 14] loss: 1.574, acc: 0.453: 100%|█| 366/366 [00:35<00:00, 10.30it/
[valid epoch 14] loss: 1.290, acc: 0.623: 100%|█| 91/91 [00:05<00:00, 16.30it/s]
[train epoch 15] loss: 1.542, acc: 0.468: 100%|█| 366/366 [00:36<00:00,  9.94it/
[valid epoch 15] loss: 1.341, acc: 0.595: 100%|█| 91/91 [00:05<00:00, 16.43it/s]
[train epoch 16] loss: 1.518, acc: 0.473: 100%|█| 366/366 [00:36<00:00, 10.12it/
[valid epoch 16] loss: 1.205, acc: 0.657: 100%|█| 91/91 [00:05<00:00, 16.52it/s]
Best model (head+MLP+last8Attn Stage 1) saved with accuracy: 0.6570
[train epoch 17] loss: 1.515, acc: 0.480: 100%|█| 366/366 [00:37<00:00,  9.67it/
[valid epoch 17] loss: 1.173, acc: 0.650: 100%|█| 91/91 [00:05<00:00, 16.51it/s]
[train epoch 18] loss: 1.492, acc: 0.486: 100%|█| 366/366 [00:35<00:00, 10.29it/
[valid epoch 18] loss: 1.178, acc: 0.652: 100%|█| 91/91 [00:05<00:00, 16.25it/s]
[train epoch 19] loss: 1.443, acc: 0.501: 100%|█| 366/366 [00:35<00:00, 10.37it/
[valid epoch 19] loss: 1.177, acc: 0.648: 100%|█| 91/91 [00:05<00:00, 16.23it/s]
[train epoch 20] loss: 1.466, acc: 0.492: 100%|█| 366/366 [00:35<00:00, 10.17it/
[valid epoch 20] loss: 1.173, acc: 0.649: 100%|█| 91/91 [00:05<00:00, 16.49it/s]
[train epoch 21] loss: 1.455, acc: 0.501: 100%|█| 366/366 [00:35<00:00, 10.43it/
[valid epoch 21] loss: 1.160, acc: 0.663: 100%|█| 91/91 [00:05<00:00, 16.44it/s]
Best model (head+MLP+last8Attn Stage 1) saved with accuracy: 0.6625
[train epoch 22] loss: 1.447, acc: 0.507: 100%|█| 366/366 [00:34<00:00, 10.48it/
[valid epoch 22] loss: 1.147, acc: 0.657: 100%|█| 91/91 [00:05<00:00, 16.35it/s]
[train epoch 23] loss: 1.425, acc: 0.509: 100%|█| 366/366 [00:35<00:00, 10.23it/
[valid epoch 23] loss: 1.085, acc: 0.672: 100%|█| 91/91 [00:05<00:00, 16.35it/s]
Best model (head+MLP+last8Attn Stage 1) saved with accuracy: 0.6722
[train epoch 24] loss: 1.410, acc: 0.511: 100%|█| 366/366 [00:35<00:00, 10.24it/
[valid epoch 24] loss: 1.078, acc: 0.680: 100%|█| 91/91 [00:05<00:00, 16.46it/s]
Best model (head+MLP+last8Attn Stage 1) saved with accuracy: 0.6797
[train epoch 25] loss: 1.395, acc: 0.516: 100%|█| 366/366 [00:36<00:00, 10.12it/
[valid epoch 25] loss: 1.076, acc: 0.689: 100%|█| 91/91 [00:05<00:00, 16.45it/s]
Best model (head+MLP+last8Attn Stage 1) saved with accuracy: 0.6887
[train epoch 26] loss: 1.368, acc: 0.528: 100%|█| 366/366 [00:35<00:00, 10.23it/
[valid epoch 26] loss: 1.060, acc: 0.698: 100%|█| 91/91 [00:05<00:00, 16.33it/s]
Best model (head+MLP+last8Attn Stage 1) saved with accuracy: 0.6976
[train epoch 27] loss: 1.365, acc: 0.530: 100%|█| 366/366 [00:35<00:00, 10.23it/
[valid epoch 27] loss: 1.013, acc: 0.704: 100%|█| 91/91 [00:05<00:00, 16.44it/s]
Best model (head+MLP+last8Attn Stage 1) saved with accuracy: 0.7045
[train epoch 28] loss: 1.356, acc: 0.532: 100%|█| 366/366 [00:36<00:00,  9.90it/
[valid epoch 28] loss: 1.000, acc: 0.706: 100%|█| 91/91 [00:05<00:00, 16.42it/s]
Best model (head+MLP+last8Attn Stage 1) saved with accuracy: 0.7058
[train epoch 29] loss: 1.348, acc: 0.534: 100%|█| 366/366 [00:35<00:00, 10.36it/
[valid epoch 29] loss: 0.992, acc: 0.705: 100%|█| 91/91 [00:05<00:00, 16.35it/s]
[train epoch 30] loss: 1.317, acc: 0.550: 100%|█| 366/366 [00:36<00:00, 10.05it/
[valid epoch 30] loss: 0.983, acc: 0.715: 100%|█| 91/91 [00:05<00:00, 16.35it/s]
Best model (head+MLP+last8Attn Stage 1) saved with accuracy: 0.7155
[train epoch 31] loss: 1.360, acc: 0.526: 100%|█| 366/366 [00:36<00:00, 10.10it/
[valid epoch 31] loss: 0.977, acc: 0.715: 100%|█| 91/91 [00:05<00:00, 16.44it/s]
[train epoch 32] loss: 1.309, acc: 0.550: 100%|█| 366/366 [00:36<00:00, 10.01it/
[valid epoch 32] loss: 0.964, acc: 0.722: 100%|█| 91/91 [00:05<00:00, 16.41it/s]
Best model (head+MLP+last8Attn Stage 1) saved with accuracy: 0.7223
[train epoch 33] loss: 1.319, acc: 0.545: 100%|█| 366/366 [00:35<00:00, 10.41it/
[valid epoch 33] loss: 0.953, acc: 0.731: 100%|█| 91/91 [00:05<00:00, 16.42it/s]
Best model (head+MLP+last8Attn Stage 1) saved with accuracy: 0.7306
[train epoch 34] loss: 1.298, acc: 0.557: 100%|█| 366/366 [00:36<00:00, 10.06it/
[valid epoch 34] loss: 0.947, acc: 0.729: 100%|█| 91/91 [00:05<00:00, 16.32it/s]
[train epoch 35] loss: 1.296, acc: 0.555: 100%|█| 366/366 [00:36<00:00, 10.13it/
[valid epoch 35] loss: 0.939, acc: 0.729: 100%|█| 91/91 [00:05<00:00, 16.25it/s]
[train epoch 36] loss: 1.295, acc: 0.551: 100%|█| 366/366 [00:37<00:00,  9.86it/
[valid epoch 36] loss: 0.936, acc: 0.731: 100%|█| 91/91 [00:05<00:00, 16.53it/s]
[train epoch 37] loss: 1.317, acc: 0.545: 100%|█| 366/366 [00:36<00:00,  9.93it/
[valid epoch 37] loss: 0.933, acc: 0.733: 100%|█| 91/91 [00:05<00:00, 16.46it/s]
Best model (head+MLP+last8Attn Stage 1) saved with accuracy: 0.7326
[train epoch 38] loss: 1.298, acc: 0.553: 100%|█| 366/366 [00:35<00:00, 10.19it/
[valid epoch 38] loss: 0.933, acc: 0.733: 100%|█| 91/91 [00:05<00:00, 16.48it/s]
[train epoch 39] loss: 1.297, acc: 0.550: 100%|█| 366/366 [00:35<00:00, 10.25it/
[valid epoch 39] loss: 0.932, acc: 0.735: 100%|█| 91/91 [00:05<00:00, 16.32it/s]
Best model (head+MLP+last8Attn Stage 1) saved with accuracy: 0.7347
Stage 1 (head+MLP+last8Attn) finished. Best acc: 0.7347

=== QAT Stage 2 (6bit, head+MLP+last8Attn) ===
[train epoch 40] loss: 1.178, acc: 0.524: 100%|█| 366/366 [00:35<00:00, 10.36it/
[valid epoch 40] loss: 0.998, acc: 0.709: 100%|█| 91/91 [00:05<00:00, 16.45it/s]
Best model (head+MLP+last8Attn Stage 2) saved with accuracy: 0.7093
[train epoch 41] loss: 1.153, acc: 0.534: 100%|█| 366/366 [00:49<00:00,  7.42it/
[valid epoch 41] loss: 1.006, acc: 0.700: 100%|█| 91/91 [00:05<00:00, 16.43it/s]
[train epoch 42] loss: 1.161, acc: 0.528: 100%|█| 366/366 [00:36<00:00, 10.04it/
[valid epoch 42] loss: 1.033, acc: 0.704: 100%|█| 91/91 [00:05<00:00, 16.53it/s]
[train epoch 43] loss: 1.176, acc: 0.527: 100%|█| 366/366 [00:35<00:00, 10.37it/
[valid epoch 43] loss: 1.001, acc: 0.728: 100%|█| 91/91 [00:05<00:00, 15.60it/s]
Best model (head+MLP+last8Attn Stage 2) saved with accuracy: 0.7278
[train epoch 44] loss: 1.152, acc: 0.529: 100%|█| 366/366 [00:36<00:00, 10.10it/
[valid epoch 44] loss: 0.973, acc: 0.720: 100%|█| 91/91 [00:05<00:00, 16.59it/s]
[train epoch 45] loss: 1.119, acc: 0.547: 100%|█| 366/366 [00:53<00:00,  6.86it/
[valid epoch 45] loss: 0.992, acc: 0.712: 100%|█| 91/91 [00:05<00:00, 16.32it/s]
[train epoch 46] loss: 1.137, acc: 0.533: 100%|█| 366/366 [00:39<00:00,  9.18it/
[valid epoch 46] loss: 0.994, acc: 0.724: 100%|█| 91/91 [00:05<00:00, 16.20it/s]
[train epoch 47] loss: 1.125, acc: 0.542: 100%|█| 366/366 [00:35<00:00, 10.20it/
[valid epoch 47] loss: 0.971, acc: 0.716: 100%|█| 91/91 [00:05<00:00, 16.42it/s]
[train epoch 48] loss: 1.128, acc: 0.536: 100%|█| 366/366 [00:35<00:00, 10.17it/
[valid epoch 48] loss: 0.952, acc: 0.730: 100%|█| 91/91 [00:05<00:00, 16.56it/s]
Best model (head+MLP+last8Attn Stage 2) saved with accuracy: 0.7299
[train epoch 49] loss: 1.137, acc: 0.530: 100%|█| 366/366 [00:35<00:00, 10.45it/
[valid epoch 49] loss: 0.965, acc: 0.724: 100%|█| 91/91 [00:05<00:00, 16.37it/s]
[train epoch 50] loss: 1.099, acc: 0.553: 100%|█| 366/366 [00:44<00:00,  8.28it/
[valid epoch 50] loss: 0.951, acc: 0.725: 100%|█| 91/91 [00:05<00:00, 16.08it/s]
[train epoch 51] loss: 1.015, acc: 0.541: 100%|█| 366/366 [00:36<00:00, 10.06it/
[valid epoch 51] loss: 0.957, acc: 0.729: 100%|█| 91/91 [00:05<00:00, 16.48it/s]
[train epoch 52] loss: 0.999, acc: 0.551: 100%|█| 366/366 [00:35<00:00, 10.21it/
[valid epoch 52] loss: 0.953, acc: 0.726: 100%|█| 91/91 [00:05<00:00, 16.43it/s]
[train epoch 53] loss: 0.993, acc: 0.548: 100%|█| 366/366 [00:36<00:00, 10.13it/
[valid epoch 53] loss: 0.938, acc: 0.735: 100%|█| 91/91 [00:05<00:00, 16.52it/s]
Best model (head+MLP+last8Attn Stage 2) saved with accuracy: 0.7347
[train epoch 54] loss: 1.017, acc: 0.540: 100%|█| 366/366 [00:35<00:00, 10.21it/
[valid epoch 54] loss: 0.951, acc: 0.729: 100%|█| 91/91 [00:05<00:00, 16.46it/s]
[train epoch 55] loss: 0.968, acc: 0.568: 100%|█| 366/366 [00:35<00:00, 10.21it/
[valid epoch 55] loss: 0.936, acc: 0.729: 100%|█| 91/91 [00:05<00:00, 16.47it/s]
[train epoch 56] loss: 0.988, acc: 0.553: 100%|█| 366/366 [00:36<00:00, 10.02it/
[valid epoch 56] loss: 0.938, acc: 0.736: 100%|█| 91/91 [00:05<00:00, 16.47it/s]
Best model (head+MLP+last8Attn Stage 2) saved with accuracy: 0.7361
[train epoch 57] loss: 0.970, acc: 0.561: 100%|█| 366/366 [00:36<00:00, 10.01it/
[valid epoch 57] loss: 0.922, acc: 0.738: 100%|█| 91/91 [00:05<00:00, 16.47it/s]
Best model (head+MLP+last8Attn Stage 2) saved with accuracy: 0.7381
[train epoch 58] loss: 0.964, acc: 0.563: 100%|█| 366/366 [00:36<00:00, 10.04it/
[valid epoch 58] loss: 0.931, acc: 0.737: 100%|█| 91/91 [00:05<00:00, 16.55it/s]
[train epoch 59] loss: 0.960, acc: 0.568: 100%|█| 366/366 [00:36<00:00, 10.16it/
[valid epoch 59] loss: 0.902, acc: 0.744: 100%|█| 91/91 [00:05<00:00, 16.51it/s]
Best model (head+MLP+last8Attn Stage 2) saved with accuracy: 0.7436
[train epoch 60] loss: 0.954, acc: 0.567: 100%|█| 366/366 [00:35<00:00, 10.18it/
[valid epoch 60] loss: 0.906, acc: 0.746: 100%|█| 91/91 [00:05<00:00, 16.41it/s]
Best model (head+MLP+last8Attn Stage 2) saved with accuracy: 0.7457
[train epoch 61] loss: 0.957, acc: 0.561: 100%|█| 366/366 [00:35<00:00, 10.27it/
[valid epoch 61] loss: 0.913, acc: 0.744: 100%|█| 91/91 [00:05<00:00, 16.34it/s]
[train epoch 62] loss: 0.959, acc: 0.557: 100%|█| 366/366 [00:35<00:00, 10.24it/
[valid epoch 62] loss: 0.894, acc: 0.742: 100%|█| 91/91 [00:05<00:00, 16.55it/s]
[train epoch 63] loss: 0.946, acc: 0.564: 100%|█| 366/366 [00:35<00:00, 10.44it/
[valid epoch 63] loss: 0.896, acc: 0.744: 100%|█| 91/91 [00:05<00:00, 16.55it/s]
[train epoch 64] loss: 0.957, acc: 0.563: 100%|█| 366/366 [00:35<00:00, 10.37it/
[valid epoch 64] loss: 0.898, acc: 0.745: 100%|█| 91/91 [00:05<00:00, 16.46it/s]
[train epoch 65] loss: 0.947, acc: 0.573: 100%|█| 366/366 [00:35<00:00, 10.27it/
[valid epoch 65] loss: 0.887, acc: 0.749: 100%|█| 91/91 [00:05<00:00, 16.42it/s]
Best model (head+MLP+last8Attn Stage 2) saved with accuracy: 0.7491
[train epoch 66] loss: 0.955, acc: 0.565: 100%|█| 366/366 [00:35<00:00, 10.32it/
[valid epoch 66] loss: 0.888, acc: 0.744: 100%|█| 91/91 [00:05<00:00, 16.44it/s]
[train epoch 67] loss: 0.950, acc: 0.566: 100%|█| 366/366 [00:35<00:00, 10.37it/
[valid epoch 67] loss: 0.889, acc: 0.749: 100%|█| 91/91 [00:05<00:00, 16.48it/s]
[train epoch 68] loss: 0.939, acc: 0.573: 100%|█| 366/366 [00:36<00:00, 10.11it/
[valid epoch 68] loss: 0.886, acc: 0.750: 100%|█| 91/91 [00:05<00:00, 16.45it/s]
Best model (head+MLP+last8Attn Stage 2) saved with accuracy: 0.7498
[train epoch 69] loss: 0.944, acc: 0.564: 100%|█| 366/366 [00:35<00:00, 10.29it/
[valid epoch 69] loss: 0.885, acc: 0.749: 100%|█| 91/91 [00:05<00:00, 16.48it/s]
Stage 2 (head+MLP+last8Attn) finished. Best acc: 0.7498

=== QAT Stage 3 (4bit, head+MLP+last8Attn) ===
[train epoch 70] loss: 0.936, acc: 0.386: 100%|█| 366/366 [00:35<00:00, 10.30it/
[valid epoch 70] loss: 1.378, acc: 0.601: 100%|█| 91/91 [00:05<00:00, 16.57it/s]
Best model (head+MLP+last8Attn Stage 3) saved with accuracy: 0.6014
[train epoch 71] loss: 0.799, acc: 0.450: 100%|█| 366/366 [00:35<00:00, 10.28it/
[valid epoch 71] loss: 1.335, acc: 0.603: 100%|█| 91/91 [00:05<00:00, 16.57it/s]
Best model (head+MLP+last8Attn Stage 3) saved with accuracy: 0.6034
[train epoch 72] loss: 0.785, acc: 0.448: 100%|█| 366/366 [00:35<00:00, 10.30it/
[valid epoch 72] loss: 1.328, acc: 0.607: 100%|█| 91/91 [00:05<00:00, 16.38it/s]
Best model (head+MLP+last8Attn Stage 3) saved with accuracy: 0.6069
[train epoch 73] loss: 0.762, acc: 0.457: 100%|█| 366/366 [00:35<00:00, 10.24it/
[valid epoch 73] loss: 1.253, acc: 0.635: 100%|█| 91/91 [00:05<00:00, 16.33it/s]
Best model (head+MLP+last8Attn Stage 3) saved with accuracy: 0.6351
[train epoch 74] loss: 0.727, acc: 0.463: 100%|█| 366/366 [00:36<00:00, 10.16it/
[valid epoch 74] loss: 1.245, acc: 0.659: 100%|█| 91/91 [00:05<00:00, 16.05it/s]
Best model (head+MLP+last8Attn Stage 3) saved with accuracy: 0.6591
[train epoch 75] loss: 0.732, acc: 0.464: 100%|█| 366/366 [00:36<00:00, 10.15it/
[valid epoch 75] loss: 1.221, acc: 0.645: 100%|█| 91/91 [00:05<00:00, 16.56it/s]
[train epoch 76] loss: 0.707, acc: 0.473: 100%|█| 366/366 [00:35<00:00, 10.31it/
[valid epoch 76] loss: 1.290, acc: 0.614: 100%|█| 91/91 [00:05<00:00, 16.47it/s]
[train epoch 77] loss: 0.703, acc: 0.471: 100%|█| 366/366 [00:34<00:00, 10.55it/
[valid epoch 77] loss: 1.216, acc: 0.645: 100%|█| 91/91 [00:05<00:00, 16.31it/s]
[train epoch 78] loss: 0.688, acc: 0.478: 100%|█| 366/366 [00:35<00:00, 10.23it/
[valid epoch 78] loss: 1.206, acc: 0.652: 100%|█| 91/91 [00:05<00:00, 16.47it/s]
[train epoch 79] loss: 0.699, acc: 0.479: 100%|█| 366/366 [00:36<00:00,  9.95it/
[valid epoch 79] loss: 1.241, acc: 0.625: 100%|█| 91/91 [00:05<00:00, 16.38it/s]
[train epoch 80] loss: 0.698, acc: 0.473: 100%|█| 366/366 [00:36<00:00, 10.01it/
[valid epoch 80] loss: 1.212, acc: 0.645: 100%|█| 91/91 [00:05<00:00, 16.33it/s]
[train epoch 81] loss: 0.671, acc: 0.484: 100%|█| 366/366 [00:35<00:00, 10.18it/
[valid epoch 81] loss: 1.195, acc: 0.644: 100%|█| 91/91 [00:05<00:00, 16.56it/s]
[train epoch 82] loss: 0.673, acc: 0.470: 100%|█| 366/366 [00:35<00:00, 10.34it/
[valid epoch 82] loss: 1.149, acc: 0.668: 100%|█| 91/91 [00:05<00:00, 16.53it/s]
Best model (head+MLP+last8Attn Stage 3) saved with accuracy: 0.6680
[train epoch 83] loss: 0.673, acc: 0.481: 100%|█| 366/366 [00:35<00:00, 10.45it/
[valid epoch 83] loss: 1.134, acc: 0.677: 100%|█| 91/91 [00:05<00:00, 16.51it/s]
Best model (head+MLP+last8Attn Stage 3) saved with accuracy: 0.6770
[train epoch 84] loss: 0.666, acc: 0.481: 100%|█| 366/366 [00:34<00:00, 10.58it/
[valid epoch 84] loss: 1.147, acc: 0.662: 100%|█| 91/91 [00:05<00:00, 16.38it/s]
[train epoch 85] loss: 0.653, acc: 0.486: 100%|█| 366/366 [00:35<00:00, 10.20it/
[valid epoch 85] loss: 1.135, acc: 0.676: 100%|█| 91/91 [00:05<00:00, 16.28it/s]
[train epoch 86] loss: 0.654, acc: 0.482: 100%|█| 366/366 [00:35<00:00, 10.25it/
[valid epoch 86] loss: 1.110, acc: 0.677: 100%|█| 91/91 [00:05<00:00, 16.49it/s]
[train epoch 87] loss: 0.648, acc: 0.489: 100%|█| 366/366 [00:35<00:00, 10.31it/
[valid epoch 87] loss: 1.123, acc: 0.683: 100%|█| 91/91 [00:05<00:00, 16.45it/s]
Best model (head+MLP+last8Attn Stage 3) saved with accuracy: 0.6832
[train epoch 88] loss: 0.647, acc: 0.491: 100%|█| 366/366 [00:34<00:00, 10.72it/
[valid epoch 88] loss: 1.126, acc: 0.683: 100%|█| 91/91 [00:05<00:00, 16.52it/s]
[train epoch 89] loss: 0.637, acc: 0.505: 100%|█| 366/366 [00:35<00:00, 10.26it/
[valid epoch 89] loss: 1.151, acc: 0.664: 100%|█| 91/91 [00:05<00:00, 16.39it/s]
[train epoch 90] loss: 0.853, acc: 0.488: 100%|█| 366/366 [00:35<00:00, 10.18it/
[valid epoch 90] loss: 1.094, acc: 0.691: 100%|█| 91/91 [00:05<00:00, 16.45it/s]
Best model (head+MLP+last8Attn Stage 3) saved with accuracy: 0.6907
[train epoch 91] loss: 0.820, acc: 0.502: 100%|█| 366/366 [00:34<00:00, 10.52it/
[valid epoch 91] loss: 1.090, acc: 0.691: 100%|█| 91/91 [00:05<00:00, 16.42it/s]
[train epoch 92] loss: 0.816, acc: 0.512: 100%|█| 366/366 [00:35<00:00, 10.21it/
[valid epoch 92] loss: 1.071, acc: 0.692: 100%|█| 91/91 [00:05<00:00, 16.39it/s]
Best model (head+MLP+last8Attn Stage 3) saved with accuracy: 0.6921
[train epoch 93] loss: 0.808, acc: 0.503: 100%|█| 366/366 [00:36<00:00, 10.07it/
[valid epoch 93] loss: 1.067, acc: 0.703: 100%|█| 91/91 [00:05<00:00, 16.32it/s]
Best model (head+MLP+last8Attn Stage 3) saved with accuracy: 0.7031
[train epoch 94] loss: 0.807, acc: 0.507: 100%|█| 366/366 [00:36<00:00,  9.92it/
[valid epoch 94] loss: 1.078, acc: 0.682: 100%|█| 91/91 [00:05<00:00, 16.17it/s]
[train epoch 95] loss: 0.782, acc: 0.523: 100%|█| 366/366 [00:36<00:00, 10.14it/
[valid epoch 95] loss: 1.048, acc: 0.700: 100%|█| 91/91 [00:05<00:00, 16.41it/s]
[train epoch 96] loss: 0.794, acc: 0.511: 100%|█| 366/366 [00:35<00:00, 10.39it/
[valid epoch 96] loss: 1.027, acc: 0.704: 100%|█| 91/91 [00:05<00:00, 16.52it/s]
Best model (head+MLP+last8Attn Stage 3) saved with accuracy: 0.7045
[train epoch 97] loss: 0.785, acc: 0.510: 100%|█| 366/366 [00:35<00:00, 10.26it/
[valid epoch 97] loss: 1.021, acc: 0.708: 100%|█| 91/91 [00:05<00:00, 16.57it/s]
Best model (head+MLP+last8Attn Stage 3) saved with accuracy: 0.7079
[train epoch 98] loss: 0.779, acc: 0.518: 100%|█| 366/366 [00:35<00:00, 10.24it/
[valid epoch 98] loss: 1.029, acc: 0.708: 100%|█| 91/91 [00:05<00:00, 16.57it/s]
[train epoch 99] loss: 0.763, acc: 0.525: 100%|█| 366/366 [00:36<00:00,  9.99it/
[valid epoch 99] loss: 1.025, acc: 0.718: 100%|█| 91/91 [00:05<00:00, 16.23it/s]
Best model (head+MLP+last8Attn Stage 3) saved with accuracy: 0.7182
[train epoch 100] loss: 0.784, acc: 0.511: 100%|█| 366/366 [00:35<00:00, 10.17it
[valid epoch 100] loss: 1.016, acc: 0.707: 100%|█| 91/91 [00:05<00:00, 16.39it/s
[train epoch 101] loss: 0.771, acc: 0.520: 100%|█| 366/366 [00:36<00:00,  9.96it
[valid epoch 101] loss: 1.006, acc: 0.714: 100%|█| 91/91 [00:05<00:00, 16.40it/s
[train epoch 102] loss: 0.753, acc: 0.533: 100%|█| 366/366 [00:35<00:00, 10.38it
[valid epoch 102] loss: 1.017, acc: 0.713: 100%|█| 91/91 [00:05<00:00, 16.49it/s
[train epoch 103] loss: 0.763, acc: 0.520: 100%|█| 366/366 [00:34<00:00, 10.56it
[valid epoch 103] loss: 1.010, acc: 0.714: 100%|█| 91/91 [00:05<00:00, 16.43it/s
[train epoch 104] loss: 0.763, acc: 0.524: 100%|█| 366/366 [00:34<00:00, 10.48it
[valid epoch 104] loss: 1.002, acc: 0.718: 100%|█| 91/91 [00:05<00:00, 16.55it/s
[train epoch 105] loss: 0.755, acc: 0.532: 100%|█| 366/366 [00:35<00:00, 10.25it
[valid epoch 105] loss: 1.008, acc: 0.714: 100%|█| 91/91 [00:05<00:00, 16.57it/s
[train epoch 106] loss: 0.765, acc: 0.510: 100%|█| 366/366 [00:36<00:00, 10.10it
[valid epoch 106] loss: 0.998, acc: 0.720: 100%|█| 91/91 [00:05<00:00, 16.51it/s
Best model (head+MLP+last8Attn Stage 3) saved with accuracy: 0.7196
[train epoch 107] loss: 0.765, acc: 0.522: 100%|█| 366/366 [00:37<00:00,  9.86it
[valid epoch 107] loss: 0.996, acc: 0.721: 100%|█| 91/91 [00:05<00:00, 16.49it/s
Best model (head+MLP+last8Attn Stage 3) saved with accuracy: 0.7210
[train epoch 108] loss: 0.749, acc: 0.535: 100%|█| 366/366 [00:35<00:00, 10.23it
[valid epoch 108] loss: 0.998, acc: 0.719: 100%|█| 91/91 [00:05<00:00, 16.61it/s
[train epoch 109] loss: 0.754, acc: 0.530: 100%|█| 366/366 [00:35<00:00, 10.45it
[valid epoch 109] loss: 0.995, acc: 0.725: 100%|█| 91/91 [00:05<00:00, 16.50it/s
Best model (head+MLP+last8Attn Stage 3) saved with accuracy: 0.7251
Stage 3 (head+MLP+last8Attn) finished. Best acc: 0.7251
Progressive QAT completed. Best validation accuracy: 0.7498

==== Sweep 9: head+MLP+last9Attn ====

=== QAT Stage 1 (8bit, head+MLP+last9Attn) ===
[train epoch 0] loss: 2.168, acc: 0.230: 100%|█| 366/366 [00:35<00:00, 10.33it/s
[valid epoch 0] loss: 2.217, acc: 0.318: 100%|██| 91/91 [00:05<00:00, 16.37it/s]
Best model (head+MLP+last9Attn Stage 1) saved with accuracy: 0.3182
[train epoch 1] loss: 1.987, acc: 0.303: 100%|█| 366/366 [00:35<00:00, 10.26it/s
[valid epoch 1] loss: 1.856, acc: 0.412: 100%|██| 91/91 [00:05<00:00, 16.26it/s]
Best model (head+MLP+last9Attn Stage 1) saved with accuracy: 0.4124
[train epoch 2] loss: 1.914, acc: 0.330: 100%|█| 366/366 [00:34<00:00, 10.51it/s
[valid epoch 2] loss: 1.793, acc: 0.455: 100%|██| 91/91 [00:05<00:00, 15.59it/s]
Best model (head+MLP+last9Attn Stage 1) saved with accuracy: 0.4550
[train epoch 3] loss: 1.887, acc: 0.347: 100%|█| 366/366 [00:36<00:00, 10.05it/s
[valid epoch 3] loss: 1.791, acc: 0.455: 100%|██| 91/91 [00:05<00:00, 16.25it/s]
[train epoch 4] loss: 1.855, acc: 0.356: 100%|█| 366/366 [00:34<00:00, 10.49it/s
[valid epoch 4] loss: 1.757, acc: 0.465: 100%|██| 91/91 [00:05<00:00, 16.31it/s]
Best model (head+MLP+last9Attn Stage 1) saved with accuracy: 0.4653
[train epoch 5] loss: 1.858, acc: 0.352: 100%|█| 366/366 [00:35<00:00, 10.43it/s
[valid epoch 5] loss: 1.780, acc: 0.469: 100%|██| 91/91 [00:05<00:00, 16.38it/s]
Best model (head+MLP+last9Attn Stage 1) saved with accuracy: 0.4687
[train epoch 6] loss: 1.810, acc: 0.374: 100%|█| 366/366 [00:34<00:00, 10.53it/s
[valid epoch 6] loss: 1.754, acc: 0.466: 100%|██| 91/91 [00:05<00:00, 16.18it/s]
[train epoch 7] loss: 1.799, acc: 0.373: 100%|█| 366/366 [00:35<00:00, 10.32it/s
[valid epoch 7] loss: 1.682, acc: 0.489: 100%|██| 91/91 [00:05<00:00, 16.30it/s]
Best model (head+MLP+last9Attn Stage 1) saved with accuracy: 0.4887
[train epoch 8] loss: 1.792, acc: 0.380: 100%|█| 366/366 [00:35<00:00, 10.21it/s
[valid epoch 8] loss: 1.659, acc: 0.494: 100%|██| 91/91 [00:05<00:00, 16.33it/s]
Best model (head+MLP+last9Attn Stage 1) saved with accuracy: 0.4942
[train epoch 9] loss: 1.799, acc: 0.371: 100%|█| 366/366 [00:34<00:00, 10.48it/s
[valid epoch 9] loss: 1.719, acc: 0.476: 100%|██| 91/91 [00:05<00:00, 16.37it/s]
[train epoch 10] loss: 1.754, acc: 0.390: 100%|█| 366/366 [00:35<00:00, 10.34it/
[valid epoch 10] loss: 1.678, acc: 0.482: 100%|█| 91/91 [00:05<00:00, 16.35it/s]
[train epoch 11] loss: 1.753, acc: 0.389: 100%|█| 366/366 [00:35<00:00, 10.30it/
[valid epoch 11] loss: 1.577, acc: 0.516: 100%|█| 91/91 [00:05<00:00, 16.38it/s]
Best model (head+MLP+last9Attn Stage 1) saved with accuracy: 0.5162
[train epoch 12] loss: 1.741, acc: 0.393: 100%|█| 366/366 [00:35<00:00, 10.24it/
[valid epoch 12] loss: 1.581, acc: 0.526: 100%|█| 91/91 [00:05<00:00, 16.38it/s]
Best model (head+MLP+last9Attn Stage 1) saved with accuracy: 0.5258
[train epoch 13] loss: 1.714, acc: 0.405: 100%|█| 366/366 [00:35<00:00, 10.36it/
[valid epoch 13] loss: 1.522, acc: 0.544: 100%|█| 91/91 [00:05<00:00, 16.31it/s]
Best model (head+MLP+last9Attn Stage 1) saved with accuracy: 0.5443
[train epoch 14] loss: 1.698, acc: 0.404: 100%|█| 366/366 [00:35<00:00, 10.43it/
[valid epoch 14] loss: 1.529, acc: 0.537: 100%|█| 91/91 [00:05<00:00, 16.27it/s]
[train epoch 15] loss: 1.708, acc: 0.406: 100%|█| 366/366 [00:35<00:00, 10.45it/
[valid epoch 15] loss: 1.538, acc: 0.530: 100%|█| 91/91 [00:05<00:00, 16.21it/s]
[train epoch 16] loss: 1.683, acc: 0.422: 100%|█| 366/366 [00:35<00:00, 10.39it/
[valid epoch 16] loss: 1.560, acc: 0.521: 100%|█| 91/91 [00:05<00:00, 16.28it/s]
[train epoch 17] loss: 1.667, acc: 0.425: 100%|█| 366/366 [00:35<00:00, 10.32it/
[valid epoch 17] loss: 1.411, acc: 0.590: 100%|█| 91/91 [00:05<00:00, 16.25it/s]
Best model (head+MLP+last9Attn Stage 1) saved with accuracy: 0.5897
[train epoch 18] loss: 1.647, acc: 0.420: 100%|█| 366/366 [00:35<00:00, 10.30it/
[valid epoch 18] loss: 1.447, acc: 0.569: 100%|█| 91/91 [00:05<00:00, 16.44it/s]
[train epoch 19] loss: 1.636, acc: 0.433: 100%|█| 366/366 [00:35<00:00, 10.39it/
[valid epoch 19] loss: 1.393, acc: 0.588: 100%|█| 91/91 [00:05<00:00, 16.28it/s]
[train epoch 20] loss: 1.608, acc: 0.436: 100%|█| 366/366 [00:34<00:00, 10.46it/
[valid epoch 20] loss: 1.430, acc: 0.576: 100%|█| 91/91 [00:05<00:00, 16.34it/s]
[train epoch 21] loss: 1.595, acc: 0.443: 100%|█| 366/366 [00:35<00:00, 10.25it/
[valid epoch 21] loss: 1.349, acc: 0.605: 100%|█| 91/91 [00:05<00:00, 16.32it/s]
Best model (head+MLP+last9Attn Stage 1) saved with accuracy: 0.6048
[train epoch 22] loss: 1.577, acc: 0.452: 100%|█| 366/366 [00:35<00:00, 10.44it/
[valid epoch 22] loss: 1.346, acc: 0.601: 100%|█| 91/91 [00:05<00:00, 16.43it/s]
[train epoch 23] loss: 1.553, acc: 0.464: 100%|█| 366/366 [00:35<00:00, 10.45it/
[valid epoch 23] loss: 1.328, acc: 0.614: 100%|█| 91/91 [00:05<00:00, 16.28it/s]
Best model (head+MLP+last9Attn Stage 1) saved with accuracy: 0.6137
[train epoch 24] loss: 1.550, acc: 0.461: 100%|█| 366/366 [00:35<00:00, 10.39it/
[valid epoch 24] loss: 1.316, acc: 0.599: 100%|█| 91/91 [00:05<00:00, 16.28it/s]
[train epoch 25] loss: 1.539, acc: 0.470: 100%|█| 366/366 [00:34<00:00, 10.52it/
[valid epoch 25] loss: 1.268, acc: 0.621: 100%|█| 91/91 [00:05<00:00, 16.33it/s]
Best model (head+MLP+last9Attn Stage 1) saved with accuracy: 0.6213
[train epoch 26] loss: 1.506, acc: 0.480: 100%|█| 366/366 [00:34<00:00, 10.49it/
[valid epoch 26] loss: 1.294, acc: 0.613: 100%|█| 91/91 [00:05<00:00, 16.41it/s]
[train epoch 27] loss: 1.493, acc: 0.484: 100%|█| 366/366 [00:35<00:00, 10.38it/
[valid epoch 27] loss: 1.248, acc: 0.626: 100%|█| 91/91 [00:05<00:00, 16.35it/s]
Best model (head+MLP+last9Attn Stage 1) saved with accuracy: 0.6261
[train epoch 28] loss: 1.489, acc: 0.482: 100%|█| 366/366 [00:35<00:00, 10.45it/
[valid epoch 28] loss: 1.242, acc: 0.628: 100%|█| 91/91 [00:05<00:00, 16.49it/s]
Best model (head+MLP+last9Attn Stage 1) saved with accuracy: 0.6282
[train epoch 29] loss: 1.480, acc: 0.487: 100%|█| 366/366 [00:34<00:00, 10.63it/
[valid epoch 29] loss: 1.245, acc: 0.643: 100%|█| 91/91 [00:05<00:00, 16.43it/s]
Best model (head+MLP+last9Attn Stage 1) saved with accuracy: 0.6433
[train epoch 30] loss: 1.468, acc: 0.485: 100%|█| 366/366 [00:35<00:00, 10.45it/
[valid epoch 30] loss: 1.236, acc: 0.630: 100%|█| 91/91 [00:05<00:00, 16.39it/s]
[train epoch 31] loss: 1.477, acc: 0.486: 100%|█| 366/366 [00:34<00:00, 10.52it/
[valid epoch 31] loss: 1.200, acc: 0.649: 100%|█| 91/91 [00:05<00:00, 16.48it/s]
Best model (head+MLP+last9Attn Stage 1) saved with accuracy: 0.6495
[train epoch 32] loss: 1.439, acc: 0.498: 100%|█| 366/366 [00:34<00:00, 10.50it/
[valid epoch 32] loss: 1.184, acc: 0.653: 100%|█| 91/91 [00:05<00:00, 16.30it/s]
Best model (head+MLP+last9Attn Stage 1) saved with accuracy: 0.6529
[train epoch 33] loss: 1.448, acc: 0.495: 100%|█| 366/366 [00:34<00:00, 10.61it/
[valid epoch 33] loss: 1.175, acc: 0.667: 100%|█| 91/91 [00:05<00:00, 16.23it/s]
Best model (head+MLP+last9Attn Stage 1) saved with accuracy: 0.6674
[train epoch 34] loss: 1.460, acc: 0.489: 100%|█| 366/366 [00:34<00:00, 10.62it/
[valid epoch 34] loss: 1.167, acc: 0.660: 100%|█| 91/91 [00:05<00:00, 16.32it/s]
[train epoch 35] loss: 1.427, acc: 0.503: 100%|█| 366/366 [00:34<00:00, 10.52it/
[valid epoch 35] loss: 1.166, acc: 0.665: 100%|█| 91/91 [00:05<00:00, 16.32it/s]
[train epoch 36] loss: 1.416, acc: 0.505: 100%|█| 366/366 [00:34<00:00, 10.50it/
[valid epoch 36] loss: 1.157, acc: 0.655: 100%|█| 91/91 [00:05<00:00, 16.29it/s]
[train epoch 37] loss: 1.422, acc: 0.509: 100%|█| 366/366 [00:35<00:00, 10.33it/
[valid epoch 37] loss: 1.156, acc: 0.663: 100%|█| 91/91 [00:05<00:00, 16.28it/s]
[train epoch 38] loss: 1.423, acc: 0.504: 100%|█| 366/366 [00:34<00:00, 10.52it/
[valid epoch 38] loss: 1.157, acc: 0.665: 100%|█| 91/91 [00:05<00:00, 16.35it/s]
[train epoch 39] loss: 1.418, acc: 0.503: 100%|█| 366/366 [00:39<00:00,  9.37it/
[valid epoch 39] loss: 1.149, acc: 0.663: 100%|█| 91/91 [00:05<00:00, 15.72it/s]
Stage 1 (head+MLP+last9Attn) finished. Best acc: 0.6674

=== QAT Stage 2 (6bit, head+MLP+last9Attn) ===
[train epoch 40] loss: 1.284, acc: 0.491: 100%|█| 366/366 [00:35<00:00, 10.39it/
[valid epoch 40] loss: 1.225, acc: 0.646: 100%|█| 91/91 [00:05<00:00, 16.46it/s]
Best model (head+MLP+last9Attn Stage 2) saved with accuracy: 0.6460
[train epoch 41] loss: 1.293, acc: 0.482: 100%|█| 366/366 [00:35<00:00, 10.26it/
[valid epoch 41] loss: 1.221, acc: 0.647: 100%|█| 91/91 [00:05<00:00, 16.39it/s]
Best model (head+MLP+last9Attn Stage 2) saved with accuracy: 0.6474
[train epoch 42] loss: 1.286, acc: 0.479: 100%|█| 366/366 [00:35<00:00, 10.41it/
[valid epoch 42] loss: 1.206, acc: 0.646: 100%|█| 91/91 [00:05<00:00, 16.31it/s]
[train epoch 43] loss: 1.299, acc: 0.482: 100%|█| 366/366 [00:35<00:00, 10.19it/
[valid epoch 43] loss: 1.199, acc: 0.649: 100%|█| 91/91 [00:05<00:00, 16.39it/s]
Best model (head+MLP+last9Attn Stage 2) saved with accuracy: 0.6488
[train epoch 44] loss: 1.287, acc: 0.482: 100%|█| 366/366 [00:36<00:00, 10.05it/
[valid epoch 44] loss: 1.225, acc: 0.638: 100%|█| 91/91 [00:05<00:00, 16.40it/s]
[train epoch 45] loss: 1.268, acc: 0.490: 100%|█| 366/366 [00:42<00:00,  8.60it/
[valid epoch 45] loss: 1.186, acc: 0.649: 100%|█| 91/91 [00:05<00:00, 15.94it/s]
[train epoch 46] loss: 1.248, acc: 0.500: 100%|█| 366/366 [00:36<00:00, 10.09it/
[valid epoch 46] loss: 1.187, acc: 0.644: 100%|█| 91/91 [00:05<00:00, 16.22it/s]
[train epoch 47] loss: 1.252, acc: 0.497: 100%|█| 366/366 [00:35<00:00, 10.44it/
[valid epoch 47] loss: 1.170, acc: 0.649: 100%|█| 91/91 [00:05<00:00, 16.37it/s]
Best model (head+MLP+last9Attn Stage 2) saved with accuracy: 0.6495
[train epoch 48] loss: 1.283, acc: 0.482: 100%|█| 366/366 [00:36<00:00,  9.96it/
[valid epoch 48] loss: 1.193, acc: 0.650: 100%|█| 91/91 [00:05<00:00, 16.36it/s]
Best model (head+MLP+last9Attn Stage 2) saved with accuracy: 0.6502
[train epoch 49] loss: 1.257, acc: 0.493: 100%|█| 366/366 [00:35<00:00, 10.37it/
[valid epoch 49] loss: 1.183, acc: 0.658: 100%|█| 91/91 [00:05<00:00, 16.16it/s]
Best model (head+MLP+last9Attn Stage 2) saved with accuracy: 0.6584
[train epoch 50] loss: 1.249, acc: 0.496: 100%|█| 366/366 [00:35<00:00, 10.29it/
[valid epoch 50] loss: 1.142, acc: 0.665: 100%|█| 91/91 [00:05<00:00, 16.46it/s]
Best model (head+MLP+last9Attn Stage 2) saved with accuracy: 0.6653
[train epoch 51] loss: 1.133, acc: 0.496: 100%|█| 366/366 [00:34<00:00, 10.50it/
[valid epoch 51] loss: 1.142, acc: 0.672: 100%|█| 91/91 [00:05<00:00, 16.48it/s]
Best model (head+MLP+last9Attn Stage 2) saved with accuracy: 0.6722
[train epoch 52] loss: 1.122, acc: 0.503: 100%|█| 366/366 [00:34<00:00, 10.49it/
[valid epoch 52] loss: 1.157, acc: 0.660: 100%|█| 91/91 [00:05<00:00, 16.38it/s]
[train epoch 53] loss: 1.143, acc: 0.491: 100%|█| 366/366 [00:37<00:00,  9.87it/
[valid epoch 53] loss: 1.153, acc: 0.658: 100%|█| 91/91 [00:07<00:00, 11.49it/s]
[train epoch 54] loss: 1.119, acc: 0.503: 100%|█| 366/366 [00:34<00:00, 10.59it/
[valid epoch 54] loss: 1.119, acc: 0.675: 100%|█| 91/91 [00:05<00:00, 16.25it/s]
Best model (head+MLP+last9Attn Stage 2) saved with accuracy: 0.6749
[train epoch 55] loss: 1.131, acc: 0.500: 100%|█| 366/366 [00:34<00:00, 10.47it/
[valid epoch 55] loss: 1.150, acc: 0.666: 100%|█| 91/91 [00:05<00:00, 16.45it/s]
[train epoch 56] loss: 1.104, acc: 0.511: 100%|█| 366/366 [00:34<00:00, 10.68it/
[valid epoch 56] loss: 1.149, acc: 0.660: 100%|█| 91/91 [00:05<00:00, 16.44it/s]
[train epoch 57] loss: 1.098, acc: 0.512: 100%|█| 366/366 [00:34<00:00, 10.66it/
[valid epoch 57] loss: 1.146, acc: 0.663: 100%|█| 91/91 [00:05<00:00, 16.31it/s]
[train epoch 58] loss: 1.107, acc: 0.506: 100%|█| 366/366 [00:35<00:00, 10.44it/
[valid epoch 58] loss: 1.106, acc: 0.671: 100%|█| 91/91 [00:05<00:00, 16.40it/s]
[train epoch 59] loss: 1.064, acc: 0.530: 100%|█| 366/366 [00:35<00:00, 10.39it/
[valid epoch 59] loss: 1.106, acc: 0.679: 100%|█| 91/91 [00:05<00:00, 16.35it/s]
Best model (head+MLP+last9Attn Stage 2) saved with accuracy: 0.6790
[train epoch 60] loss: 1.082, acc: 0.512: 100%|█| 366/366 [00:34<00:00, 10.51it/
[valid epoch 60] loss: 1.101, acc: 0.683: 100%|█| 91/91 [00:05<00:00, 16.44it/s]
Best model (head+MLP+last9Attn Stage 2) saved with accuracy: 0.6832
[train epoch 61] loss: 1.107, acc: 0.508: 100%|█| 366/366 [00:35<00:00, 10.36it/
[valid epoch 61] loss: 1.119, acc: 0.682: 100%|█| 91/91 [00:05<00:00, 16.28it/s]
[train epoch 62] loss: 1.058, acc: 0.529: 100%|█| 366/366 [00:34<00:00, 10.52it/
[valid epoch 62] loss: 1.095, acc: 0.685: 100%|█| 91/91 [00:05<00:00, 16.38it/s]
Best model (head+MLP+last9Attn Stage 2) saved with accuracy: 0.6852
[train epoch 63] loss: 1.075, acc: 0.520: 100%|█| 366/366 [00:35<00:00, 10.45it/
[valid epoch 63] loss: 1.101, acc: 0.678: 100%|█| 91/91 [00:05<00:00, 16.50it/s]
[train epoch 64] loss: 1.044, acc: 0.538: 100%|█| 366/366 [00:34<00:00, 10.51it/
[valid epoch 64] loss: 1.090, acc: 0.678: 100%|█| 91/91 [00:05<00:00, 16.45it/s]
[train epoch 65] loss: 1.098, acc: 0.511: 100%|█| 366/366 [00:34<00:00, 10.52it/
[valid epoch 65] loss: 1.093, acc: 0.686: 100%|█| 91/91 [00:05<00:00, 16.31it/s]
Best model (head+MLP+last9Attn Stage 2) saved with accuracy: 0.6859
[train epoch 66] loss: 1.045, acc: 0.536: 100%|█| 366/366 [00:34<00:00, 10.59it/
[valid epoch 66] loss: 1.090, acc: 0.683: 100%|█| 91/91 [00:05<00:00, 16.46it/s]
[train epoch 67] loss: 1.069, acc: 0.523: 100%|█| 366/366 [00:34<00:00, 10.73it/
[valid epoch 67] loss: 1.090, acc: 0.688: 100%|█| 91/91 [00:05<00:00, 16.50it/s]
Best model (head+MLP+last9Attn Stage 2) saved with accuracy: 0.6880
[train epoch 68] loss: 1.048, acc: 0.530: 100%|█| 366/366 [00:35<00:00, 10.40it/
[valid epoch 68] loss: 1.089, acc: 0.687: 100%|█| 91/91 [00:05<00:00, 16.41it/s]
[train epoch 69] loss: 1.075, acc: 0.517: 100%|█| 366/366 [00:35<00:00, 10.27it/
[valid epoch 69] loss: 1.089, acc: 0.689: 100%|█| 91/91 [00:05<00:00, 16.40it/s]
Best model (head+MLP+last9Attn Stage 2) saved with accuracy: 0.6893
Stage 2 (head+MLP+last9Attn) finished. Best acc: 0.6893

=== QAT Stage 3 (4bit, head+MLP+last9Attn) ===
[train epoch 70] loss: 1.052, acc: 0.324: 100%|█| 366/366 [00:34<00:00, 10.52it/
[valid epoch 70] loss: 1.720, acc: 0.481: 100%|█| 91/91 [00:05<00:00, 16.39it/s]
Best model (head+MLP+last9Attn Stage 3) saved with accuracy: 0.4811
[train epoch 71] loss: 0.916, acc: 0.389: 100%|█| 366/366 [00:34<00:00, 10.56it/
[valid epoch 71] loss: 1.606, acc: 0.541: 100%|█| 91/91 [00:05<00:00, 16.25it/s]
Best model (head+MLP+last9Attn Stage 3) saved with accuracy: 0.5409
[train epoch 72] loss: 0.886, acc: 0.397: 100%|█| 366/366 [00:35<00:00, 10.37it/
[valid epoch 72] loss: 1.559, acc: 0.539: 100%|█| 91/91 [00:05<00:00, 16.46it/s]
[train epoch 73] loss: 0.868, acc: 0.408: 100%|█| 366/366 [00:34<00:00, 10.50it/
[valid epoch 73] loss: 1.484, acc: 0.555: 100%|█| 91/91 [00:05<00:00, 16.34it/s]
Best model (head+MLP+last9Attn Stage 3) saved with accuracy: 0.5546
[train epoch 74] loss: 0.854, acc: 0.398: 100%|█| 366/366 [00:34<00:00, 10.55it/
[valid epoch 74] loss: 1.484, acc: 0.564: 100%|█| 91/91 [00:05<00:00, 16.22it/s]
Best model (head+MLP+last9Attn Stage 3) saved with accuracy: 0.5636
[train epoch 75] loss: 0.848, acc: 0.419: 100%|█| 366/366 [00:34<00:00, 10.48it/
[valid epoch 75] loss: 1.495, acc: 0.573: 100%|█| 91/91 [00:05<00:00, 16.27it/s]
Best model (head+MLP+last9Attn Stage 3) saved with accuracy: 0.5732
[train epoch 76] loss: 0.841, acc: 0.399: 100%|█| 366/366 [00:34<00:00, 10.51it/
[valid epoch 76] loss: 1.470, acc: 0.581: 100%|█| 91/91 [00:05<00:00, 16.42it/s]
Best model (head+MLP+last9Attn Stage 3) saved with accuracy: 0.5808
[train epoch 77] loss: 0.828, acc: 0.419: 100%|█| 366/366 [00:34<00:00, 10.53it/
[valid epoch 77] loss: 1.462, acc: 0.566: 100%|█| 91/91 [00:05<00:00, 16.35it/s]
[train epoch 78] loss: 0.818, acc: 0.428: 100%|█| 366/366 [00:34<00:00, 10.55it/
[valid epoch 78] loss: 1.420, acc: 0.579: 100%|█| 91/91 [00:05<00:00, 16.39it/s]
[train epoch 79] loss: 0.795, acc: 0.421: 100%|█| 366/366 [00:34<00:00, 10.51it/
[valid epoch 79] loss: 1.488, acc: 0.559: 100%|█| 91/91 [00:05<00:00, 16.49it/s]
[train epoch 80] loss: 0.802, acc: 0.429: 100%|█| 366/366 [00:34<00:00, 10.65it/
[valid epoch 80] loss: 1.396, acc: 0.596: 100%|█| 91/91 [00:05<00:00, 16.52it/s]
Best model (head+MLP+last9Attn Stage 3) saved with accuracy: 0.5959
[train epoch 81] loss: 0.802, acc: 0.431: 100%|█| 366/366 [00:33<00:00, 10.77it/
[valid epoch 81] loss: 1.418, acc: 0.587: 100%|█| 91/91 [00:05<00:00, 16.46it/s]
[train epoch 82] loss: 0.771, acc: 0.429: 100%|█| 366/366 [00:34<00:00, 10.60it/
[valid epoch 82] loss: 1.362, acc: 0.599: 100%|█| 91/91 [00:05<00:00, 16.48it/s]
Best model (head+MLP+last9Attn Stage 3) saved with accuracy: 0.5986
[train epoch 83] loss: 0.776, acc: 0.439: 100%|█| 366/366 [00:34<00:00, 10.51it/
[valid epoch 83] loss: 1.379, acc: 0.605: 100%|█| 91/91 [00:05<00:00, 16.41it/s]
Best model (head+MLP+last9Attn Stage 3) saved with accuracy: 0.6048
[train epoch 84] loss: 0.768, acc: 0.433: 100%|█| 366/366 [00:35<00:00, 10.29it/
[valid epoch 84] loss: 1.552, acc: 0.537: 100%|█| 91/91 [00:05<00:00, 16.31it/s]
[train epoch 85] loss: 0.764, acc: 0.437: 100%|█| 366/366 [00:35<00:00, 10.38it/
[valid epoch 85] loss: 1.368, acc: 0.598: 100%|█| 91/91 [00:05<00:00, 16.41it/s]
[train epoch 86] loss: 0.756, acc: 0.429: 100%|█| 366/366 [00:35<00:00, 10.42it/
[valid epoch 86] loss: 1.438, acc: 0.560: 100%|█| 91/91 [00:05<00:00, 16.35it/s]
[train epoch 87] loss: 0.748, acc: 0.452: 100%|█| 366/366 [00:35<00:00, 10.23it/
[valid epoch 87] loss: 1.354, acc: 0.600: 100%|█| 91/91 [00:05<00:00, 16.37it/s]
[train epoch 88] loss: 0.752, acc: 0.437: 100%|█| 366/366 [00:34<00:00, 10.52it/
[valid epoch 88] loss: 1.324, acc: 0.609: 100%|█| 91/91 [00:05<00:00, 16.44it/s]
Best model (head+MLP+last9Attn Stage 3) saved with accuracy: 0.6089
[train epoch 89] loss: 0.746, acc: 0.451: 100%|█| 366/366 [00:34<00:00, 10.50it/
[valid epoch 89] loss: 1.330, acc: 0.603: 100%|█| 91/91 [00:05<00:00, 16.58it/s]
[train epoch 90] loss: 0.958, acc: 0.446: 100%|█| 366/366 [00:35<00:00, 10.38it/
[valid epoch 90] loss: 1.305, acc: 0.621: 100%|█| 91/91 [00:05<00:00, 16.40it/s]
Best model (head+MLP+last9Attn Stage 3) saved with accuracy: 0.6213
[train epoch 91] loss: 0.952, acc: 0.457: 100%|█| 366/366 [00:34<00:00, 10.52it/
[valid epoch 91] loss: 1.327, acc: 0.597: 100%|█| 91/91 [00:05<00:00, 16.41it/s]
[train epoch 92] loss: 0.951, acc: 0.451: 100%|█| 366/366 [00:34<00:00, 10.48it/
[valid epoch 92] loss: 1.328, acc: 0.601: 100%|█| 91/91 [00:05<00:00, 16.54it/s]
[train epoch 93] loss: 0.938, acc: 0.465: 100%|█| 366/366 [00:35<00:00, 10.42it/
[valid epoch 93] loss: 1.270, acc: 0.629: 100%|█| 91/91 [00:05<00:00, 16.58it/s]
Best model (head+MLP+last9Attn Stage 3) saved with accuracy: 0.6289
[train epoch 94] loss: 0.935, acc: 0.451: 100%|█| 366/366 [00:35<00:00, 10.42it/
[valid epoch 94] loss: 1.258, acc: 0.631: 100%|█| 91/91 [00:05<00:00, 16.48it/s]
Best model (head+MLP+last9Attn Stage 3) saved with accuracy: 0.6309
[train epoch 95] loss: 0.925, acc: 0.469: 100%|█| 366/366 [00:34<00:00, 10.48it/
[valid epoch 95] loss: 1.281, acc: 0.630: 100%|█| 91/91 [00:05<00:00, 16.36it/s]
[train epoch 96] loss: 0.908, acc: 0.475: 100%|█| 366/366 [00:34<00:00, 10.48it/
[valid epoch 96] loss: 1.233, acc: 0.637: 100%|█| 91/91 [00:05<00:00, 16.48it/s]
Best model (head+MLP+last9Attn Stage 3) saved with accuracy: 0.6371
[train epoch 97] loss: 0.907, acc: 0.474: 100%|█| 366/366 [00:34<00:00, 10.58it/
[valid epoch 97] loss: 1.254, acc: 0.638: 100%|█| 91/91 [00:05<00:00, 16.52it/s]
Best model (head+MLP+last9Attn Stage 3) saved with accuracy: 0.6385
[train epoch 98] loss: 0.885, acc: 0.483: 100%|█| 366/366 [00:35<00:00, 10.36it/
[valid epoch 98] loss: 1.240, acc: 0.636: 100%|█| 91/91 [00:05<00:00, 16.53it/s]
[train epoch 99] loss: 0.893, acc: 0.479: 100%|█| 366/366 [00:34<00:00, 10.57it/
[valid epoch 99] loss: 1.243, acc: 0.636: 100%|█| 91/91 [00:05<00:00, 16.39it/s]
[train epoch 100] loss: 0.898, acc: 0.467: 100%|█| 366/366 [00:34<00:00, 10.73it
[valid epoch 100] loss: 1.219, acc: 0.647: 100%|█| 91/91 [00:05<00:00, 16.45it/s
Best model (head+MLP+last9Attn Stage 3) saved with accuracy: 0.6474
[train epoch 101] loss: 0.891, acc: 0.468: 100%|█| 366/366 [00:34<00:00, 10.69it
[valid epoch 101] loss: 1.227, acc: 0.640: 100%|█| 91/91 [00:05<00:00, 16.57it/s
[train epoch 102] loss: 0.887, acc: 0.473: 100%|█| 366/366 [00:34<00:00, 10.49it
[valid epoch 102] loss: 1.228, acc: 0.647: 100%|█| 91/91 [00:05<00:00, 16.41it/s
[train epoch 103] loss: 0.879, acc: 0.481: 100%|█| 366/366 [00:34<00:00, 10.64it
[valid epoch 103] loss: 1.217, acc: 0.640: 100%|█| 91/91 [00:05<00:00, 16.50it/s
[train epoch 104] loss: 0.871, acc: 0.491: 100%|█| 366/366 [00:34<00:00, 10.53it
[valid epoch 104] loss: 1.223, acc: 0.639: 100%|█| 91/91 [00:05<00:00, 16.41it/s
[train epoch 105] loss: 0.882, acc: 0.475: 100%|█| 366/366 [00:34<00:00, 10.67it
[valid epoch 105] loss: 1.209, acc: 0.650: 100%|█| 91/91 [00:05<00:00, 16.46it/s
Best model (head+MLP+last9Attn Stage 3) saved with accuracy: 0.6502
[train epoch 106] loss: 0.875, acc: 0.482: 100%|█| 366/366 [00:34<00:00, 10.59it
[valid epoch 106] loss: 1.209, acc: 0.645: 100%|█| 91/91 [00:05<00:00, 16.44it/s
[train epoch 107] loss: 0.862, acc: 0.496: 100%|█| 366/366 [00:34<00:00, 10.51it
[valid epoch 107] loss: 1.206, acc: 0.643: 100%|█| 91/91 [00:05<00:00, 16.42it/s
[train epoch 108] loss: 0.861, acc: 0.487: 100%|█| 366/366 [00:34<00:00, 10.46it
[valid epoch 108] loss: 1.202, acc: 0.652: 100%|█| 91/91 [00:05<00:00, 16.47it/s
Best model (head+MLP+last9Attn Stage 3) saved with accuracy: 0.6522
[train epoch 109] loss: 0.867, acc: 0.488: 100%|█| 366/366 [00:35<00:00, 10.44it
[valid epoch 109] loss: 1.210, acc: 0.650: 100%|█| 91/91 [00:05<00:00, 16.49it/s
Stage 3 (head+MLP+last9Attn) finished. Best acc: 0.6522
Progressive QAT completed. Best validation accuracy: 0.6893

==== Sweep 10: head+MLP+last10Attn ====

=== QAT Stage 1 (8bit, head+MLP+last10Attn) ===
[train epoch 0] loss: 2.282, acc: 0.190: 100%|█| 366/366 [00:36<00:00, 10.16it/s
[valid epoch 0] loss: 2.211, acc: 0.307: 100%|██| 91/91 [00:05<00:00, 16.12it/s]
Best model (head+MLP+last10Attn Stage 1) saved with accuracy: 0.3065
[train epoch 1] loss: 2.126, acc: 0.253: 100%|█| 366/366 [00:35<00:00, 10.24it/s
[valid epoch 1] loss: 2.099, acc: 0.335: 100%|██| 91/91 [00:05<00:00, 16.23it/s]
Best model (head+MLP+last10Attn Stage 1) saved with accuracy: 0.3347
[train epoch 2] loss: 2.046, acc: 0.279: 100%|█| 366/366 [00:36<00:00, 10.11it/s
[valid epoch 2] loss: 1.982, acc: 0.397: 100%|██| 91/91 [00:05<00:00, 16.22it/s]
Best model (head+MLP+last10Attn Stage 1) saved with accuracy: 0.3966
[train epoch 3] loss: 2.034, acc: 0.286: 100%|█| 366/366 [00:35<00:00, 10.26it/s
[valid epoch 3] loss: 2.110, acc: 0.347: 100%|██| 91/91 [00:05<00:00, 16.25it/s]
[train epoch 4] loss: 1.984, acc: 0.313: 100%|█| 366/366 [00:35<00:00, 10.31it/s
[valid epoch 4] loss: 1.947, acc: 0.389: 100%|██| 91/91 [00:05<00:00, 16.32it/s]
[train epoch 5] loss: 1.973, acc: 0.314: 100%|█| 366/366 [00:35<00:00, 10.28it/s
[valid epoch 5] loss: 1.962, acc: 0.377: 100%|██| 91/91 [00:05<00:00, 16.20it/s]
[train epoch 6] loss: 1.968, acc: 0.316: 100%|█| 366/366 [00:35<00:00, 10.22it/s
[valid epoch 6] loss: 1.878, acc: 0.430: 100%|██| 91/91 [00:05<00:00, 16.13it/s]
Best model (head+MLP+last10Attn Stage 1) saved with accuracy: 0.4302
[train epoch 7] loss: 1.919, acc: 0.335: 100%|█| 366/366 [00:35<00:00, 10.40it/s
[valid epoch 7] loss: 1.905, acc: 0.414: 100%|██| 91/91 [00:05<00:00, 16.20it/s]
[train epoch 8] loss: 1.929, acc: 0.323: 100%|█| 366/366 [00:36<00:00, 10.13it/s
[valid epoch 8] loss: 1.819, acc: 0.440: 100%|██| 91/91 [00:05<00:00, 16.18it/s]
Best model (head+MLP+last10Attn Stage 1) saved with accuracy: 0.4399
[train epoch 9] loss: 1.899, acc: 0.335: 100%|█| 366/366 [00:35<00:00, 10.26it/s
[valid epoch 9] loss: 1.854, acc: 0.439: 100%|██| 91/91 [00:05<00:00, 16.24it/s]
[train epoch 10] loss: 1.885, acc: 0.346: 100%|█| 366/366 [00:35<00:00, 10.28it/
[valid epoch 10] loss: 1.792, acc: 0.454: 100%|█| 91/91 [00:05<00:00, 16.22it/s]
Best model (head+MLP+last10Attn Stage 1) saved with accuracy: 0.4543
[train epoch 11] loss: 1.860, acc: 0.354: 100%|█| 366/366 [00:36<00:00, 10.15it/
[valid epoch 11] loss: 1.789, acc: 0.459: 100%|█| 91/91 [00:05<00:00, 16.23it/s]
Best model (head+MLP+last10Attn Stage 1) saved with accuracy: 0.4591
[train epoch 12] loss: 1.843, acc: 0.358: 100%|█| 366/366 [00:35<00:00, 10.31it/
[valid epoch 12] loss: 1.726, acc: 0.474: 100%|█| 91/91 [00:05<00:00, 16.29it/s]
Best model (head+MLP+last10Attn Stage 1) saved with accuracy: 0.4742
[train epoch 13] loss: 1.831, acc: 0.365: 100%|█| 366/366 [00:35<00:00, 10.31it/
[valid epoch 13] loss: 1.730, acc: 0.467: 100%|█| 91/91 [00:05<00:00, 15.98it/s]
[train epoch 14] loss: 1.820, acc: 0.366: 100%|█| 366/366 [00:35<00:00, 10.22it/
[valid epoch 14] loss: 1.752, acc: 0.465: 100%|█| 91/91 [00:05<00:00, 16.31it/s]
[train epoch 15] loss: 1.812, acc: 0.375: 100%|█| 366/366 [00:35<00:00, 10.37it/
[valid epoch 15] loss: 1.680, acc: 0.476: 100%|█| 91/91 [00:05<00:00, 16.20it/s]
Best model (head+MLP+last10Attn Stage 1) saved with accuracy: 0.4763
[train epoch 16] loss: 1.767, acc: 0.393: 100%|█| 366/366 [00:37<00:00,  9.80it/
[valid epoch 16] loss: 1.640, acc: 0.496: 100%|█| 91/91 [00:05<00:00, 16.01it/s]
Best model (head+MLP+last10Attn Stage 1) saved with accuracy: 0.4955
[train epoch 17] loss: 1.790, acc: 0.381: 100%|█| 366/366 [00:35<00:00, 10.29it/
[valid epoch 17] loss: 1.663, acc: 0.504: 100%|█| 91/91 [00:05<00:00, 15.78it/s]
Best model (head+MLP+last10Attn Stage 1) saved with accuracy: 0.5045
[train epoch 18] loss: 1.788, acc: 0.385: 100%|█| 366/366 [00:35<00:00, 10.18it/
[valid epoch 18] loss: 1.605, acc: 0.498: 100%|█| 91/91 [00:05<00:00, 16.22it/s]
[train epoch 19] loss: 1.764, acc: 0.388: 100%|█| 366/366 [00:36<00:00, 10.16it/
[valid epoch 19] loss: 1.644, acc: 0.496: 100%|█| 91/91 [00:05<00:00, 16.20it/s]
[train epoch 20] loss: 1.747, acc: 0.394: 100%|█| 366/366 [00:35<00:00, 10.43it/
[valid epoch 20] loss: 1.594, acc: 0.518: 100%|█| 91/91 [00:07<00:00, 12.43it/s]
Best model (head+MLP+last10Attn Stage 1) saved with accuracy: 0.5175
[train epoch 21] loss: 1.738, acc: 0.395: 100%|█| 366/366 [00:35<00:00, 10.20it/
[valid epoch 21] loss: 1.552, acc: 0.526: 100%|█| 91/91 [00:05<00:00, 16.11it/s]
Best model (head+MLP+last10Attn Stage 1) saved with accuracy: 0.5265
[train epoch 22] loss: 1.732, acc: 0.399: 100%|█| 366/366 [00:35<00:00, 10.27it/
[valid epoch 22] loss: 1.553, acc: 0.531: 100%|█| 91/91 [00:05<00:00, 16.30it/s]
Best model (head+MLP+last10Attn Stage 1) saved with accuracy: 0.5306
[train epoch 23] loss: 1.699, acc: 0.412: 100%|█| 366/366 [00:35<00:00, 10.24it/
[valid epoch 23] loss: 1.540, acc: 0.529: 100%|█| 91/91 [00:05<00:00, 16.31it/s]
[train epoch 24] loss: 1.706, acc: 0.407: 100%|█| 366/366 [00:35<00:00, 10.31it/
[valid epoch 24] loss: 1.501, acc: 0.555: 100%|█| 91/91 [00:05<00:00, 16.30it/s]
Best model (head+MLP+last10Attn Stage 1) saved with accuracy: 0.5546
[train epoch 25] loss: 1.663, acc: 0.427: 100%|█| 366/366 [00:40<00:00,  8.95it/
[valid epoch 25] loss: 1.508, acc: 0.537: 100%|█| 91/91 [00:05<00:00, 15.95it/s]
[train epoch 26] loss: 1.676, acc: 0.416: 100%|█| 366/366 [00:35<00:00, 10.31it/
[valid epoch 26] loss: 1.494, acc: 0.548: 100%|█| 91/91 [00:05<00:00, 16.27it/s]
[train epoch 27] loss: 1.626, acc: 0.438: 100%|█| 366/366 [00:34<00:00, 10.47it/
[valid epoch 27] loss: 1.475, acc: 0.551: 100%|█| 91/91 [00:07<00:00, 11.89it/s]
[train epoch 28] loss: 1.623, acc: 0.445: 100%|█| 366/366 [00:34<00:00, 10.47it/
[valid epoch 28] loss: 1.459, acc: 0.555: 100%|█| 91/91 [00:05<00:00, 16.20it/s]
[train epoch 29] loss: 1.638, acc: 0.429: 100%|█| 366/366 [00:36<00:00, 10.03it/
[valid epoch 29] loss: 1.439, acc: 0.559: 100%|█| 91/91 [00:05<00:00, 16.11it/s]
Best model (head+MLP+last10Attn Stage 1) saved with accuracy: 0.5595
[train epoch 30] loss: 1.602, acc: 0.445: 100%|█| 366/366 [00:35<00:00, 10.37it/
[valid epoch 30] loss: 1.438, acc: 0.572: 100%|█| 91/91 [00:05<00:00, 16.18it/s]
Best model (head+MLP+last10Attn Stage 1) saved with accuracy: 0.5718
[train epoch 31] loss: 1.596, acc: 0.445: 100%|█| 366/366 [00:35<00:00, 10.21it/
[valid epoch 31] loss: 1.409, acc: 0.585: 100%|█| 91/91 [00:05<00:00, 16.17it/s]
Best model (head+MLP+last10Attn Stage 1) saved with accuracy: 0.5849
[train epoch 32] loss: 1.611, acc: 0.437: 100%|█| 366/366 [00:35<00:00, 10.22it/
[valid epoch 32] loss: 1.402, acc: 0.579: 100%|█| 91/91 [00:05<00:00, 16.12it/s]
[train epoch 33] loss: 1.576, acc: 0.455: 100%|█| 366/366 [00:35<00:00, 10.41it/
[valid epoch 33] loss: 1.377, acc: 0.582: 100%|█| 91/91 [00:05<00:00, 16.13it/s]
[train epoch 34] loss: 1.598, acc: 0.443: 100%|█| 366/366 [00:35<00:00, 10.44it/
[valid epoch 34] loss: 1.386, acc: 0.581: 100%|█| 91/91 [00:05<00:00, 16.25it/s]
[train epoch 35] loss: 1.595, acc: 0.449: 100%|█| 366/366 [00:36<00:00,  9.96it/
[valid epoch 35] loss: 1.383, acc: 0.588: 100%|█| 91/91 [00:05<00:00, 16.23it/s]
Best model (head+MLP+last10Attn Stage 1) saved with accuracy: 0.5883
[train epoch 36] loss: 1.563, acc: 0.462: 100%|█| 366/366 [00:35<00:00, 10.17it/
[valid epoch 36] loss: 1.371, acc: 0.599: 100%|█| 91/91 [00:05<00:00, 16.24it/s]
Best model (head+MLP+last10Attn Stage 1) saved with accuracy: 0.5986
[train epoch 37] loss: 1.555, acc: 0.460: 100%|█| 366/366 [00:36<00:00, 10.16it/
[valid epoch 37] loss: 1.370, acc: 0.591: 100%|█| 91/91 [00:06<00:00, 14.54it/s]
[train epoch 38] loss: 1.574, acc: 0.453: 100%|█| 366/366 [00:35<00:00, 10.24it/
[valid epoch 38] loss: 1.368, acc: 0.592: 100%|█| 91/91 [00:05<00:00, 16.27it/s]
[train epoch 39] loss: 1.595, acc: 0.451: 100%|█| 366/366 [00:37<00:00,  9.78it/
[valid epoch 39] loss: 1.370, acc: 0.588: 100%|█| 91/91 [00:05<00:00, 16.14it/s]
Stage 1 (head+MLP+last10Attn) finished. Best acc: 0.5986

=== QAT Stage 2 (6bit, head+MLP+last10Attn) ===
[train epoch 40] loss: 1.440, acc: 0.426: 100%|█| 366/366 [00:35<00:00, 10.21it/
[valid epoch 40] loss: 1.445, acc: 0.568: 100%|█| 91/91 [00:05<00:00, 16.22it/s]
Best model (head+MLP+last10Attn Stage 2) saved with accuracy: 0.5684
[train epoch 41] loss: 1.429, acc: 0.438: 100%|█| 366/366 [00:36<00:00, 10.08it/
[valid epoch 41] loss: 1.432, acc: 0.573: 100%|█| 91/91 [00:05<00:00, 16.17it/s]
Best model (head+MLP+last10Attn Stage 2) saved with accuracy: 0.5725
[train epoch 42] loss: 1.424, acc: 0.437: 100%|█| 366/366 [00:35<00:00, 10.27it/
[valid epoch 42] loss: 1.442, acc: 0.566: 100%|█| 91/91 [00:05<00:00, 16.14it/s]
[train epoch 43] loss: 1.413, acc: 0.447: 100%|█| 366/366 [00:35<00:00, 10.31it/
[valid epoch 43] loss: 1.399, acc: 0.579: 100%|█| 91/91 [00:05<00:00, 16.17it/s]
Best model (head+MLP+last10Attn Stage 2) saved with accuracy: 0.5787
[train epoch 44] loss: 1.415, acc: 0.442: 100%|█| 366/366 [00:34<00:00, 10.46it/
[valid epoch 44] loss: 1.420, acc: 0.565: 100%|█| 91/91 [00:05<00:00, 16.12it/s]
[train epoch 45] loss: 1.431, acc: 0.430: 100%|█| 366/366 [00:35<00:00, 10.27it/
[valid epoch 45] loss: 1.400, acc: 0.577: 100%|█| 91/91 [00:05<00:00, 16.09it/s]
[train epoch 46] loss: 1.423, acc: 0.439: 100%|█| 366/366 [00:35<00:00, 10.24it/
[valid epoch 46] loss: 1.432, acc: 0.575: 100%|█| 91/91 [00:05<00:00, 16.19it/s]
[train epoch 47] loss: 1.414, acc: 0.441: 100%|█| 366/366 [00:35<00:00, 10.26it/
[valid epoch 47] loss: 1.482, acc: 0.553: 100%|█| 91/91 [00:05<00:00, 16.13it/s]
[train epoch 48] loss: 1.401, acc: 0.438: 100%|█| 366/366 [00:35<00:00, 10.35it/
[valid epoch 48] loss: 1.428, acc: 0.577: 100%|█| 91/91 [00:05<00:00, 16.16it/s]
[train epoch 49] loss: 1.405, acc: 0.445: 100%|█| 366/366 [00:35<00:00, 10.29it/
[valid epoch 49] loss: 1.411, acc: 0.573: 100%|█| 91/91 [00:05<00:00, 16.24it/s]
[train epoch 50] loss: 1.406, acc: 0.440: 100%|█| 366/366 [00:35<00:00, 10.32it/
[valid epoch 50] loss: 1.402, acc: 0.575: 100%|█| 91/91 [00:05<00:00, 16.15it/s]
[train epoch 51] loss: 1.286, acc: 0.446: 100%|█| 366/366 [00:35<00:00, 10.32it/
[valid epoch 51] loss: 1.410, acc: 0.577: 100%|█| 91/91 [00:05<00:00, 16.20it/s]
[train epoch 52] loss: 1.294, acc: 0.453: 100%|█| 366/366 [00:35<00:00, 10.20it/
[valid epoch 52] loss: 1.401, acc: 0.582: 100%|█| 91/91 [00:05<00:00, 16.11it/s]
Best model (head+MLP+last10Attn Stage 2) saved with accuracy: 0.5821
[train epoch 53] loss: 1.286, acc: 0.444: 100%|█| 366/366 [00:36<00:00, 10.14it/
[valid epoch 53] loss: 1.371, acc: 0.589: 100%|█| 91/91 [00:05<00:00, 16.23it/s]
Best model (head+MLP+last10Attn Stage 2) saved with accuracy: 0.5890
[train epoch 54] loss: 1.272, acc: 0.456: 100%|█| 366/366 [00:35<00:00, 10.32it/
[valid epoch 54] loss: 1.384, acc: 0.587: 100%|█| 91/91 [00:05<00:00, 16.33it/s]
[train epoch 55] loss: 1.252, acc: 0.458: 100%|█| 366/366 [00:36<00:00, 10.14it/
[valid epoch 55] loss: 1.357, acc: 0.592: 100%|█| 91/91 [00:05<00:00, 16.13it/s]
Best model (head+MLP+last10Attn Stage 2) saved with accuracy: 0.5924
[train epoch 56] loss: 1.276, acc: 0.451: 100%|█| 366/366 [00:36<00:00, 10.06it/
[valid epoch 56] loss: 1.392, acc: 0.586: 100%|█| 91/91 [00:05<00:00, 16.10it/s]
[train epoch 57] loss: 1.252, acc: 0.464: 100%|█| 366/366 [00:35<00:00, 10.37it/
[valid epoch 57] loss: 1.366, acc: 0.593: 100%|█| 91/91 [00:05<00:00, 16.16it/s]
Best model (head+MLP+last10Attn Stage 2) saved with accuracy: 0.5931
[train epoch 58] loss: 1.249, acc: 0.461: 100%|█| 366/366 [00:35<00:00, 10.32it/
[valid epoch 58] loss: 1.372, acc: 0.586: 100%|█| 91/91 [00:05<00:00, 16.29it/s]
[train epoch 59] loss: 1.237, acc: 0.468: 100%|█| 366/366 [00:35<00:00, 10.33it/
[valid epoch 59] loss: 1.347, acc: 0.599: 100%|█| 91/91 [00:05<00:00, 16.21it/s]
Best model (head+MLP+last10Attn Stage 2) saved with accuracy: 0.5993
[train epoch 60] loss: 1.245, acc: 0.459: 100%|█| 366/366 [00:36<00:00, 10.04it/
[valid epoch 60] loss: 1.339, acc: 0.599: 100%|█| 91/91 [00:05<00:00, 16.08it/s]
[train epoch 61] loss: 1.236, acc: 0.470: 100%|█| 366/366 [00:35<00:00, 10.26it/
[valid epoch 61] loss: 1.331, acc: 0.614: 100%|█| 91/91 [00:05<00:00, 16.20it/s]
Best model (head+MLP+last10Attn Stage 2) saved with accuracy: 0.6144
[train epoch 62] loss: 1.231, acc: 0.468: 100%|█| 366/366 [00:35<00:00, 10.33it/
[valid epoch 62] loss: 1.342, acc: 0.604: 100%|█| 91/91 [00:05<00:00, 16.14it/s]
[train epoch 63] loss: 1.225, acc: 0.466: 100%|█| 366/366 [00:35<00:00, 10.31it/
[valid epoch 63] loss: 1.333, acc: 0.610: 100%|█| 91/91 [00:05<00:00, 16.15it/s]
[train epoch 64] loss: 1.211, acc: 0.478: 100%|█| 366/366 [00:35<00:00, 10.45it/
[valid epoch 64] loss: 1.319, acc: 0.608: 100%|█| 91/91 [00:05<00:00, 16.21it/s]
[train epoch 65] loss: 1.207, acc: 0.479: 100%|█| 366/366 [00:35<00:00, 10.34it/
[valid epoch 65] loss: 1.320, acc: 0.613: 100%|█| 91/91 [00:05<00:00, 16.16it/s]
[train epoch 66] loss: 1.219, acc: 0.474: 100%|█| 366/366 [00:35<00:00, 10.34it/
[valid epoch 66] loss: 1.317, acc: 0.610: 100%|█| 91/91 [00:05<00:00, 16.18it/s]
[train epoch 67] loss: 1.222, acc: 0.461: 100%|█| 366/366 [00:34<00:00, 10.51it/
[valid epoch 67] loss: 1.324, acc: 0.610: 100%|█| 91/91 [00:05<00:00, 16.16it/s]
[train epoch 68] loss: 1.218, acc: 0.474: 100%|█| 366/366 [00:35<00:00, 10.41it/
[valid epoch 68] loss: 1.318, acc: 0.612: 100%|█| 91/91 [00:05<00:00, 16.14it/s]
[train epoch 69] loss: 1.221, acc: 0.467: 100%|█| 366/366 [00:35<00:00, 10.32it/
[valid epoch 69] loss: 1.319, acc: 0.609: 100%|█| 91/91 [00:05<00:00, 16.14it/s]
Stage 2 (head+MLP+last10Attn) finished. Best acc: 0.6144

=== QAT Stage 3 (4bit, head+MLP+last10Attn) ===
[train epoch 70] loss: 1.141, acc: 0.289: 100%|█| 366/366 [00:35<00:00, 10.36it/
[valid epoch 70] loss: 1.854, acc: 0.434: 100%|█| 91/91 [00:05<00:00, 16.13it/s]
Best model (head+MLP+last10Attn Stage 3) saved with accuracy: 0.4337
[train epoch 71] loss: 1.022, acc: 0.335: 100%|█| 366/366 [00:35<00:00, 10.39it/
[valid epoch 71] loss: 1.787, acc: 0.467: 100%|█| 91/91 [00:05<00:00, 16.29it/s]
Best model (head+MLP+last10Attn Stage 3) saved with accuracy: 0.4667
[train epoch 72] loss: 0.999, acc: 0.349: 100%|█| 366/366 [00:35<00:00, 10.31it/
[valid epoch 72] loss: 1.767, acc: 0.465: 100%|█| 91/91 [00:05<00:00, 16.12it/s]
[train epoch 73] loss: 0.979, acc: 0.365: 100%|█| 366/366 [00:35<00:00, 10.33it/
[valid epoch 73] loss: 1.706, acc: 0.501: 100%|█| 91/91 [00:05<00:00, 16.23it/s]
Best model (head+MLP+last10Attn Stage 3) saved with accuracy: 0.5010
[train epoch 74] loss: 0.976, acc: 0.351: 100%|█| 366/366 [00:35<00:00, 10.41it/
[valid epoch 74] loss: 1.802, acc: 0.451: 100%|█| 91/91 [00:05<00:00, 16.29it/s]
[train epoch 75] loss: 0.957, acc: 0.374: 100%|█| 366/366 [00:35<00:00, 10.24it/
[valid epoch 75] loss: 1.702, acc: 0.471: 100%|█| 91/91 [00:05<00:00, 16.32it/s]
[train epoch 76] loss: 0.936, acc: 0.374: 100%|█| 366/366 [00:35<00:00, 10.36it/
[valid epoch 76] loss: 1.699, acc: 0.492: 100%|█| 91/91 [00:05<00:00, 16.34it/s]
[train epoch 77] loss: 0.936, acc: 0.373: 100%|█| 366/366 [00:35<00:00, 10.42it/
[valid epoch 77] loss: 1.669, acc: 0.490: 100%|█| 91/91 [00:05<00:00, 16.23it/s]
[train epoch 78] loss: 0.929, acc: 0.379: 100%|█| 366/366 [00:34<00:00, 10.46it/
[valid epoch 78] loss: 1.634, acc: 0.498: 100%|█| 91/91 [00:05<00:00, 16.23it/s]
[train epoch 79] loss: 0.932, acc: 0.371: 100%|█| 366/366 [00:35<00:00, 10.38it/
[valid epoch 79] loss: 1.657, acc: 0.498: 100%|█| 91/91 [00:05<00:00, 16.25it/s]
[train epoch 80] loss: 0.923, acc: 0.379: 100%|█| 366/366 [00:35<00:00, 10.24it/
[valid epoch 80] loss: 1.629, acc: 0.514: 100%|█| 91/91 [00:05<00:00, 16.14it/s]
Best model (head+MLP+last10Attn Stage 3) saved with accuracy: 0.5141
[train epoch 81] loss: 0.892, acc: 0.389: 100%|█| 366/366 [00:35<00:00, 10.41it/
[valid epoch 81] loss: 1.641, acc: 0.506: 100%|█| 91/91 [00:05<00:00, 16.29it/s]
[train epoch 82] loss: 0.905, acc: 0.383: 100%|█| 366/366 [00:34<00:00, 10.47it/
[valid epoch 82] loss: 1.626, acc: 0.506: 100%|█| 91/91 [00:05<00:00, 16.09it/s]
[train epoch 83] loss: 0.910, acc: 0.377: 100%|█| 366/366 [00:34<00:00, 10.48it/
[valid epoch 83] loss: 1.629, acc: 0.509: 100%|█| 91/91 [00:05<00:00, 16.32it/s]
[train epoch 84] loss: 0.896, acc: 0.398: 100%|█| 366/366 [00:35<00:00, 10.44it/
[valid epoch 84] loss: 1.611, acc: 0.513: 100%|█| 91/91 [00:05<00:00, 16.31it/s]
[train epoch 85] loss: 0.882, acc: 0.395: 100%|█| 366/366 [00:35<00:00, 10.29it/
[valid epoch 85] loss: 1.597, acc: 0.520: 100%|█| 91/91 [00:05<00:00, 16.20it/s]
Best model (head+MLP+last10Attn Stage 3) saved with accuracy: 0.5196
[train epoch 86] loss: 0.886, acc: 0.392: 100%|█| 366/366 [00:35<00:00, 10.19it/
[valid epoch 86] loss: 1.555, acc: 0.521: 100%|█| 91/91 [00:05<00:00, 16.07it/s]
Best model (head+MLP+last10Attn Stage 3) saved with accuracy: 0.5210
[train epoch 87] loss: 0.885, acc: 0.391: 100%|█| 366/366 [00:36<00:00, 10.03it/
[valid epoch 87] loss: 1.596, acc: 0.515: 100%|█| 91/91 [00:05<00:00, 16.15it/s]
[train epoch 88] loss: 0.889, acc: 0.386: 100%|█| 366/366 [00:35<00:00, 10.33it/
[valid epoch 88] loss: 1.574, acc: 0.526: 100%|█| 91/91 [00:05<00:00, 16.20it/s]
Best model (head+MLP+last10Attn Stage 3) saved with accuracy: 0.5265
[train epoch 89] loss: 0.860, acc: 0.402: 100%|█| 366/366 [00:36<00:00, 10.14it/
[valid epoch 89] loss: 1.580, acc: 0.519: 100%|█| 91/91 [00:05<00:00, 16.19it/s]
[train epoch 90] loss: 1.117, acc: 0.396: 100%|█| 366/366 [00:35<00:00, 10.30it/
[valid epoch 90] loss: 1.510, acc: 0.531: 100%|█| 91/91 [00:05<00:00, 16.27it/s]
Best model (head+MLP+last10Attn Stage 3) saved with accuracy: 0.5313
[train epoch 91] loss: 1.108, acc: 0.402: 100%|█| 366/366 [00:35<00:00, 10.23it/
[valid epoch 91] loss: 1.592, acc: 0.507: 100%|█| 91/91 [00:05<00:00, 16.26it/s]
[train epoch 92] loss: 1.093, acc: 0.403: 100%|█| 366/366 [00:35<00:00, 10.26it/
[valid epoch 92] loss: 1.563, acc: 0.524: 100%|█| 91/91 [00:05<00:00, 16.24it/s]
[train epoch 93] loss: 1.084, acc: 0.415: 100%|█| 366/366 [00:35<00:00, 10.17it/
[valid epoch 93] loss: 1.504, acc: 0.537: 100%|█| 91/91 [00:05<00:00, 16.21it/s]
Best model (head+MLP+last10Attn Stage 3) saved with accuracy: 0.5368
[train epoch 94] loss: 1.088, acc: 0.415: 100%|█| 366/366 [00:36<00:00, 10.15it/
[valid epoch 94] loss: 1.492, acc: 0.544: 100%|█| 91/91 [00:05<00:00, 16.29it/s]
Best model (head+MLP+last10Attn Stage 3) saved with accuracy: 0.5443
[train epoch 95] loss: 1.080, acc: 0.413: 100%|█| 366/366 [00:36<00:00, 10.09it/
[valid epoch 95] loss: 1.531, acc: 0.526: 100%|█| 91/91 [00:05<00:00, 16.26it/s]
[train epoch 96] loss: 1.061, acc: 0.425: 100%|█| 366/366 [00:35<00:00, 10.38it/
[valid epoch 96] loss: 1.501, acc: 0.542: 100%|█| 91/91 [00:06<00:00, 14.34it/s]
[train epoch 97] loss: 1.061, acc: 0.403: 100%|█| 366/366 [00:35<00:00, 10.32it/
[valid epoch 97] loss: 1.482, acc: 0.552: 100%|█| 91/91 [00:05<00:00, 16.22it/s]
Best model (head+MLP+last10Attn Stage 3) saved with accuracy: 0.5519
[train epoch 98] loss: 1.054, acc: 0.421: 100%|█| 366/366 [00:35<00:00, 10.28it/
[valid epoch 98] loss: 1.468, acc: 0.549: 100%|█| 91/91 [00:05<00:00, 16.33it/s]
[train epoch 99] loss: 1.055, acc: 0.423: 100%|█| 366/366 [00:35<00:00, 10.39it/
[valid epoch 99] loss: 1.475, acc: 0.550: 100%|█| 91/91 [00:05<00:00, 16.18it/s]
[train epoch 100] loss: 1.035, acc: 0.430: 100%|█| 366/366 [00:35<00:00, 10.29it
[valid epoch 100] loss: 1.471, acc: 0.546: 100%|█| 91/91 [00:05<00:00, 16.26it/s
[train epoch 101] loss: 1.049, acc: 0.424: 100%|█| 366/366 [00:34<00:00, 10.49it
[valid epoch 101] loss: 1.473, acc: 0.552: 100%|█| 91/91 [00:05<00:00, 16.17it/s
[train epoch 102] loss: 1.049, acc: 0.415: 100%|█| 366/366 [00:35<00:00, 10.36it
[valid epoch 102] loss: 1.470, acc: 0.553: 100%|█| 91/91 [00:05<00:00, 16.15it/s
Best model (head+MLP+last10Attn Stage 3) saved with accuracy: 0.5526
[train epoch 103] loss: 1.034, acc: 0.427: 100%|█| 366/366 [00:35<00:00, 10.30it
[valid epoch 103] loss: 1.455, acc: 0.552: 100%|█| 91/91 [00:05<00:00, 16.31it/s
[train epoch 104] loss: 1.014, acc: 0.436: 100%|█| 366/366 [00:37<00:00,  9.72it
[valid epoch 104] loss: 1.448, acc: 0.564: 100%|█| 91/91 [00:05<00:00, 16.16it/s
Best model (head+MLP+last10Attn Stage 3) saved with accuracy: 0.5643
[train epoch 105] loss: 1.028, acc: 0.426: 100%|█| 366/366 [00:35<00:00, 10.20it
[valid epoch 105] loss: 1.452, acc: 0.559: 100%|█| 91/91 [00:05<00:00, 16.13it/s
[train epoch 106] loss: 1.026, acc: 0.427: 100%|█| 366/366 [00:35<00:00, 10.17it
[valid epoch 106] loss: 1.442, acc: 0.566: 100%|█| 91/91 [00:05<00:00, 16.22it/s
Best model (head+MLP+last10Attn Stage 3) saved with accuracy: 0.5663
[train epoch 107] loss: 1.031, acc: 0.436: 100%|█| 366/366 [00:35<00:00, 10.44it
[valid epoch 107] loss: 1.447, acc: 0.562: 100%|█| 91/91 [00:05<00:00, 16.38it/s
[train epoch 108] loss: 1.020, acc: 0.436: 100%|█| 366/366 [00:36<00:00, 10.16it
[valid epoch 108] loss: 1.430, acc: 0.559: 100%|█| 91/91 [00:05<00:00, 16.12it/s
[train epoch 109] loss: 1.023, acc: 0.432: 100%|█| 366/366 [00:35<00:00, 10.22it
[valid epoch 109] loss: 1.438, acc: 0.561: 100%|█| 91/91 [00:05<00:00, 16.07it/s
Stage 3 (head+MLP+last10Attn) finished. Best acc: 0.5663
Progressive QAT completed. Best validation accuracy: 0.6144

==== Sweep 11: head+MLP+last11Attn ====

=== QAT Stage 1 (8bit, head+MLP+last11Attn) ===
[train epoch 0] loss: 2.304, acc: 0.177: 100%|█| 366/366 [00:36<00:00, 10.08it/s
[valid epoch 0] loss: 2.321, acc: 0.247: 100%|██| 91/91 [00:05<00:00, 16.17it/s]
Best model (head+MLP+last11Attn Stage 1) saved with accuracy: 0.2474
[train epoch 1] loss: 2.192, acc: 0.216: 100%|█| 366/366 [00:36<00:00, 10.06it/s
[valid epoch 1] loss: 2.169, acc: 0.335: 100%|██| 91/91 [00:05<00:00, 16.19it/s]
Best model (head+MLP+last11Attn Stage 1) saved with accuracy: 0.3347
[train epoch 2] loss: 2.146, acc: 0.241: 100%|█| 366/366 [00:41<00:00,  8.90it/s
[valid epoch 2] loss: 2.127, acc: 0.328: 100%|██| 91/91 [00:05<00:00, 15.75it/s]
[train epoch 3] loss: 2.110, acc: 0.261: 100%|█| 366/366 [00:36<00:00,  9.91it/s
[valid epoch 3] loss: 2.098, acc: 0.338: 100%|██| 91/91 [00:05<00:00, 15.94it/s]
Best model (head+MLP+last11Attn Stage 1) saved with accuracy: 0.3381
[train epoch 4] loss: 2.098, acc: 0.264: 100%|█| 366/366 [00:36<00:00, 10.10it/s
[valid epoch 4] loss: 2.052, acc: 0.353: 100%|██| 91/91 [00:05<00:00, 16.00it/s]
Best model (head+MLP+last11Attn Stage 1) saved with accuracy: 0.3533
[train epoch 5] loss: 2.058, acc: 0.276: 100%|█| 366/366 [00:36<00:00,  9.92it/s
[valid epoch 5] loss: 2.083, acc: 0.324: 100%|██| 91/91 [00:05<00:00, 16.01it/s]
[train epoch 6] loss: 2.022, acc: 0.287: 100%|█| 366/366 [00:37<00:00,  9.74it/s
[valid epoch 6] loss: 2.107, acc: 0.338: 100%|██| 91/91 [00:05<00:00, 15.73it/s]
[train epoch 7] loss: 2.045, acc: 0.280: 100%|█| 366/366 [00:36<00:00,  9.97it/s
[valid epoch 7] loss: 1.984, acc: 0.376: 100%|██| 91/91 [00:05<00:00, 16.11it/s]
Best model (head+MLP+last11Attn Stage 1) saved with accuracy: 0.3759
[train epoch 8] loss: 2.015, acc: 0.291: 100%|█| 366/366 [00:37<00:00,  9.65it/s
[valid epoch 8] loss: 1.946, acc: 0.397: 100%|██| 91/91 [00:05<00:00, 16.15it/s]
Best model (head+MLP+last11Attn Stage 1) saved with accuracy: 0.3973
[train epoch 9] loss: 1.989, acc: 0.306: 100%|█| 366/366 [00:36<00:00,  9.91it/s
[valid epoch 9] loss: 1.949, acc: 0.392: 100%|██| 91/91 [00:05<00:00, 16.15it/s]
[train epoch 10] loss: 1.984, acc: 0.301: 100%|█| 366/366 [00:36<00:00,  9.99it/
[valid epoch 10] loss: 1.977, acc: 0.379: 100%|█| 91/91 [00:05<00:00, 16.05it/s]
[train epoch 11] loss: 1.977, acc: 0.302: 100%|█| 366/366 [00:37<00:00,  9.84it/
[valid epoch 11] loss: 1.940, acc: 0.401: 100%|█| 91/91 [00:05<00:00, 16.17it/s]
Best model (head+MLP+last11Attn Stage 1) saved with accuracy: 0.4014
[train epoch 12] loss: 1.952, acc: 0.317: 100%|█| 366/366 [00:36<00:00,  9.89it/
[valid epoch 12] loss: 1.854, acc: 0.419: 100%|█| 91/91 [00:05<00:00, 16.04it/s]
Best model (head+MLP+last11Attn Stage 1) saved with accuracy: 0.4192
[train epoch 13] loss: 1.935, acc: 0.321: 100%|█| 366/366 [00:37<00:00,  9.70it/
[valid epoch 13] loss: 1.853, acc: 0.430: 100%|█| 91/91 [00:05<00:00, 16.07it/s]
Best model (head+MLP+last11Attn Stage 1) saved with accuracy: 0.4296
[train epoch 14] loss: 1.935, acc: 0.323: 100%|█| 366/366 [00:36<00:00, 10.15it/
[valid epoch 14] loss: 1.863, acc: 0.421: 100%|█| 91/91 [00:05<00:00, 16.17it/s]
[train epoch 15] loss: 1.926, acc: 0.330: 100%|█| 366/366 [00:36<00:00,  9.96it/
[valid epoch 15] loss: 1.812, acc: 0.450: 100%|█| 91/91 [00:05<00:00, 16.01it/s]
Best model (head+MLP+last11Attn Stage 1) saved with accuracy: 0.4502
[train epoch 16] loss: 1.910, acc: 0.326: 100%|█| 366/366 [00:36<00:00, 10.15it/
[valid epoch 16] loss: 1.876, acc: 0.420: 100%|█| 91/91 [00:05<00:00, 16.15it/s]
[train epoch 17] loss: 1.902, acc: 0.332: 100%|█| 366/366 [00:35<00:00, 10.19it/
[valid epoch 17] loss: 1.808, acc: 0.451: 100%|█| 91/91 [00:05<00:00, 16.09it/s]
Best model (head+MLP+last11Attn Stage 1) saved with accuracy: 0.4509
[train epoch 18] loss: 1.888, acc: 0.339: 100%|█| 366/366 [00:35<00:00, 10.18it/
[valid epoch 18] loss: 1.796, acc: 0.434: 100%|█| 91/91 [00:05<00:00, 16.18it/s]
[train epoch 19] loss: 1.877, acc: 0.342: 100%|█| 366/366 [00:37<00:00,  9.73it/
[valid epoch 19] loss: 1.798, acc: 0.459: 100%|█| 91/91 [00:05<00:00, 15.26it/s]
Best model (head+MLP+last11Attn Stage 1) saved with accuracy: 0.4591
[train epoch 20] loss: 1.869, acc: 0.348: 100%|█| 366/366 [00:37<00:00,  9.86it/
[valid epoch 20] loss: 1.809, acc: 0.428: 100%|█| 91/91 [00:05<00:00, 15.98it/s]
[train epoch 21] loss: 1.844, acc: 0.353: 100%|█| 366/366 [00:36<00:00,  9.91it/
[valid epoch 21] loss: 1.746, acc: 0.443: 100%|█| 91/91 [00:05<00:00, 15.96it/s]
[train epoch 22] loss: 1.823, acc: 0.354: 100%|█| 366/366 [00:37<00:00,  9.76it/
[valid epoch 22] loss: 1.697, acc: 0.476: 100%|█| 91/91 [00:05<00:00, 15.99it/s]
Best model (head+MLP+last11Attn Stage 1) saved with accuracy: 0.4756
[train epoch 23] loss: 1.826, acc: 0.358: 100%|█| 366/366 [00:37<00:00,  9.75it/
[valid epoch 23] loss: 1.762, acc: 0.455: 100%|█| 91/91 [00:05<00:00, 16.01it/s]
[train epoch 24] loss: 1.793, acc: 0.375: 100%|█| 366/366 [00:37<00:00,  9.87it/
[valid epoch 24] loss: 1.715, acc: 0.466: 100%|█| 91/91 [00:05<00:00, 15.98it/s]
[train epoch 25] loss: 1.816, acc: 0.364: 100%|█| 366/366 [00:36<00:00,  9.98it/
[valid epoch 25] loss: 1.699, acc: 0.475: 100%|█| 91/91 [00:05<00:00, 16.05it/s]
[train epoch 26] loss: 1.774, acc: 0.381: 100%|█| 366/366 [00:37<00:00,  9.65it/
[valid epoch 26] loss: 1.684, acc: 0.474: 100%|█| 91/91 [00:05<00:00, 15.98it/s]
[train epoch 27] loss: 1.769, acc: 0.383: 100%|█| 366/366 [00:37<00:00,  9.89it/
[valid epoch 27] loss: 1.617, acc: 0.498: 100%|█| 91/91 [00:05<00:00, 16.13it/s]
Best model (head+MLP+last11Attn Stage 1) saved with accuracy: 0.4976
[train epoch 28] loss: 1.761, acc: 0.383: 100%|█| 366/366 [00:37<00:00,  9.78it/
[valid epoch 28] loss: 1.632, acc: 0.496: 100%|█| 91/91 [00:05<00:00, 16.12it/s]
[train epoch 29] loss: 1.736, acc: 0.392: 100%|█| 366/366 [00:37<00:00,  9.81it/
[valid epoch 29] loss: 1.598, acc: 0.518: 100%|█| 91/91 [00:05<00:00, 16.09it/s]
Best model (head+MLP+last11Attn Stage 1) saved with accuracy: 0.5175
[train epoch 30] loss: 1.720, acc: 0.401: 100%|█| 366/366 [00:36<00:00,  9.98it/
[valid epoch 30] loss: 1.624, acc: 0.495: 100%|█| 91/91 [00:05<00:00, 16.48it/s]
[train epoch 31] loss: 1.730, acc: 0.399: 100%|█| 366/366 [00:37<00:00,  9.77it/
[valid epoch 31] loss: 1.588, acc: 0.500: 100%|█| 91/91 [00:05<00:00, 16.44it/s]
[train epoch 32] loss: 1.715, acc: 0.406: 100%|█| 366/366 [00:37<00:00,  9.88it/
[valid epoch 32] loss: 1.557, acc: 0.531: 100%|█| 91/91 [00:05<00:00, 16.41it/s]
Best model (head+MLP+last11Attn Stage 1) saved with accuracy: 0.5313
[train epoch 33] loss: 1.720, acc: 0.401: 100%|█| 366/366 [00:37<00:00,  9.84it/
[valid epoch 33] loss: 1.562, acc: 0.525: 100%|█| 91/91 [00:05<00:00, 16.38it/s]
[train epoch 34] loss: 1.716, acc: 0.402: 100%|█| 366/366 [00:37<00:00,  9.87it/
[valid epoch 34] loss: 1.559, acc: 0.515: 100%|█| 91/91 [00:05<00:00, 16.34it/s]
[train epoch 35] loss: 1.691, acc: 0.408: 100%|█| 366/366 [00:37<00:00,  9.84it/
[valid epoch 35] loss: 1.544, acc: 0.524: 100%|█| 91/91 [00:05<00:00, 16.41it/s]
[train epoch 36] loss: 1.689, acc: 0.402: 100%|█| 366/366 [00:37<00:00,  9.80it/
[valid epoch 36] loss: 1.546, acc: 0.524: 100%|█| 91/91 [00:05<00:00, 16.37it/s]
[train epoch 37] loss: 1.687, acc: 0.405: 100%|█| 366/366 [00:37<00:00,  9.67it/
[valid epoch 37] loss: 1.538, acc: 0.521: 100%|█| 91/91 [00:05<00:00, 16.39it/s]
[train epoch 38] loss: 1.660, acc: 0.422: 100%|█| 366/366 [00:37<00:00,  9.86it/
[valid epoch 38] loss: 1.535, acc: 0.520: 100%|█| 91/91 [00:05<00:00, 16.26it/s]
[train epoch 39] loss: 1.690, acc: 0.405: 100%|█| 366/366 [00:36<00:00,  9.95it/
[valid epoch 39] loss: 1.538, acc: 0.520: 100%|█| 91/91 [00:05<00:00, 16.40it/s]
Stage 1 (head+MLP+last11Attn) finished. Best acc: 0.5313

=== QAT Stage 2 (6bit, head+MLP+last11Attn) ===
[train epoch 40] loss: 1.551, acc: 0.393: 100%|█| 366/366 [00:36<00:00,  9.93it/
[valid epoch 40] loss: 1.639, acc: 0.501: 100%|█| 91/91 [00:05<00:00, 16.35it/s]
Best model (head+MLP+last11Attn Stage 2) saved with accuracy: 0.5010
[train epoch 41] loss: 1.553, acc: 0.394: 100%|█| 366/366 [00:36<00:00,  9.97it/
[valid epoch 41] loss: 1.661, acc: 0.494: 100%|█| 91/91 [00:05<00:00, 16.33it/s]
[train epoch 42] loss: 1.537, acc: 0.384: 100%|█| 366/366 [00:37<00:00,  9.85it/
[valid epoch 42] loss: 1.614, acc: 0.507: 100%|█| 91/91 [00:05<00:00, 16.26it/s]
Best model (head+MLP+last11Attn Stage 2) saved with accuracy: 0.5072
[train epoch 43] loss: 1.533, acc: 0.394: 100%|█| 366/366 [00:37<00:00,  9.77it/
[valid epoch 43] loss: 1.627, acc: 0.496: 100%|█| 91/91 [00:05<00:00, 16.32it/s]
[train epoch 44] loss: 1.523, acc: 0.404: 100%|█| 366/366 [00:37<00:00,  9.73it/
[valid epoch 44] loss: 1.667, acc: 0.496: 100%|█| 91/91 [00:05<00:00, 16.30it/s]
[train epoch 45] loss: 1.535, acc: 0.388: 100%|█| 366/366 [00:37<00:00,  9.81it/
[valid epoch 45] loss: 1.590, acc: 0.511: 100%|█| 91/91 [00:05<00:00, 16.28it/s]
Best model (head+MLP+last11Attn Stage 2) saved with accuracy: 0.5113
[train epoch 46] loss: 1.531, acc: 0.392: 100%|█| 366/366 [00:38<00:00,  9.51it/
[valid epoch 46] loss: 1.583, acc: 0.515: 100%|█| 91/91 [00:05<00:00, 16.33it/s]
Best model (head+MLP+last11Attn Stage 2) saved with accuracy: 0.5148
[train epoch 47] loss: 1.536, acc: 0.391: 100%|█| 366/366 [00:37<00:00,  9.75it/
[valid epoch 47] loss: 1.569, acc: 0.517: 100%|█| 91/91 [00:05<00:00, 16.06it/s]
Best model (head+MLP+last11Attn Stage 2) saved with accuracy: 0.5168
[train epoch 48] loss: 1.516, acc: 0.399: 100%|█| 366/366 [00:37<00:00,  9.80it/
[valid epoch 48] loss: 1.585, acc: 0.510: 100%|█| 91/91 [00:05<00:00, 16.06it/s]
[train epoch 49] loss: 1.499, acc: 0.408: 100%|█| 366/366 [00:37<00:00,  9.86it/
[valid epoch 49] loss: 1.546, acc: 0.520: 100%|█| 91/91 [00:05<00:00, 16.24it/s]
Best model (head+MLP+last11Attn Stage 2) saved with accuracy: 0.5196
[train epoch 50] loss: 1.502, acc: 0.405: 100%|█| 366/366 [00:37<00:00,  9.68it/
[valid epoch 50] loss: 1.562, acc: 0.513: 100%|█| 91/91 [00:05<00:00, 16.29it/s]
[train epoch 51] loss: 1.393, acc: 0.405: 100%|█| 366/366 [00:37<00:00,  9.81it/
[valid epoch 51] loss: 1.574, acc: 0.517: 100%|█| 91/91 [00:05<00:00, 16.21it/s]
[train epoch 52] loss: 1.399, acc: 0.410: 100%|█| 366/366 [00:37<00:00,  9.79it/
[valid epoch 52] loss: 1.564, acc: 0.517: 100%|█| 91/91 [00:05<00:00, 16.26it/s]
[train epoch 53] loss: 1.389, acc: 0.407: 100%|█| 366/366 [00:37<00:00,  9.69it/
[valid epoch 53] loss: 1.585, acc: 0.512: 100%|█| 91/91 [00:05<00:00, 16.31it/s]
[train epoch 54] loss: 1.370, acc: 0.422: 100%|█| 366/366 [00:37<00:00,  9.88it/
[valid epoch 54] loss: 1.518, acc: 0.541: 100%|█| 91/91 [00:05<00:00, 16.29it/s]
Best model (head+MLP+last11Attn Stage 2) saved with accuracy: 0.5409
[train epoch 55] loss: 1.352, acc: 0.423: 100%|█| 366/366 [00:36<00:00,  9.91it/
[valid epoch 55] loss: 1.524, acc: 0.533: 100%|█| 91/91 [00:05<00:00, 16.28it/s]
[train epoch 56] loss: 1.359, acc: 0.420: 100%|█| 366/366 [00:37<00:00,  9.85it/
[valid epoch 56] loss: 1.521, acc: 0.532: 100%|█| 91/91 [00:05<00:00, 16.20it/s]
[train epoch 57] loss: 1.366, acc: 0.423: 100%|█| 366/366 [00:37<00:00,  9.82it/
[valid epoch 57] loss: 1.543, acc: 0.537: 100%|█| 91/91 [00:05<00:00, 16.33it/s]
[train epoch 58] loss: 1.363, acc: 0.412: 100%|█| 366/366 [00:37<00:00,  9.87it/
[valid epoch 58] loss: 1.518, acc: 0.539: 100%|█| 91/91 [00:05<00:00, 16.22it/s]
[train epoch 59] loss: 1.360, acc: 0.419: 100%|█| 366/366 [00:37<00:00,  9.74it/
[valid epoch 59] loss: 1.520, acc: 0.530: 100%|█| 91/91 [00:05<00:00, 16.31it/s]
[train epoch 60] loss: 1.346, acc: 0.419: 100%|█| 366/366 [00:37<00:00,  9.85it/
[valid epoch 60] loss: 1.504, acc: 0.546: 100%|█| 91/91 [00:05<00:00, 16.31it/s]
Best model (head+MLP+last11Attn Stage 2) saved with accuracy: 0.5464
[train epoch 61] loss: 1.349, acc: 0.428: 100%|█| 366/366 [00:36<00:00,  9.97it/
[valid epoch 61] loss: 1.514, acc: 0.537: 100%|█| 91/91 [00:05<00:00, 16.30it/s]
[train epoch 62] loss: 1.327, acc: 0.429: 100%|█| 366/366 [00:37<00:00,  9.88it/
[valid epoch 62] loss: 1.498, acc: 0.544: 100%|█| 91/91 [00:05<00:00, 16.35it/s]
[train epoch 63] loss: 1.331, acc: 0.431: 100%|█| 366/366 [00:37<00:00,  9.64it/
[valid epoch 63] loss: 1.508, acc: 0.539: 100%|█| 91/91 [00:05<00:00, 16.19it/s]
[train epoch 64] loss: 1.339, acc: 0.411: 100%|█| 366/366 [00:38<00:00,  9.60it/
[valid epoch 64] loss: 1.494, acc: 0.536: 100%|█| 91/91 [00:05<00:00, 16.24it/s]
[train epoch 65] loss: 1.333, acc: 0.420: 100%|█| 366/366 [00:37<00:00,  9.75it/
[valid epoch 65] loss: 1.482, acc: 0.542: 100%|█| 91/91 [00:05<00:00, 16.31it/s]
[train epoch 66] loss: 1.325, acc: 0.425: 100%|█| 366/366 [00:37<00:00,  9.78it/
[valid epoch 66] loss: 1.491, acc: 0.546: 100%|█| 91/91 [00:05<00:00, 16.12it/s]
[train epoch 67] loss: 1.315, acc: 0.425: 100%|█| 366/366 [00:38<00:00,  9.55it/
[valid epoch 67] loss: 1.487, acc: 0.538: 100%|█| 91/91 [00:05<00:00, 16.05it/s]
[train epoch 68] loss: 1.327, acc: 0.429: 100%|█| 366/366 [00:38<00:00,  9.60it/
[valid epoch 68] loss: 1.486, acc: 0.538: 100%|█| 91/91 [00:05<00:00, 16.35it/s]
[train epoch 69] loss: 1.321, acc: 0.425: 100%|█| 366/366 [00:37<00:00,  9.85it/
[valid epoch 69] loss: 1.487, acc: 0.538: 100%|█| 91/91 [00:05<00:00, 16.29it/s]
Stage 2 (head+MLP+last11Attn) finished. Best acc: 0.5464

=== QAT Stage 3 (4bit, head+MLP+last11Attn) ===
[train epoch 70] loss: 1.220, acc: 0.247: 100%|█| 366/366 [00:37<00:00,  9.89it/
[valid epoch 70] loss: 2.050, acc: 0.354: 100%|█| 91/91 [00:05<00:00, 16.26it/s]
Best model (head+MLP+last11Attn Stage 3) saved with accuracy: 0.3540
[train epoch 71] loss: 1.111, acc: 0.291: 100%|█| 366/366 [00:37<00:00,  9.77it/
[valid epoch 71] loss: 2.011, acc: 0.400: 100%|█| 91/91 [00:05<00:00, 16.25it/s]
Best model (head+MLP+last11Attn Stage 3) saved with accuracy: 0.4000
[train epoch 72] loss: 1.079, acc: 0.305: 100%|█| 366/366 [00:36<00:00, 10.04it/
[valid epoch 72] loss: 1.923, acc: 0.395: 100%|█| 91/91 [00:05<00:00, 16.31it/s]
[train epoch 73] loss: 1.083, acc: 0.311: 100%|█| 366/366 [00:38<00:00,  9.45it/
[valid epoch 73] loss: 1.903, acc: 0.427: 100%|█| 91/91 [00:05<00:00, 16.10it/s]
Best model (head+MLP+last11Attn Stage 3) saved with accuracy: 0.4268
[train epoch 74] loss: 1.056, acc: 0.320: 100%|█| 366/366 [00:38<00:00,  9.62it/
[valid epoch 74] loss: 1.956, acc: 0.397: 100%|█| 91/91 [00:05<00:00, 16.00it/s]
[train epoch 75] loss: 1.044, acc: 0.324: 100%|█| 366/366 [00:36<00:00,  9.95it/
[valid epoch 75] loss: 1.867, acc: 0.432: 100%|█| 91/91 [00:05<00:00, 16.29it/s]
Best model (head+MLP+last11Attn Stage 3) saved with accuracy: 0.4316
[train epoch 76] loss: 1.026, acc: 0.330: 100%|█| 366/366 [00:37<00:00,  9.79it/
[valid epoch 76] loss: 1.910, acc: 0.420: 100%|█| 91/91 [00:05<00:00, 16.22it/s]
[train epoch 77] loss: 1.038, acc: 0.338: 100%|█| 366/366 [00:38<00:00,  9.58it/
[valid epoch 77] loss: 1.876, acc: 0.410: 100%|█| 91/91 [00:05<00:00, 16.03it/s]
[train epoch 78] loss: 1.002, acc: 0.338: 100%|█| 366/366 [00:37<00:00,  9.77it/
[valid epoch 78] loss: 1.863, acc: 0.439: 100%|█| 91/91 [00:05<00:00, 16.20it/s]
Best model (head+MLP+last11Attn Stage 3) saved with accuracy: 0.4392
[train epoch 79] loss: 1.006, acc: 0.339: 100%|█| 366/366 [00:37<00:00,  9.74it/
[valid epoch 79] loss: 1.833, acc: 0.442: 100%|█| 91/91 [00:05<00:00, 16.28it/s]
Best model (head+MLP+last11Attn Stage 3) saved with accuracy: 0.4419
[train epoch 80] loss: 0.996, acc: 0.347: 100%|█| 366/366 [00:37<00:00,  9.72it/
[valid epoch 80] loss: 1.815, acc: 0.438: 100%|█| 91/91 [00:05<00:00, 16.36it/s]
[train epoch 81] loss: 0.998, acc: 0.347: 100%|█| 366/366 [00:37<00:00,  9.75it/
[valid epoch 81] loss: 1.844, acc: 0.441: 100%|█| 91/91 [00:05<00:00, 16.29it/s]
[train epoch 82] loss: 0.975, acc: 0.348: 100%|█| 366/366 [00:36<00:00, 10.00it/
[valid epoch 82] loss: 1.843, acc: 0.452: 100%|█| 91/91 [00:09<00:00,  9.19it/s]
Best model (head+MLP+last11Attn Stage 3) saved with accuracy: 0.4515
[train epoch 83] loss: 0.975, acc: 0.358: 100%|█| 366/366 [00:37<00:00,  9.71it/
[valid epoch 83] loss: 1.751, acc: 0.463: 100%|█| 91/91 [00:05<00:00, 16.27it/s]
Best model (head+MLP+last11Attn Stage 3) saved with accuracy: 0.4632
[train epoch 84] loss: 0.986, acc: 0.354: 100%|█| 366/366 [00:37<00:00,  9.84it/
[valid epoch 84] loss: 1.744, acc: 0.464: 100%|█| 91/91 [00:05<00:00, 16.24it/s]
Best model (head+MLP+last11Attn Stage 3) saved with accuracy: 0.4639
[train epoch 85] loss: 0.985, acc: 0.341: 100%|█| 366/366 [00:36<00:00,  9.93it/
[valid epoch 85] loss: 1.789, acc: 0.447: 100%|█| 91/91 [00:05<00:00, 16.33it/s]
[train epoch 86] loss: 0.956, acc: 0.358: 100%|█| 366/366 [00:36<00:00, 10.08it/
[valid epoch 86] loss: 1.762, acc: 0.474: 100%|█| 91/91 [00:06<00:00, 13.02it/s]
Best model (head+MLP+last11Attn Stage 3) saved with accuracy: 0.4735
[train epoch 87] loss: 0.972, acc: 0.350: 100%|█| 366/366 [00:37<00:00,  9.70it/
[valid epoch 87] loss: 1.734, acc: 0.480: 100%|█| 91/91 [00:05<00:00, 16.12it/s]
Best model (head+MLP+last11Attn Stage 3) saved with accuracy: 0.4804
[train epoch 88] loss: 0.947, acc: 0.359: 100%|█| 366/366 [00:38<00:00,  9.52it/
[valid epoch 88] loss: 1.732, acc: 0.472: 100%|█| 91/91 [00:05<00:00, 16.15it/s]
[train epoch 89] loss: 0.947, acc: 0.356: 100%|█| 366/366 [00:36<00:00,  9.92it/
[valid epoch 89] loss: 1.749, acc: 0.469: 100%|█| 91/91 [00:05<00:00, 16.16it/s]
[train epoch 90] loss: 1.221, acc: 0.361: 100%|█| 366/366 [00:37<00:00,  9.81it/
[valid epoch 90] loss: 1.691, acc: 0.480: 100%|█| 91/91 [00:05<00:00, 16.27it/s]
[train epoch 91] loss: 1.193, acc: 0.368: 100%|█| 366/366 [00:37<00:00,  9.77it/
[valid epoch 91] loss: 1.834, acc: 0.454: 100%|█| 91/91 [00:05<00:00, 16.18it/s]
[train epoch 92] loss: 1.184, acc: 0.368: 100%|█| 366/366 [00:37<00:00,  9.70it/
[valid epoch 92] loss: 1.696, acc: 0.485: 100%|█| 91/91 [00:05<00:00, 16.30it/s]
Best model (head+MLP+last11Attn Stage 3) saved with accuracy: 0.4845
[train epoch 93] loss: 1.187, acc: 0.372: 100%|█| 366/366 [00:37<00:00,  9.72it/
[valid epoch 93] loss: 1.665, acc: 0.493: 100%|█| 91/91 [00:05<00:00, 16.29it/s]
Best model (head+MLP+last11Attn Stage 3) saved with accuracy: 0.4935
[train epoch 94] loss: 1.171, acc: 0.372: 100%|█| 366/366 [00:36<00:00,  9.98it/
[valid epoch 94] loss: 1.682, acc: 0.489: 100%|█| 91/91 [00:05<00:00, 16.31it/s]
[train epoch 95] loss: 1.170, acc: 0.370: 100%|█| 366/366 [00:38<00:00,  9.53it/
[valid epoch 95] loss: 1.713, acc: 0.485: 100%|█| 91/91 [00:05<00:00, 16.06it/s]
[train epoch 96] loss: 1.158, acc: 0.383: 100%|█| 366/366 [00:39<00:00,  9.30it/
[valid epoch 96] loss: 1.642, acc: 0.499: 100%|█| 91/91 [00:05<00:00, 15.86it/s]
Best model (head+MLP+last11Attn Stage 3) saved with accuracy: 0.4990
[train epoch 97] loss: 1.157, acc: 0.384: 100%|█| 366/366 [00:39<00:00,  9.27it/
[valid epoch 97] loss: 1.651, acc: 0.491: 100%|█| 91/91 [00:06<00:00, 15.17it/s]
[train epoch 98] loss: 1.136, acc: 0.380: 100%|█| 366/366 [00:37<00:00,  9.82it/
[valid epoch 98] loss: 1.640, acc: 0.498: 100%|█| 91/91 [00:05<00:00, 16.21it/s]
[train epoch 99] loss: 1.138, acc: 0.388: 100%|█| 366/366 [00:37<00:00,  9.75it/
[valid epoch 99] loss: 1.637, acc: 0.490: 100%|█| 91/91 [00:05<00:00, 16.23it/s]
[train epoch 100] loss: 1.158, acc: 0.378: 100%|█| 366/366 [00:37<00:00,  9.65it
[valid epoch 100] loss: 1.638, acc: 0.493: 100%|█| 91/91 [00:05<00:00, 16.36it/s
[train epoch 101] loss: 1.125, acc: 0.391: 100%|█| 366/366 [00:37<00:00,  9.65it
[valid epoch 101] loss: 1.623, acc: 0.501: 100%|█| 91/91 [00:05<00:00, 16.07it/s
Best model (head+MLP+last11Attn Stage 3) saved with accuracy: 0.5010
[train epoch 102] loss: 1.136, acc: 0.388: 100%|█| 366/366 [00:36<00:00,  9.92it
[valid epoch 102] loss: 1.613, acc: 0.505: 100%|█| 91/91 [00:05<00:00, 16.42it/s
Best model (head+MLP+last11Attn Stage 3) saved with accuracy: 0.5052
[train epoch 103] loss: 1.134, acc: 0.387: 100%|█| 366/366 [00:37<00:00,  9.78it
[valid epoch 103] loss: 1.626, acc: 0.500: 100%|█| 91/91 [00:05<00:00, 16.39it/s
[train epoch 104] loss: 1.134, acc: 0.387: 100%|█| 366/366 [00:38<00:00,  9.55it
[valid epoch 104] loss: 1.610, acc: 0.504: 100%|█| 91/91 [00:05<00:00, 16.27it/s
[train epoch 105] loss: 1.110, acc: 0.392: 100%|█| 366/366 [00:37<00:00,  9.81it
[valid epoch 105] loss: 1.595, acc: 0.509: 100%|█| 91/91 [00:05<00:00, 16.45it/s
Best model (head+MLP+last11Attn Stage 3) saved with accuracy: 0.5086
[train epoch 106] loss: 1.129, acc: 0.394: 100%|█| 366/366 [00:37<00:00,  9.76it
[valid epoch 106] loss: 1.602, acc: 0.508: 100%|█| 91/91 [00:05<00:00, 16.40it/s
[train epoch 107] loss: 1.117, acc: 0.390: 100%|█| 366/366 [00:37<00:00,  9.75it
[valid epoch 107] loss: 1.606, acc: 0.506: 100%|█| 91/91 [00:05<00:00, 16.39it/s
[train epoch 108] loss: 1.127, acc: 0.394: 100%|█| 366/366 [00:36<00:00, 10.02it
[valid epoch 108] loss: 1.608, acc: 0.509: 100%|█| 91/91 [00:05<00:00, 16.38it/s
Best model (head+MLP+last11Attn Stage 3) saved with accuracy: 0.5093
[train epoch 109] loss: 1.117, acc: 0.390: 100%|█| 366/366 [00:37<00:00,  9.80it
[valid epoch 109] loss: 1.608, acc: 0.509: 100%|█| 91/91 [00:05<00:00, 16.33it/s
Stage 3 (head+MLP+last11Attn) finished. Best acc: 0.5093
Progressive QAT completed. Best validation accuracy: 0.5464

==== Sweep 12: head+MLP+allAttn ====

=== QAT Stage 1 (8bit, head+MLP+allAttn) ===
[train epoch 0] loss: 2.149, acc: 0.244: 100%|█| 366/366 [00:38<00:00,  9.61it/s
[valid epoch 0] loss: 2.160, acc: 0.322: 100%|██| 91/91 [00:05<00:00, 16.06it/s]
Best model (head+MLP+allAttn Stage 1) saved with accuracy: 0.3216
[train epoch 1] loss: 2.067, acc: 0.273: 100%|█| 366/366 [00:38<00:00,  9.54it/s
[valid epoch 1] loss: 2.190, acc: 0.285: 100%|██| 91/91 [00:05<00:00, 16.25it/s]
[train epoch 2] loss: 2.084, acc: 0.266: 100%|█| 366/366 [00:38<00:00,  9.55it/s
[valid epoch 2] loss: 2.103, acc: 0.335: 100%|██| 91/91 [00:05<00:00, 16.19it/s]
Best model (head+MLP+allAttn Stage 1) saved with accuracy: 0.3347
[train epoch 3] loss: 2.042, acc: 0.284: 100%|█| 366/366 [00:38<00:00,  9.48it/s
[valid epoch 3] loss: 2.006, acc: 0.388: 100%|██| 91/91 [00:05<00:00, 16.26it/s]
Best model (head+MLP+allAttn Stage 1) saved with accuracy: 0.3883
[train epoch 4] loss: 2.016, acc: 0.298: 100%|█| 366/366 [00:38<00:00,  9.47it/s
[valid epoch 4] loss: 1.969, acc: 0.391: 100%|██| 91/91 [00:05<00:00, 16.10it/s]
Best model (head+MLP+allAttn Stage 1) saved with accuracy: 0.3911
[train epoch 5] loss: 2.008, acc: 0.299: 100%|█| 366/366 [00:38<00:00,  9.39it/s
[valid epoch 5] loss: 1.984, acc: 0.373: 100%|██| 91/91 [00:05<00:00, 16.23it/s]
[train epoch 6] loss: 2.026, acc: 0.292: 100%|█| 366/366 [00:38<00:00,  9.40it/s
[valid epoch 6] loss: 1.995, acc: 0.383: 100%|██| 91/91 [00:05<00:00, 16.22it/s]
[train epoch 7] loss: 2.009, acc: 0.294: 100%|█| 366/366 [00:38<00:00,  9.39it/s
[valid epoch 7] loss: 1.914, acc: 0.403: 100%|██| 91/91 [00:05<00:00, 16.17it/s]
Best model (head+MLP+allAttn Stage 1) saved with accuracy: 0.4034
[train epoch 8] loss: 1.993, acc: 0.298: 100%|█| 366/366 [00:38<00:00,  9.60it/s
[valid epoch 8] loss: 1.990, acc: 0.386: 100%|██| 91/91 [00:05<00:00, 16.23it/s]
[train epoch 9] loss: 1.988, acc: 0.304: 100%|█| 366/366 [00:38<00:00,  9.39it/s
[valid epoch 9] loss: 1.982, acc: 0.376: 100%|██| 91/91 [00:05<00:00, 16.11it/s]
[train epoch 10] loss: 1.972, acc: 0.310: 100%|█| 366/366 [00:38<00:00,  9.44it/
[valid epoch 10] loss: 1.976, acc: 0.386: 100%|█| 91/91 [00:05<00:00, 15.95it/s]
[train epoch 11] loss: 1.951, acc: 0.324: 100%|█| 366/366 [00:39<00:00,  9.16it/
[valid epoch 11] loss: 1.897, acc: 0.414: 100%|█| 91/91 [00:05<00:00, 16.16it/s]
Best model (head+MLP+allAttn Stage 1) saved with accuracy: 0.4144
[train epoch 12] loss: 1.933, acc: 0.320: 100%|█| 366/366 [00:38<00:00,  9.42it/
[valid epoch 12] loss: 1.827, acc: 0.415: 100%|█| 91/91 [00:05<00:00, 16.19it/s]
Best model (head+MLP+allAttn Stage 1) saved with accuracy: 0.4151
[train epoch 13] loss: 1.942, acc: 0.320: 100%|█| 366/366 [00:38<00:00,  9.60it/
[valid epoch 13] loss: 1.866, acc: 0.416: 100%|█| 91/91 [00:05<00:00, 16.19it/s]
Best model (head+MLP+allAttn Stage 1) saved with accuracy: 0.4158
[train epoch 14] loss: 1.904, acc: 0.333: 100%|█| 366/366 [00:38<00:00,  9.49it/
[valid epoch 14] loss: 1.866, acc: 0.434: 100%|█| 91/91 [00:05<00:00, 15.94it/s]
Best model (head+MLP+allAttn Stage 1) saved with accuracy: 0.4337
[train epoch 15] loss: 1.918, acc: 0.330: 100%|█| 366/366 [00:38<00:00,  9.46it/
[valid epoch 15] loss: 1.855, acc: 0.431: 100%|█| 91/91 [00:05<00:00, 16.15it/s]
[train epoch 16] loss: 1.890, acc: 0.345: 100%|█| 366/366 [00:38<00:00,  9.59it/
[valid epoch 16] loss: 1.809, acc: 0.438: 100%|█| 91/91 [00:05<00:00, 16.16it/s]
Best model (head+MLP+allAttn Stage 1) saved with accuracy: 0.4385
[train epoch 17] loss: 1.882, acc: 0.342: 100%|█| 366/366 [00:38<00:00,  9.50it/
[valid epoch 17] loss: 1.759, acc: 0.453: 100%|█| 91/91 [00:05<00:00, 16.25it/s]
Best model (head+MLP+allAttn Stage 1) saved with accuracy: 0.4529
[train epoch 18] loss: 1.874, acc: 0.343: 100%|█| 366/366 [00:38<00:00,  9.44it/
[valid epoch 18] loss: 1.780, acc: 0.451: 100%|█| 91/91 [00:05<00:00, 16.20it/s]
[train epoch 19] loss: 1.869, acc: 0.343: 100%|█| 366/366 [00:38<00:00,  9.58it/
[valid epoch 19] loss: 1.755, acc: 0.455: 100%|█| 91/91 [00:05<00:00, 16.22it/s]
Best model (head+MLP+allAttn Stage 1) saved with accuracy: 0.4550
[train epoch 20] loss: 1.848, acc: 0.350: 100%|█| 366/366 [00:38<00:00,  9.61it/
[valid epoch 20] loss: 1.773, acc: 0.442: 100%|█| 91/91 [00:05<00:00, 16.20it/s]
[train epoch 21] loss: 1.832, acc: 0.350: 100%|█| 366/366 [00:38<00:00,  9.46it/
[valid epoch 21] loss: 1.796, acc: 0.436: 100%|█| 91/91 [00:05<00:00, 16.21it/s]
[train epoch 22] loss: 1.815, acc: 0.370: 100%|█| 366/366 [00:38<00:00,  9.56it/
[valid epoch 22] loss: 1.738, acc: 0.458: 100%|█| 91/91 [00:05<00:00, 16.15it/s]
Best model (head+MLP+allAttn Stage 1) saved with accuracy: 0.4584
[train epoch 23] loss: 1.798, acc: 0.376: 100%|█| 366/366 [00:37<00:00,  9.65it/
[valid epoch 23] loss: 1.691, acc: 0.486: 100%|█| 91/91 [00:05<00:00, 16.30it/s]
Best model (head+MLP+allAttn Stage 1) saved with accuracy: 0.4859
[train epoch 24] loss: 1.801, acc: 0.369: 100%|█| 366/366 [00:38<00:00,  9.45it/
[valid epoch 24] loss: 1.707, acc: 0.478: 100%|█| 91/91 [00:05<00:00, 16.19it/s]
[train epoch 25] loss: 1.799, acc: 0.369: 100%|█| 366/366 [00:38<00:00,  9.61it/
[valid epoch 25] loss: 1.666, acc: 0.488: 100%|█| 91/91 [00:05<00:00, 16.07it/s]
Best model (head+MLP+allAttn Stage 1) saved with accuracy: 0.4880
[train epoch 26] loss: 1.755, acc: 0.392: 100%|█| 366/366 [00:38<00:00,  9.46it/
[valid epoch 26] loss: 1.645, acc: 0.488: 100%|█| 91/91 [00:05<00:00, 16.10it/s]
[train epoch 27] loss: 1.743, acc: 0.391: 100%|█| 366/366 [00:38<00:00,  9.62it/
[valid epoch 27] loss: 1.665, acc: 0.494: 100%|█| 91/91 [00:05<00:00, 16.26it/s]
Best model (head+MLP+allAttn Stage 1) saved with accuracy: 0.4942
[train epoch 28] loss: 1.736, acc: 0.393: 100%|█| 366/366 [00:38<00:00,  9.58it/
[valid epoch 28] loss: 1.641, acc: 0.503: 100%|█| 91/91 [00:05<00:00, 16.19it/s]
Best model (head+MLP+allAttn Stage 1) saved with accuracy: 0.5031
[train epoch 29] loss: 1.739, acc: 0.392: 100%|█| 366/366 [00:38<00:00,  9.57it/
[valid epoch 29] loss: 1.638, acc: 0.490: 100%|█| 91/91 [00:05<00:00, 16.16it/s]
[train epoch 30] loss: 1.722, acc: 0.393: 100%|█| 366/366 [00:38<00:00,  9.50it/
[valid epoch 30] loss: 1.622, acc: 0.491: 100%|█| 91/91 [00:05<00:00, 16.12it/s]
[train epoch 31] loss: 1.704, acc: 0.408: 100%|█| 366/366 [00:38<00:00,  9.56it/
[valid epoch 31] loss: 1.616, acc: 0.493: 100%|█| 91/91 [00:05<00:00, 16.29it/s]
[train epoch 32] loss: 1.692, acc: 0.411: 100%|█| 366/366 [00:39<00:00,  9.38it/
[valid epoch 32] loss: 1.592, acc: 0.507: 100%|█| 91/91 [00:05<00:00, 16.15it/s]
Best model (head+MLP+allAttn Stage 1) saved with accuracy: 0.5065
[train epoch 33] loss: 1.702, acc: 0.403: 100%|█| 366/366 [00:38<00:00,  9.62it/
[valid epoch 33] loss: 1.581, acc: 0.517: 100%|█| 91/91 [00:05<00:00, 16.20it/s]
Best model (head+MLP+allAttn Stage 1) saved with accuracy: 0.5168
[train epoch 34] loss: 1.679, acc: 0.411: 100%|█| 366/366 [00:38<00:00,  9.51it/
[valid epoch 34] loss: 1.564, acc: 0.526: 100%|█| 91/91 [00:05<00:00, 16.24it/s]
Best model (head+MLP+allAttn Stage 1) saved with accuracy: 0.5258
[train epoch 35] loss: 1.676, acc: 0.412: 100%|█| 366/366 [00:38<00:00,  9.46it/
[valid epoch 35] loss: 1.559, acc: 0.517: 100%|█| 91/91 [00:05<00:00, 16.21it/s]
[train epoch 36] loss: 1.678, acc: 0.415: 100%|█| 366/366 [00:40<00:00,  9.10it/
[valid epoch 36] loss: 1.554, acc: 0.522: 100%|█| 91/91 [00:05<00:00, 16.15it/s]
[train epoch 37] loss: 1.657, acc: 0.415: 100%|█| 366/366 [00:38<00:00,  9.49it/
[valid epoch 37] loss: 1.552, acc: 0.527: 100%|█| 91/91 [00:05<00:00, 16.22it/s]
Best model (head+MLP+allAttn Stage 1) saved with accuracy: 0.5271
[train epoch 38] loss: 1.670, acc: 0.417: 100%|█| 366/366 [00:37<00:00,  9.67it/
[valid epoch 38] loss: 1.553, acc: 0.519: 100%|█| 91/91 [00:05<00:00, 16.12it/s]
[train epoch 39] loss: 1.660, acc: 0.418: 100%|█| 366/366 [00:38<00:00,  9.52it/
[valid epoch 39] loss: 1.549, acc: 0.522: 100%|█| 91/91 [00:05<00:00, 16.26it/s]
Stage 1 (head+MLP+allAttn) finished. Best acc: 0.5271

=== QAT Stage 2 (6bit, head+MLP+allAttn) ===
[train epoch 40] loss: 1.565, acc: 0.383: 100%|█| 366/366 [00:38<00:00,  9.50it/
[valid epoch 40] loss: 1.621, acc: 0.510: 100%|█| 91/91 [00:05<00:00, 16.23it/s]
Best model (head+MLP+allAttn Stage 2) saved with accuracy: 0.5100
[train epoch 41] loss: 1.547, acc: 0.390: 100%|█| 366/366 [00:37<00:00,  9.67it/
[valid epoch 41] loss: 1.612, acc: 0.500: 100%|█| 91/91 [00:05<00:00, 16.27it/s]
[train epoch 42] loss: 1.532, acc: 0.391: 100%|█| 366/366 [00:38<00:00,  9.48it/
[valid epoch 42] loss: 1.710, acc: 0.465: 100%|█| 91/91 [00:05<00:00, 16.34it/s]
[train epoch 43] loss: 1.527, acc: 0.408: 100%|█| 366/366 [00:38<00:00,  9.54it/
[valid epoch 43] loss: 1.610, acc: 0.499: 100%|█| 91/91 [00:05<00:00, 16.26it/s]
[train epoch 44] loss: 1.534, acc: 0.394: 100%|█| 366/366 [00:39<00:00,  9.22it/
[valid epoch 44] loss: 1.635, acc: 0.509: 100%|█| 91/91 [00:05<00:00, 16.17it/s]
[train epoch 45] loss: 1.540, acc: 0.395: 100%|█| 366/366 [00:38<00:00,  9.40it/
[valid epoch 45] loss: 1.614, acc: 0.496: 100%|█| 91/91 [00:05<00:00, 16.15it/s]
[train epoch 46] loss: 1.526, acc: 0.396: 100%|█| 366/366 [00:38<00:00,  9.49it/
[valid epoch 46] loss: 1.636, acc: 0.499: 100%|█| 91/91 [00:05<00:00, 16.25it/s]
[train epoch 47] loss: 1.519, acc: 0.395: 100%|█| 366/366 [00:38<00:00,  9.53it/
[valid epoch 47] loss: 1.600, acc: 0.511: 100%|█| 91/91 [00:05<00:00, 16.12it/s]
Best model (head+MLP+allAttn Stage 2) saved with accuracy: 0.5107
[train epoch 48] loss: 1.513, acc: 0.396: 100%|█| 366/366 [00:38<00:00,  9.57it/
[valid epoch 48] loss: 1.601, acc: 0.505: 100%|█| 91/91 [00:05<00:00, 16.24it/s]
[train epoch 49] loss: 1.512, acc: 0.400: 100%|█| 366/366 [00:39<00:00,  9.37it/
[valid epoch 49] loss: 1.584, acc: 0.514: 100%|█| 91/91 [00:05<00:00, 16.25it/s]
Best model (head+MLP+allAttn Stage 2) saved with accuracy: 0.5141
[train epoch 50] loss: 1.511, acc: 0.402: 100%|█| 366/366 [00:38<00:00,  9.46it/
[valid epoch 50] loss: 1.602, acc: 0.523: 100%|█| 91/91 [00:05<00:00, 16.28it/s]
Best model (head+MLP+allAttn Stage 2) saved with accuracy: 0.5230
[train epoch 51] loss: 1.409, acc: 0.396: 100%|█| 366/366 [00:38<00:00,  9.48it/
[valid epoch 51] loss: 1.601, acc: 0.511: 100%|█| 91/91 [00:05<00:00, 16.32it/s]
[train epoch 52] loss: 1.396, acc: 0.404: 100%|█| 366/366 [00:40<00:00,  9.09it/
[valid epoch 52] loss: 1.584, acc: 0.510: 100%|█| 91/91 [00:05<00:00, 15.95it/s]
[train epoch 53] loss: 1.391, acc: 0.406: 100%|█| 366/366 [00:38<00:00,  9.45it/
[valid epoch 53] loss: 1.568, acc: 0.524: 100%|█| 91/91 [00:05<00:00, 16.19it/s]
Best model (head+MLP+allAttn Stage 2) saved with accuracy: 0.5244
[train epoch 54] loss: 1.379, acc: 0.413: 100%|█| 366/366 [00:38<00:00,  9.59it/
[valid epoch 54] loss: 1.549, acc: 0.524: 100%|█| 91/91 [00:05<00:00, 16.23it/s]
[train epoch 55] loss: 1.397, acc: 0.399: 100%|█| 366/366 [00:39<00:00,  9.21it/
[valid epoch 55] loss: 1.564, acc: 0.523: 100%|█| 91/91 [00:05<00:00, 16.13it/s]
[train epoch 56] loss: 1.365, acc: 0.417: 100%|█| 366/366 [00:39<00:00,  9.34it/
[valid epoch 56] loss: 1.555, acc: 0.529: 100%|█| 91/91 [00:05<00:00, 16.04it/s]
Best model (head+MLP+allAttn Stage 2) saved with accuracy: 0.5292
[train epoch 57] loss: 1.374, acc: 0.408: 100%|█| 366/366 [00:39<00:00,  9.23it/
[valid epoch 57] loss: 1.564, acc: 0.511: 100%|█| 91/91 [00:05<00:00, 15.85it/s]
[train epoch 58] loss: 1.371, acc: 0.405: 100%|█| 366/366 [00:38<00:00,  9.40it/
[valid epoch 58] loss: 1.536, acc: 0.533: 100%|█| 91/91 [00:05<00:00, 16.12it/s]
Best model (head+MLP+allAttn Stage 2) saved with accuracy: 0.5326
[train epoch 59] loss: 1.360, acc: 0.409: 100%|█| 366/366 [00:38<00:00,  9.42it/
[valid epoch 59] loss: 1.542, acc: 0.530: 100%|█| 91/91 [00:05<00:00, 16.14it/s]
[train epoch 60] loss: 1.345, acc: 0.427: 100%|█| 366/366 [00:38<00:00,  9.50it/
[valid epoch 60] loss: 1.545, acc: 0.531: 100%|█| 91/91 [00:05<00:00, 16.18it/s]
[train epoch 61] loss: 1.330, acc: 0.432: 100%|█| 366/366 [00:38<00:00,  9.55it/
[valid epoch 61] loss: 1.532, acc: 0.529: 100%|█| 91/91 [00:05<00:00, 16.15it/s]
[train epoch 62] loss: 1.348, acc: 0.429: 100%|█| 366/366 [00:39<00:00,  9.37it/
[valid epoch 62] loss: 1.517, acc: 0.531: 100%|█| 91/91 [00:05<00:00, 16.10it/s]
[train epoch 63] loss: 1.354, acc: 0.425: 100%|█| 366/366 [00:38<00:00,  9.50it/
[valid epoch 63] loss: 1.528, acc: 0.524: 100%|█| 91/91 [00:05<00:00, 16.19it/s]
[train epoch 64] loss: 1.346, acc: 0.429: 100%|█| 366/366 [00:39<00:00,  9.29it/
[valid epoch 64] loss: 1.525, acc: 0.529: 100%|█| 91/91 [00:05<00:00, 15.99it/s]
[train epoch 65] loss: 1.338, acc: 0.428: 100%|█| 366/366 [00:39<00:00,  9.29it/
[valid epoch 65] loss: 1.514, acc: 0.531: 100%|█| 91/91 [00:05<00:00, 16.13it/s]
[train epoch 66] loss: 1.341, acc: 0.420: 100%|█| 366/366 [00:38<00:00,  9.45it/
[valid epoch 66] loss: 1.511, acc: 0.531: 100%|█| 91/91 [00:05<00:00, 16.16it/s]
[train epoch 67] loss: 1.321, acc: 0.431: 100%|█| 366/366 [00:41<00:00,  8.93it/
[valid epoch 67] loss: 1.514, acc: 0.531: 100%|█| 91/91 [00:05<00:00, 16.01it/s]
[train epoch 68] loss: 1.335, acc: 0.423: 100%|█| 366/366 [00:39<00:00,  9.26it/
[valid epoch 68] loss: 1.517, acc: 0.533: 100%|█| 91/91 [00:05<00:00, 16.13it/s]
[train epoch 69] loss: 1.323, acc: 0.435: 100%|█| 366/366 [00:39<00:00,  9.19it/
[valid epoch 69] loss: 1.515, acc: 0.534: 100%|█| 91/91 [00:05<00:00, 16.12it/s]
Best model (head+MLP+allAttn Stage 2) saved with accuracy: 0.5340
Stage 2 (head+MLP+allAttn) finished. Best acc: 0.5340

=== QAT Stage 3 (4bit, head+MLP+allAttn) ===
[train epoch 70] loss: 1.295, acc: 0.216: 100%|█| 366/366 [00:40<00:00,  9.14it/
[valid epoch 70] loss: 2.130, acc: 0.340: 100%|█| 91/91 [00:05<00:00, 16.06it/s]
Best model (head+MLP+allAttn Stage 3) saved with accuracy: 0.3395
[train epoch 71] loss: 1.153, acc: 0.269: 100%|█| 366/366 [00:39<00:00,  9.38it/
[valid epoch 71] loss: 2.075, acc: 0.363: 100%|█| 91/91 [00:05<00:00, 16.02it/s]
Best model (head+MLP+allAttn Stage 3) saved with accuracy: 0.3629
[train epoch 72] loss: 1.130, acc: 0.293: 100%|█| 366/366 [00:39<00:00,  9.37it/
[valid epoch 72] loss: 1.965, acc: 0.397: 100%|█| 91/91 [00:05<00:00, 15.97it/s]
Best model (head+MLP+allAttn Stage 3) saved with accuracy: 0.3966
[train epoch 73] loss: 1.094, acc: 0.298: 100%|█| 366/366 [00:38<00:00,  9.51it/
[valid epoch 73] loss: 2.031, acc: 0.377: 100%|█| 91/91 [00:05<00:00, 16.14it/s]
[train epoch 74] loss: 1.077, acc: 0.306: 100%|█| 366/366 [00:39<00:00,  9.28it/
[valid epoch 74] loss: 1.952, acc: 0.401: 100%|█| 91/91 [00:05<00:00, 16.11it/s]
Best model (head+MLP+allAttn Stage 3) saved with accuracy: 0.4014
[train epoch 75] loss: 1.078, acc: 0.300: 100%|█| 366/366 [00:38<00:00,  9.48it/
[valid epoch 75] loss: 2.031, acc: 0.370: 100%|█| 91/91 [00:05<00:00, 16.05it/s]
[train epoch 76] loss: 1.073, acc: 0.310: 100%|█| 366/366 [00:38<00:00,  9.44it/
[valid epoch 76] loss: 1.893, acc: 0.423: 100%|█| 91/91 [00:05<00:00, 16.15it/s]
Best model (head+MLP+allAttn Stage 3) saved with accuracy: 0.4227
[train epoch 77] loss: 1.068, acc: 0.316: 100%|█| 366/366 [00:38<00:00,  9.39it/
[valid epoch 77] loss: 1.956, acc: 0.381: 100%|█| 91/91 [00:05<00:00, 16.10it/s]
[train epoch 78] loss: 1.045, acc: 0.318: 100%|█| 366/366 [00:38<00:00,  9.40it/
[valid epoch 78] loss: 1.870, acc: 0.426: 100%|█| 91/91 [00:05<00:00, 16.02it/s]
Best model (head+MLP+allAttn Stage 3) saved with accuracy: 0.4261
[train epoch 79] loss: 1.032, acc: 0.329: 100%|█| 366/366 [00:39<00:00,  9.35it/
[valid epoch 79] loss: 1.852, acc: 0.438: 100%|█| 91/91 [00:05<00:00, 16.10it/s]
Best model (head+MLP+allAttn Stage 3) saved with accuracy: 0.4385
[train epoch 80] loss: 1.035, acc: 0.320: 100%|█| 366/366 [00:38<00:00,  9.41it/
[valid epoch 80] loss: 1.885, acc: 0.434: 100%|█| 91/91 [00:05<00:00, 16.14it/s]
[train epoch 81] loss: 1.039, acc: 0.335: 100%|█| 366/366 [00:39<00:00,  9.35it/
[valid epoch 81] loss: 1.843, acc: 0.437: 100%|█| 91/91 [00:05<00:00, 16.04it/s]
[train epoch 82] loss: 1.017, acc: 0.335: 100%|█| 366/366 [00:39<00:00,  9.33it/
[valid epoch 82] loss: 1.813, acc: 0.449: 100%|█| 91/91 [00:05<00:00, 15.94it/s]
Best model (head+MLP+allAttn Stage 3) saved with accuracy: 0.4488
[train epoch 83] loss: 1.004, acc: 0.343: 100%|█| 366/366 [00:39<00:00,  9.36it/
[valid epoch 83] loss: 1.856, acc: 0.443: 100%|█| 91/91 [00:05<00:00, 16.06it/s]
[train epoch 84] loss: 0.988, acc: 0.350: 100%|█| 366/366 [00:39<00:00,  9.21it/
[valid epoch 84] loss: 1.834, acc: 0.438: 100%|█| 91/91 [00:05<00:00, 16.13it/s]
[train epoch 85] loss: 0.994, acc: 0.346: 100%|█| 366/366 [00:39<00:00,  9.29it/
[valid epoch 85] loss: 1.835, acc: 0.443: 100%|█| 91/91 [00:05<00:00, 16.06it/s]
[train epoch 86] loss: 0.993, acc: 0.342: 100%|█| 366/366 [00:38<00:00,  9.42it/
[valid epoch 86] loss: 1.842, acc: 0.432: 100%|█| 91/91 [00:05<00:00, 16.15it/s]
[train epoch 87] loss: 0.979, acc: 0.342: 100%|█| 366/366 [00:39<00:00,  9.36it/
[valid epoch 87] loss: 1.831, acc: 0.436: 100%|█| 91/91 [00:05<00:00, 16.17it/s]
[train epoch 88] loss: 0.967, acc: 0.341: 100%|█| 366/366 [00:39<00:00,  9.33it/
[valid epoch 88] loss: 1.818, acc: 0.441: 100%|█| 91/91 [00:05<00:00, 16.11it/s]
[train epoch 89] loss: 0.961, acc: 0.347: 100%|█| 366/366 [00:39<00:00,  9.33it/
[valid epoch 89] loss: 1.794, acc: 0.456: 100%|█| 91/91 [00:05<00:00, 16.15it/s]
Best model (head+MLP+allAttn Stage 3) saved with accuracy: 0.4557
[train epoch 90] loss: 1.254, acc: 0.350: 100%|█| 366/366 [00:38<00:00,  9.49it/
[valid epoch 90] loss: 1.740, acc: 0.467: 100%|█| 91/91 [00:05<00:00, 15.94it/s]
Best model (head+MLP+allAttn Stage 3) saved with accuracy: 0.4674
[train epoch 91] loss: 1.229, acc: 0.352: 100%|█| 366/366 [00:39<00:00,  9.33it/
[valid epoch 91] loss: 1.753, acc: 0.458: 100%|█| 91/91 [00:05<00:00, 16.22it/s]
[train epoch 92] loss: 1.213, acc: 0.356: 100%|█| 366/366 [00:39<00:00,  9.36it/
[valid epoch 92] loss: 1.726, acc: 0.483: 100%|█| 91/91 [00:05<00:00, 16.14it/s]
Best model (head+MLP+allAttn Stage 3) saved with accuracy: 0.4832
[train epoch 93] loss: 1.219, acc: 0.364: 100%|█| 366/366 [00:40<00:00,  9.14it/
[valid epoch 93] loss: 1.747, acc: 0.465: 100%|█| 91/91 [00:05<00:00, 16.12it/s]
[train epoch 94] loss: 1.201, acc: 0.363: 100%|█| 366/366 [00:39<00:00,  9.26it/
[valid epoch 94] loss: 1.770, acc: 0.455: 100%|█| 91/91 [00:05<00:00, 16.08it/s]
[train epoch 95] loss: 1.203, acc: 0.367: 100%|█| 366/366 [00:38<00:00,  9.44it/
[valid epoch 95] loss: 1.726, acc: 0.480: 100%|█| 91/91 [00:05<00:00, 16.03it/s]
[train epoch 96] loss: 1.189, acc: 0.364: 100%|█| 366/366 [00:38<00:00,  9.46it/
[valid epoch 96] loss: 1.702, acc: 0.477: 100%|█| 91/91 [00:05<00:00, 16.14it/s]
[train epoch 97] loss: 1.204, acc: 0.365: 100%|█| 366/366 [00:38<00:00,  9.48it/
[valid epoch 97] loss: 1.733, acc: 0.472: 100%|█| 91/91 [00:05<00:00, 16.11it/s]
[train epoch 98] loss: 1.179, acc: 0.375: 100%|█| 366/366 [00:38<00:00,  9.41it/
[valid epoch 98] loss: 1.744, acc: 0.462: 100%|█| 91/91 [00:06<00:00, 13.60it/s]
[train epoch 99] loss: 1.182, acc: 0.374: 100%|█| 366/366 [00:39<00:00,  9.33it/
[valid epoch 99] loss: 1.699, acc: 0.476: 100%|█| 91/91 [00:05<00:00, 16.18it/s]
[train epoch 100] loss: 1.178, acc: 0.370: 100%|█| 366/366 [00:39<00:00,  9.22it
[valid epoch 100] loss: 1.689, acc: 0.482: 100%|█| 91/91 [00:05<00:00, 15.97it/s
[train epoch 101] loss: 1.153, acc: 0.383: 100%|█| 366/366 [00:39<00:00,  9.28it
[valid epoch 101] loss: 1.688, acc: 0.482: 100%|█| 91/91 [00:05<00:00, 16.08it/s
[train epoch 102] loss: 1.177, acc: 0.375: 100%|█| 366/366 [00:39<00:00,  9.33it
[valid epoch 102] loss: 1.671, acc: 0.487: 100%|█| 91/91 [00:05<00:00, 16.05it/s
Best model (head+MLP+allAttn Stage 3) saved with accuracy: 0.4873
[train epoch 103] loss: 1.172, acc: 0.374: 100%|█| 366/366 [00:38<00:00,  9.49it
[valid epoch 103] loss: 1.666, acc: 0.494: 100%|█| 91/91 [00:05<00:00, 16.10it/s
Best model (head+MLP+allAttn Stage 3) saved with accuracy: 0.4942
[train epoch 104] loss: 1.151, acc: 0.383: 100%|█| 366/366 [00:40<00:00,  9.01it
[valid epoch 104] loss: 1.671, acc: 0.495: 100%|█| 91/91 [00:05<00:00, 16.01it/s
Best model (head+MLP+allAttn Stage 3) saved with accuracy: 0.4948
[train epoch 105] loss: 1.159, acc: 0.376: 100%|█| 366/366 [00:40<00:00,  9.14it
[valid epoch 105] loss: 1.675, acc: 0.486: 100%|█| 91/91 [00:05<00:00, 15.94it/s
[train epoch 106] loss: 1.157, acc: 0.388: 100%|█| 366/366 [00:39<00:00,  9.31it
[valid epoch 106] loss: 1.678, acc: 0.484: 100%|█| 91/91 [00:05<00:00, 16.04it/s
[train epoch 107] loss: 1.136, acc: 0.394: 100%|█| 366/366 [00:38<00:00,  9.46it
[valid epoch 107] loss: 1.664, acc: 0.483: 100%|█| 91/91 [00:05<00:00, 16.05it/s
[train epoch 108] loss: 1.147, acc: 0.373: 100%|█| 366/366 [00:41<00:00,  8.81it
[valid epoch 108] loss: 1.663, acc: 0.480: 100%|█| 91/91 [00:05<00:00, 15.88it/s
[train epoch 109] loss: 1.140, acc: 0.387: 100%|█| 366/366 [00:40<00:00,  8.96it
[valid epoch 109] loss: 1.665, acc: 0.494: 100%|█| 91/91 [00:05<00:00, 15.90it/s
Stage 3 (head+MLP+allAttn) finished. Best acc: 0.4948
Progressive QAT completed. Best validation accuracy: 0.5340

==== Sweep 13: all-main ====

=== QAT Stage 1 (8bit, all-main) ===
[train epoch 0] loss: 2.058, acc: 0.280: 100%|█| 366/366 [00:41<00:00,  8.82it/s
[valid epoch 0] loss: 2.018, acc: 0.358: 100%|██| 91/91 [00:05<00:00, 15.50it/s]
Best model (all-main Stage 1) saved with accuracy: 0.3581
[train epoch 1] loss: 2.013, acc: 0.304: 100%|█| 366/366 [00:39<00:00,  9.29it/s
[valid epoch 1] loss: 1.950, acc: 0.407: 100%|██| 91/91 [00:05<00:00, 16.02it/s]
Best model (all-main Stage 1) saved with accuracy: 0.4069
[train epoch 2] loss: 2.011, acc: 0.295: 100%|█| 366/366 [00:39<00:00,  9.24it/s
[valid epoch 2] loss: 2.078, acc: 0.349: 100%|██| 91/91 [00:05<00:00, 15.98it/s]
[train epoch 3] loss: 1.983, acc: 0.308: 100%|█| 366/366 [00:40<00:00,  8.95it/s
[valid epoch 3] loss: 1.925, acc: 0.403: 100%|██| 91/91 [00:05<00:00, 15.83it/s]
[train epoch 4] loss: 1.964, acc: 0.314: 100%|█| 366/366 [00:39<00:00,  9.37it/s
[valid epoch 4] loss: 1.927, acc: 0.405: 100%|██| 91/91 [00:05<00:00, 15.90it/s]
[train epoch 5] loss: 1.973, acc: 0.305: 100%|█| 366/366 [00:38<00:00,  9.44it/s
[valid epoch 5] loss: 1.897, acc: 0.420: 100%|██| 91/91 [00:05<00:00, 15.95it/s]
Best model (all-main Stage 1) saved with accuracy: 0.4199
[train epoch 6] loss: 1.974, acc: 0.303: 100%|█| 366/366 [00:39<00:00,  9.24it/s
[valid epoch 6] loss: 1.959, acc: 0.384: 100%|██| 91/91 [00:05<00:00, 16.03it/s]
[train epoch 7] loss: 1.977, acc: 0.303: 100%|█| 366/366 [00:40<00:00,  9.02it/s
[valid epoch 7] loss: 1.880, acc: 0.433: 100%|██| 91/91 [00:05<00:00, 15.83it/s]
Best model (all-main Stage 1) saved with accuracy: 0.4330
[train epoch 8] loss: 1.951, acc: 0.313: 100%|█| 366/366 [00:39<00:00,  9.37it/s
[valid epoch 8] loss: 1.892, acc: 0.419: 100%|██| 91/91 [00:05<00:00, 15.97it/s]
[train epoch 9] loss: 1.942, acc: 0.317: 100%|█| 366/366 [00:39<00:00,  9.35it/s
[valid epoch 9] loss: 2.111, acc: 0.355: 100%|██| 91/91 [00:05<00:00, 15.96it/s]
[train epoch 10] loss: 1.937, acc: 0.321: 100%|█| 366/366 [00:39<00:00,  9.28it/
[valid epoch 10] loss: 1.885, acc: 0.408: 100%|█| 91/91 [00:05<00:00, 15.94it/s]
[train epoch 11] loss: 1.929, acc: 0.333: 100%|█| 366/366 [00:39<00:00,  9.31it/
[valid epoch 11] loss: 1.956, acc: 0.397: 100%|█| 91/91 [00:05<00:00, 15.84it/s]
[train epoch 12] loss: 1.924, acc: 0.323: 100%|█| 366/366 [00:38<00:00,  9.45it/
[valid epoch 12] loss: 1.829, acc: 0.434: 100%|█| 91/91 [00:05<00:00, 15.95it/s]
Best model (all-main Stage 1) saved with accuracy: 0.4337
[train epoch 13] loss: 1.911, acc: 0.333: 100%|█| 366/366 [00:39<00:00,  9.38it/
[valid epoch 13] loss: 1.831, acc: 0.434: 100%|█| 91/91 [00:05<00:00, 15.92it/s]
[train epoch 14] loss: 1.888, acc: 0.347: 100%|█| 366/366 [00:38<00:00,  9.53it/
[valid epoch 14] loss: 1.781, acc: 0.445: 100%|█| 91/91 [00:05<00:00, 15.97it/s]
Best model (all-main Stage 1) saved with accuracy: 0.4447
[train epoch 15] loss: 1.887, acc: 0.333: 100%|█| 366/366 [00:39<00:00,  9.23it/
[valid epoch 15] loss: 1.786, acc: 0.439: 100%|█| 91/91 [00:05<00:00, 15.83it/s]
[train epoch 16] loss: 1.877, acc: 0.349: 100%|█| 366/366 [00:39<00:00,  9.32it/
[valid epoch 16] loss: 1.856, acc: 0.432: 100%|█| 91/91 [00:05<00:00, 15.94it/s]
[train epoch 17] loss: 1.876, acc: 0.346: 100%|█| 366/366 [00:40<00:00,  9.05it/
[valid epoch 17] loss: 1.875, acc: 0.406: 100%|█| 91/91 [00:06<00:00, 14.73it/s]
[train epoch 18] loss: 1.868, acc: 0.344: 100%|█| 366/366 [00:38<00:00,  9.48it/
[valid epoch 18] loss: 1.847, acc: 0.436: 100%|█| 91/91 [00:05<00:00, 15.95it/s]
[train epoch 19] loss: 1.846, acc: 0.354: 100%|█| 366/366 [00:39<00:00,  9.35it/
[valid epoch 19] loss: 1.789, acc: 0.456: 100%|█| 91/91 [00:05<00:00, 15.96it/s]
Best model (all-main Stage 1) saved with accuracy: 0.4557
[train epoch 20] loss: 1.824, acc: 0.365: 100%|█| 366/366 [00:39<00:00,  9.32it/
[valid epoch 20] loss: 1.787, acc: 0.453: 100%|█| 91/91 [00:05<00:00, 16.01it/s]
[train epoch 21] loss: 1.817, acc: 0.366: 100%|█| 366/366 [00:39<00:00,  9.26it/
[valid epoch 21] loss: 1.729, acc: 0.465: 100%|█| 91/91 [00:05<00:00, 15.88it/s]
Best model (all-main Stage 1) saved with accuracy: 0.4653
[train epoch 22] loss: 1.816, acc: 0.361: 100%|█| 366/366 [00:39<00:00,  9.38it/
[valid epoch 22] loss: 1.761, acc: 0.452: 100%|█| 91/91 [00:05<00:00, 16.02it/s]
[train epoch 23] loss: 1.776, acc: 0.382: 100%|█| 366/366 [00:38<00:00,  9.40it/
[valid epoch 23] loss: 1.717, acc: 0.467: 100%|█| 91/91 [00:05<00:00, 16.02it/s]
Best model (all-main Stage 1) saved with accuracy: 0.4667
[train epoch 24] loss: 1.774, acc: 0.377: 100%|█| 366/366 [00:39<00:00,  9.18it/
[valid epoch 24] loss: 1.696, acc: 0.476: 100%|█| 91/91 [00:05<00:00, 15.91it/s]
Best model (all-main Stage 1) saved with accuracy: 0.4756
[train epoch 25] loss: 1.747, acc: 0.387: 100%|█| 366/366 [00:38<00:00,  9.41it/
[valid epoch 25] loss: 1.651, acc: 0.488: 100%|█| 91/91 [00:05<00:00, 15.92it/s]
Best model (all-main Stage 1) saved with accuracy: 0.4880
[train epoch 26] loss: 1.743, acc: 0.386: 100%|█| 366/366 [00:39<00:00,  9.35it/
[valid epoch 26] loss: 1.656, acc: 0.491: 100%|█| 91/91 [00:05<00:00, 16.01it/s]
Best model (all-main Stage 1) saved with accuracy: 0.4914
[train epoch 27] loss: 1.727, acc: 0.402: 100%|█| 366/366 [00:39<00:00,  9.34it/
[valid epoch 27] loss: 1.652, acc: 0.495: 100%|█| 91/91 [00:05<00:00, 16.05it/s]
Best model (all-main Stage 1) saved with accuracy: 0.4948
[train epoch 28] loss: 1.729, acc: 0.397: 100%|█| 366/366 [00:39<00:00,  9.23it/
[valid epoch 28] loss: 1.614, acc: 0.503: 100%|█| 91/91 [00:05<00:00, 15.94it/s]
Best model (all-main Stage 1) saved with accuracy: 0.5031
[train epoch 29] loss: 1.724, acc: 0.395: 100%|█| 366/366 [00:39<00:00,  9.21it/
[valid epoch 29] loss: 1.598, acc: 0.500: 100%|█| 91/91 [00:05<00:00, 15.85it/s]
[train epoch 30] loss: 1.708, acc: 0.397: 100%|█| 366/366 [00:39<00:00,  9.31it/
[valid epoch 30] loss: 1.590, acc: 0.504: 100%|█| 91/91 [00:05<00:00, 15.82it/s]
Best model (all-main Stage 1) saved with accuracy: 0.5038
[train epoch 31] loss: 1.688, acc: 0.407: 100%|█| 366/366 [00:38<00:00,  9.40it/
[valid epoch 31] loss: 1.581, acc: 0.514: 100%|█| 91/91 [00:05<00:00, 15.98it/s]
Best model (all-main Stage 1) saved with accuracy: 0.5141
[train epoch 32] loss: 1.686, acc: 0.413: 100%|█| 366/366 [00:39<00:00,  9.34it/
[valid epoch 32] loss: 1.565, acc: 0.509: 100%|█| 91/91 [00:05<00:00, 15.99it/s]
[train epoch 33] loss: 1.678, acc: 0.407: 100%|█| 366/366 [00:39<00:00,  9.16it/
[valid epoch 33] loss: 1.562, acc: 0.522: 100%|█| 91/91 [00:05<00:00, 15.90it/s]
Best model (all-main Stage 1) saved with accuracy: 0.5216
[train epoch 34] loss: 1.686, acc: 0.409: 100%|█| 366/366 [00:38<00:00,  9.47it/
[valid epoch 34] loss: 1.551, acc: 0.518: 100%|█| 91/91 [00:05<00:00, 15.99it/s]
[train epoch 35] loss: 1.671, acc: 0.411: 100%|█| 366/366 [00:39<00:00,  9.30it/
[valid epoch 35] loss: 1.544, acc: 0.515: 100%|█| 91/91 [00:05<00:00, 15.83it/s]
[train epoch 36] loss: 1.649, acc: 0.420: 100%|█| 366/366 [00:39<00:00,  9.34it/
[valid epoch 36] loss: 1.551, acc: 0.520: 100%|█| 91/91 [00:05<00:00, 15.98it/s]
[train epoch 37] loss: 1.658, acc: 0.425: 100%|█| 366/366 [00:39<00:00,  9.35it/
[valid epoch 37] loss: 1.540, acc: 0.522: 100%|█| 91/91 [00:05<00:00, 15.95it/s]
Best model (all-main Stage 1) saved with accuracy: 0.5223
[train epoch 38] loss: 1.674, acc: 0.412: 100%|█| 366/366 [00:39<00:00,  9.27it/
[valid epoch 38] loss: 1.534, acc: 0.529: 100%|█| 91/91 [00:05<00:00, 15.89it/s]
Best model (all-main Stage 1) saved with accuracy: 0.5285
[train epoch 39] loss: 1.654, acc: 0.423: 100%|█| 366/366 [00:39<00:00,  9.27it/
[valid epoch 39] loss: 1.531, acc: 0.528: 100%|█| 91/91 [00:05<00:00, 15.98it/s]
Stage 1 (all-main) finished. Best acc: 0.5285

=== QAT Stage 2 (6bit, all-main) ===
[train epoch 40] loss: 1.557, acc: 0.382: 100%|█| 366/366 [00:39<00:00,  9.38it/
[valid epoch 40] loss: 1.660, acc: 0.489: 100%|█| 91/91 [00:05<00:00, 16.02it/s]
Best model (all-main Stage 2) saved with accuracy: 0.4893
[train epoch 41] loss: 1.527, acc: 0.396: 100%|█| 366/366 [00:38<00:00,  9.59it/
[valid epoch 41] loss: 1.614, acc: 0.502: 100%|█| 91/91 [00:05<00:00, 16.09it/s]
Best model (all-main Stage 2) saved with accuracy: 0.5017
[train epoch 42] loss: 1.541, acc: 0.389: 100%|█| 366/366 [00:39<00:00,  9.38it/
[valid epoch 42] loss: 1.634, acc: 0.509: 100%|█| 91/91 [00:05<00:00, 16.06it/s]
Best model (all-main Stage 2) saved with accuracy: 0.5086
[train epoch 43] loss: 1.532, acc: 0.398: 100%|█| 366/366 [00:38<00:00,  9.42it/
[valid epoch 43] loss: 1.643, acc: 0.502: 100%|█| 91/91 [00:05<00:00, 16.00it/s]
[train epoch 44] loss: 1.520, acc: 0.397: 100%|█| 366/366 [00:41<00:00,  8.87it/
[valid epoch 44] loss: 1.690, acc: 0.477: 100%|█| 91/91 [00:05<00:00, 15.82it/s]
[train epoch 45] loss: 1.509, acc: 0.398: 100%|█| 366/366 [00:39<00:00,  9.21it/
[valid epoch 45] loss: 1.622, acc: 0.502: 100%|█| 91/91 [00:05<00:00, 15.93it/s]
[train epoch 46] loss: 1.512, acc: 0.403: 100%|█| 366/366 [00:39<00:00,  9.27it/
[valid epoch 46] loss: 1.601, acc: 0.513: 100%|█| 91/91 [00:05<00:00, 15.93it/s]
Best model (all-main Stage 2) saved with accuracy: 0.5134
[train epoch 47] loss: 1.511, acc: 0.404: 100%|█| 366/366 [00:39<00:00,  9.35it/
[valid epoch 47] loss: 1.607, acc: 0.514: 100%|█| 91/91 [00:05<00:00, 15.98it/s]
Best model (all-main Stage 2) saved with accuracy: 0.5141
[train epoch 48] loss: 1.517, acc: 0.402: 100%|█| 366/366 [00:39<00:00,  9.29it/
[valid epoch 48] loss: 1.575, acc: 0.522: 100%|█| 91/91 [00:05<00:00, 16.03it/s]
Best model (all-main Stage 2) saved with accuracy: 0.5216
[train epoch 49] loss: 1.499, acc: 0.399: 100%|█| 366/366 [00:39<00:00,  9.26it/
[valid epoch 49] loss: 1.573, acc: 0.530: 100%|█| 91/91 [00:05<00:00, 15.94it/s]
Best model (all-main Stage 2) saved with accuracy: 0.5299
[train epoch 50] loss: 1.494, acc: 0.408: 100%|█| 366/366 [00:39<00:00,  9.30it/
[valid epoch 50] loss: 1.567, acc: 0.523: 100%|█| 91/91 [00:05<00:00, 16.06it/s]
[train epoch 51] loss: 1.392, acc: 0.404: 100%|█| 366/366 [00:38<00:00,  9.50it/
[valid epoch 51] loss: 1.579, acc: 0.504: 100%|█| 91/91 [00:05<00:00, 15.89it/s]
[train epoch 52] loss: 1.384, acc: 0.411: 100%|█| 366/366 [00:38<00:00,  9.39it/
[valid epoch 52] loss: 1.581, acc: 0.525: 100%|█| 91/91 [00:05<00:00, 15.97it/s]
[train epoch 53] loss: 1.389, acc: 0.405: 100%|█| 366/366 [00:39<00:00,  9.18it/
[valid epoch 53] loss: 1.549, acc: 0.534: 100%|█| 91/91 [00:05<00:00, 15.90it/s]
Best model (all-main Stage 2) saved with accuracy: 0.5340
[train epoch 54] loss: 1.360, acc: 0.423: 100%|█| 366/366 [00:39<00:00,  9.21it/
[valid epoch 54] loss: 1.546, acc: 0.529: 100%|█| 91/91 [00:05<00:00, 15.96it/s]
[train epoch 55] loss: 1.365, acc: 0.418: 100%|█| 366/366 [00:39<00:00,  9.38it/
[valid epoch 55] loss: 1.551, acc: 0.524: 100%|█| 91/91 [00:05<00:00, 15.90it/s]
[train epoch 56] loss: 1.374, acc: 0.412: 100%|█| 366/366 [00:39<00:00,  9.36it/
[valid epoch 56] loss: 1.549, acc: 0.525: 100%|█| 91/91 [00:05<00:00, 16.00it/s]
[train epoch 57] loss: 1.351, acc: 0.422: 100%|█| 366/366 [00:39<00:00,  9.33it/
[valid epoch 57] loss: 1.535, acc: 0.536: 100%|█| 91/91 [00:05<00:00, 15.93it/s]
Best model (all-main Stage 2) saved with accuracy: 0.5361
[train epoch 58] loss: 1.361, acc: 0.419: 100%|█| 366/366 [00:39<00:00,  9.26it/
[valid epoch 58] loss: 1.531, acc: 0.531: 100%|█| 91/91 [00:05<00:00, 15.87it/s]
[train epoch 59] loss: 1.354, acc: 0.421: 100%|█| 366/366 [00:39<00:00,  9.16it/
[valid epoch 59] loss: 1.525, acc: 0.531: 100%|█| 91/91 [00:05<00:00, 15.91it/s]
[train epoch 60] loss: 1.336, acc: 0.427: 100%|█| 366/366 [00:39<00:00,  9.25it/
[valid epoch 60] loss: 1.514, acc: 0.537: 100%|█| 91/91 [00:05<00:00, 16.04it/s]
Best model (all-main Stage 2) saved with accuracy: 0.5375
[train epoch 61] loss: 1.332, acc: 0.429: 100%|█| 366/366 [00:39<00:00,  9.35it/
[valid epoch 61] loss: 1.503, acc: 0.540: 100%|█| 91/91 [00:05<00:00, 15.93it/s]
Best model (all-main Stage 2) saved with accuracy: 0.5402
[train epoch 62] loss: 1.323, acc: 0.427: 100%|█| 366/366 [00:39<00:00,  9.25it/
[valid epoch 62] loss: 1.509, acc: 0.541: 100%|█| 91/91 [00:05<00:00, 15.94it/s]
Best model (all-main Stage 2) saved with accuracy: 0.5409
[train epoch 63] loss: 1.339, acc: 0.417: 100%|█| 366/366 [00:39<00:00,  9.34it/
[valid epoch 63] loss: 1.519, acc: 0.535: 100%|█| 91/91 [00:05<00:00, 15.85it/s]
[train epoch 64] loss: 1.316, acc: 0.433: 100%|█| 366/366 [00:39<00:00,  9.31it/
[valid epoch 64] loss: 1.501, acc: 0.546: 100%|█| 91/91 [00:05<00:00, 15.91it/s]
Best model (all-main Stage 2) saved with accuracy: 0.5464
[train epoch 65] loss: 1.332, acc: 0.421: 100%|█| 366/366 [00:39<00:00,  9.19it/
[valid epoch 65] loss: 1.513, acc: 0.541: 100%|█| 91/91 [00:05<00:00, 16.09it/s]
[train epoch 66] loss: 1.313, acc: 0.438: 100%|█| 366/366 [00:39<00:00,  9.18it/
[valid epoch 66] loss: 1.503, acc: 0.542: 100%|█| 91/91 [00:05<00:00, 15.91it/s]
[train epoch 67] loss: 1.334, acc: 0.431: 100%|█| 366/366 [00:39<00:00,  9.25it/
[valid epoch 67] loss: 1.501, acc: 0.544: 100%|█| 91/91 [00:05<00:00, 15.98it/s]
[train epoch 68] loss: 1.314, acc: 0.436: 100%|█| 366/366 [00:39<00:00,  9.27it/
[valid epoch 68] loss: 1.498, acc: 0.543: 100%|█| 91/91 [00:05<00:00, 15.94it/s]
[train epoch 69] loss: 1.311, acc: 0.436: 100%|█| 366/366 [00:39<00:00,  9.31it/
[valid epoch 69] loss: 1.504, acc: 0.544: 100%|█| 91/91 [00:05<00:00, 16.00it/s]
Stage 2 (all-main) finished. Best acc: 0.5464

=== QAT Stage 3 (4bit, all-main) ===
[train epoch 70] loss: 1.368, acc: 0.168: 100%|█| 366/366 [00:39<00:00,  9.29it/
[valid epoch 70] loss: 2.414, acc: 0.216: 100%|█| 91/91 [00:05<00:00, 16.06it/s]
Best model (all-main Stage 3) saved with accuracy: 0.2165
[train epoch 71] loss: 1.274, acc: 0.213: 100%|█| 366/366 [00:39<00:00,  9.35it/
[valid epoch 71] loss: 2.313, acc: 0.267: 100%|█| 91/91 [00:05<00:00, 16.01it/s]
Best model (all-main Stage 3) saved with accuracy: 0.2667
[train epoch 72] loss: 1.222, acc: 0.227: 100%|█| 366/366 [00:39<00:00,  9.27it/
[valid epoch 72] loss: 2.187, acc: 0.322: 100%|█| 91/91 [00:05<00:00, 15.87it/s]
Best model (all-main Stage 3) saved with accuracy: 0.3223
[train epoch 73] loss: 1.185, acc: 0.249: 100%|█| 366/366 [00:39<00:00,  9.26it/
[valid epoch 73] loss: 2.127, acc: 0.337: 100%|█| 91/91 [00:05<00:00, 15.73it/s]
Best model (all-main Stage 3) saved with accuracy: 0.3375
[train epoch 74] loss: 1.178, acc: 0.257: 100%|█| 366/366 [00:39<00:00,  9.31it/
[valid epoch 74] loss: 2.115, acc: 0.339: 100%|█| 91/91 [00:05<00:00, 16.01it/s]
Best model (all-main Stage 3) saved with accuracy: 0.3388
[train epoch 75] loss: 1.154, acc: 0.267: 100%|█| 366/366 [00:40<00:00,  8.99it/
[valid epoch 75] loss: 2.109, acc: 0.327: 100%|█| 91/91 [00:05<00:00, 15.81it/s]
[train epoch 76] loss: 1.141, acc: 0.277: 100%|█| 366/366 [00:40<00:00,  9.06it/
[valid epoch 76] loss: 2.053, acc: 0.372: 100%|█| 91/91 [00:05<00:00, 15.99it/s]
Best model (all-main Stage 3) saved with accuracy: 0.3718
[train epoch 77] loss: 1.135, acc: 0.280: 100%|█| 366/366 [00:39<00:00,  9.16it/
[valid epoch 77] loss: 2.107, acc: 0.335: 100%|█| 91/91 [00:05<00:00, 15.86it/s]
[train epoch 78] loss: 1.121, acc: 0.281: 100%|█| 366/366 [00:39<00:00,  9.24it/
[valid epoch 78] loss: 2.017, acc: 0.379: 100%|█| 91/91 [00:05<00:00, 15.90it/s]
Best model (all-main Stage 3) saved with accuracy: 0.3794
[train epoch 79] loss: 1.110, acc: 0.283: 100%|█| 366/366 [00:41<00:00,  8.85it/
[valid epoch 79] loss: 2.010, acc: 0.378: 100%|█| 91/91 [00:05<00:00, 15.65it/s]
[train epoch 80] loss: 1.097, acc: 0.300: 100%|█| 366/366 [00:41<00:00,  8.78it/
[valid epoch 80] loss: 2.019, acc: 0.378: 100%|█| 91/91 [00:05<00:00, 15.36it/s]
[train epoch 81] loss: 1.106, acc: 0.303: 100%|█| 366/366 [00:38<00:00,  9.40it/
[valid epoch 81] loss: 1.983, acc: 0.399: 100%|█| 91/91 [00:05<00:00, 15.42it/s]
Best model (all-main Stage 3) saved with accuracy: 0.3993
[train epoch 82] loss: 1.088, acc: 0.301: 100%|█| 366/366 [00:39<00:00,  9.33it/
[valid epoch 82] loss: 1.981, acc: 0.395: 100%|█| 91/91 [00:05<00:00, 15.93it/s]
[train epoch 83] loss: 1.076, acc: 0.303: 100%|█| 366/366 [00:43<00:00,  8.37it/
[valid epoch 83] loss: 1.973, acc: 0.379: 100%|█| 91/91 [00:05<00:00, 15.83it/s]
[train epoch 84] loss: 1.069, acc: 0.315: 100%|█| 366/366 [00:42<00:00,  8.70it/
[valid epoch 84] loss: 1.948, acc: 0.391: 100%|█| 91/91 [00:05<00:00, 15.84it/s]
[train epoch 85] loss: 1.060, acc: 0.311: 100%|█| 366/366 [00:43<00:00,  8.37it/
[valid epoch 85] loss: 2.042, acc: 0.374: 100%|█| 91/91 [00:06<00:00, 15.04it/s]
[train epoch 86] loss: 1.054, acc: 0.320: 100%|█| 366/366 [00:39<00:00,  9.26it/
[valid epoch 86] loss: 1.954, acc: 0.397: 100%|█| 91/91 [00:07<00:00, 11.88it/s]
[train epoch 87] loss: 1.049, acc: 0.311: 100%|█| 366/366 [00:40<00:00,  9.08it/
[valid epoch 87] loss: 1.942, acc: 0.399: 100%|█| 91/91 [00:05<00:00, 15.89it/s]
[train epoch 88] loss: 1.034, acc: 0.313: 100%|█| 366/366 [00:40<00:00,  9.12it/
[valid epoch 88] loss: 1.924, acc: 0.399: 100%|█| 91/91 [00:05<00:00, 16.00it/s]
[train epoch 89] loss: 1.029, acc: 0.321: 100%|█| 366/366 [00:40<00:00,  9.05it/
[valid epoch 89] loss: 1.930, acc: 0.386: 100%|█| 91/91 [00:05<00:00, 15.94it/s]
[train epoch 90] loss: 1.332, acc: 0.322: 100%|█| 366/366 [00:39<00:00,  9.15it/
[valid epoch 90] loss: 1.899, acc: 0.407: 100%|█| 91/91 [00:05<00:00, 15.64it/s]
Best model (all-main Stage 3) saved with accuracy: 0.4069
[train epoch 91] loss: 1.330, acc: 0.331: 100%|█| 366/366 [00:39<00:00,  9.24it/
[valid epoch 91] loss: 1.883, acc: 0.416: 100%|█| 91/91 [00:05<00:00, 16.02it/s]
Best model (all-main Stage 3) saved with accuracy: 0.4165
[train epoch 92] loss: 1.317, acc: 0.333: 100%|█| 366/366 [00:45<00:00,  8.03it/
[valid epoch 92] loss: 1.863, acc: 0.423: 100%|█| 91/91 [00:05<00:00, 15.44it/s]
Best model (all-main Stage 3) saved with accuracy: 0.4234
[train epoch 93] loss: 1.295, acc: 0.333: 100%|█| 366/366 [00:39<00:00,  9.18it/
[valid epoch 93] loss: 1.896, acc: 0.416: 100%|█| 91/91 [00:05<00:00, 15.89it/s]
[train epoch 94] loss: 1.282, acc: 0.330: 100%|█| 366/366 [00:39<00:00,  9.20it/
[valid epoch 94] loss: 1.867, acc: 0.423: 100%|█| 91/91 [00:05<00:00, 16.05it/s]
[train epoch 95] loss: 1.277, acc: 0.339: 100%|█| 366/366 [00:40<00:00,  9.14it/
[valid epoch 95] loss: 1.842, acc: 0.423: 100%|█| 91/91 [00:05<00:00, 15.84it/s]
[train epoch 96] loss: 1.286, acc: 0.335: 100%|█| 366/366 [00:39<00:00,  9.18it/
[valid epoch 96] loss: 1.883, acc: 0.417: 100%|█| 91/91 [00:05<00:00, 15.96it/s]
[train epoch 97] loss: 1.249, acc: 0.337: 100%|█| 366/366 [00:39<00:00,  9.33it/
[valid epoch 97] loss: 1.831, acc: 0.441: 100%|█| 91/91 [00:05<00:00, 15.28it/s]
Best model (all-main Stage 3) saved with accuracy: 0.4412
[train epoch 98] loss: 1.256, acc: 0.341: 100%|█| 366/366 [00:39<00:00,  9.33it/
[valid epoch 98] loss: 1.805, acc: 0.445: 100%|█| 91/91 [00:05<00:00, 16.03it/s]
Best model (all-main Stage 3) saved with accuracy: 0.4447
[train epoch 99] loss: 1.261, acc: 0.347: 100%|█| 366/366 [00:40<00:00,  9.08it/
[valid epoch 99] loss: 1.792, acc: 0.434: 100%|█| 91/91 [00:05<00:00, 16.00it/s]
[train epoch 100] loss: 1.238, acc: 0.346: 100%|█| 366/366 [00:40<00:00,  9.13it
[valid epoch 100] loss: 1.787, acc: 0.446: 100%|█| 91/91 [00:05<00:00, 15.79it/s
Best model (all-main Stage 3) saved with accuracy: 0.4460
[train epoch 101] loss: 1.244, acc: 0.356: 100%|█| 366/366 [00:39<00:00,  9.23it
[valid epoch 101] loss: 1.818, acc: 0.441: 100%|█| 91/91 [00:05<00:00, 16.02it/s
[train epoch 102] loss: 1.235, acc: 0.365: 100%|█| 366/366 [00:39<00:00,  9.25it
[valid epoch 102] loss: 1.779, acc: 0.455: 100%|█| 91/91 [00:05<00:00, 15.95it/s
Best model (all-main Stage 3) saved with accuracy: 0.4550
[train epoch 103] loss: 1.239, acc: 0.356: 100%|█| 366/366 [00:39<00:00,  9.19it
[valid epoch 103] loss: 1.785, acc: 0.450: 100%|█| 91/91 [00:05<00:00, 16.01it/s
[train epoch 104] loss: 1.242, acc: 0.343: 100%|█| 366/366 [00:41<00:00,  8.92it
[valid epoch 104] loss: 1.787, acc: 0.448: 100%|█| 91/91 [00:05<00:00, 15.74it/s
[train epoch 105] loss: 1.225, acc: 0.356: 100%|█| 366/366 [00:40<00:00,  9.03it
[valid epoch 105] loss: 1.774, acc: 0.454: 100%|█| 91/91 [00:05<00:00, 15.79it/s
[train epoch 106] loss: 1.227, acc: 0.357: 100%|█| 366/366 [00:40<00:00,  9.09it
[valid epoch 106] loss: 1.795, acc: 0.447: 100%|█| 91/91 [00:05<00:00, 15.88it/s
[train epoch 107] loss: 1.225, acc: 0.353: 100%|█| 366/366 [00:40<00:00,  9.05it
[valid epoch 107] loss: 1.780, acc: 0.447: 100%|█| 91/91 [00:05<00:00, 15.81it/s
[train epoch 108] loss: 1.233, acc: 0.347: 100%|█| 366/366 [00:40<00:00,  8.98it
[valid epoch 108] loss: 1.780, acc: 0.451: 100%|█| 91/91 [00:05<00:00, 15.31it/s
[train epoch 109] loss: 1.225, acc: 0.369: 100%|█| 366/366 [00:39<00:00,  9.18it
[valid epoch 109] loss: 1.785, acc: 0.449: 100%|█| 91/91 [00:05<00:00, 15.91it/s
Stage 3 (all-main) finished. Best acc: 0.4550
Progressive QAT completed. Best validation accuracy: 0.5464


D:\minicode\envs\d2l\python.exe D:\python\PycharmProjects\Quantized-Vision_Transformer\train.py 
7300 images were found in the dataset.
5845 images for training.
1455 images for validation.
Using 8 dataloader workers every process
_IncompatibleKeys(missing_keys=['head.weight', 'head.bias'], unexpected_keys=[])
==== Warmup FP32 Training (no quantization) ====
[train epoch 0] loss: 0.577, acc: 0.814: 100%|██████████| 366/366 [01:22<00:00,  4.43it/s]
[valid epoch 0] loss: 0.383, acc: 0.905: 100%|██████████| 91/91 [00:25<00:00,  3.59it/s]
[FP32 warmup] epoch 0: train_acc=0.8135, val_acc=0.9052
[train epoch 1] loss: 0.395, acc: 0.878: 100%|██████████| 366/366 [01:18<00:00,  4.67it/s]
[valid epoch 1] loss: 0.345, acc: 0.909: 100%|██████████| 91/91 [00:25<00:00,  3.58it/s]
[FP32 warmup] epoch 1: train_acc=0.8778, val_acc=0.9086
[train epoch 2] loss: 0.377, acc: 0.887: 100%|██████████| 366/366 [01:21<00:00,  4.47it/s]
[valid epoch 2] loss: 0.338, acc: 0.911: 100%|██████████| 91/91 [00:28<00:00,  3.25it/s]
[FP32 warmup] epoch 2: train_acc=0.8873, val_acc=0.9107

==== Sweep 0: head+MLP ====

=== QAT Stage 1 (8bit, head+MLP) ===
[train epoch 0] loss: 0.947, acc: 0.706: 100%|██████████| 366/366 [01:42<00:00,  3.55it/s]
[valid epoch 0] loss: 0.516, acc: 0.863: 100%|██████████| 91/91 [00:30<00:00,  2.96it/s]
Best model (head+MLP Stage 1) saved with accuracy: 0.8625
[train epoch 1] loss: 0.524, acc: 0.855: 100%|██████████| 366/366 [01:46<00:00,  3.44it/s]
[valid epoch 1] loss: 0.455, acc: 0.876: 100%|██████████| 91/91 [00:29<00:00,  3.04it/s]
Best model (head+MLP Stage 1) saved with accuracy: 0.8756
[train epoch 2] loss: 0.455, acc: 0.884: 100%|██████████| 366/366 [01:46<00:00,  3.43it/s]
[valid epoch 2] loss: 0.406, acc: 0.897: 100%|██████████| 91/91 [00:30<00:00,  2.99it/s]
Best model (head+MLP Stage 1) saved with accuracy: 0.8969
[train epoch 3] loss: 0.416, acc: 0.898: 100%|██████████| 366/366 [01:46<00:00,  3.44it/s]
[valid epoch 3] loss: 0.394, acc: 0.904: 100%|██████████| 91/91 [00:29<00:00,  3.04it/s]
Best model (head+MLP Stage 1) saved with accuracy: 0.9038
[train epoch 4] loss: 0.388, acc: 0.909: 100%|██████████| 366/366 [01:46<00:00,  3.43it/s]
[valid epoch 4] loss: 0.364, acc: 0.908: 100%|██████████| 91/91 [00:29<00:00,  3.04it/s]
Best model (head+MLP Stage 1) saved with accuracy: 0.9079
[train epoch 5] loss: 0.372, acc: 0.913: 100%|██████████| 366/366 [01:46<00:00,  3.43it/s]
[valid epoch 5] loss: 0.365, acc: 0.907: 100%|██████████| 91/91 [00:30<00:00,  3.02it/s]
Stage 1 (head+MLP) finished. Best acc: 0.9079

=== QAT Stage 2 (6bit, head+MLP) ===
[train epoch 6] loss: 0.396, acc: 0.902: 100%|██████████| 366/366 [01:46<00:00,  3.43it/s]
[valid epoch 6] loss: 0.369, acc: 0.899: 100%|██████████| 91/91 [00:29<00:00,  3.04it/s]
Best model (head+MLP Stage 2) saved with accuracy: 0.8990
[train epoch 7] loss: 0.396, acc: 0.907: 100%|██████████| 366/366 [01:46<00:00,  3.44it/s]
[valid epoch 7] loss: 0.368, acc: 0.912: 100%|██████████| 91/91 [00:30<00:00,  3.02it/s]
Best model (head+MLP Stage 2) saved with accuracy: 0.9120
[train epoch 8] loss: 0.372, acc: 0.915: 100%|██████████| 366/366 [01:46<00:00,  3.43it/s]
[valid epoch 8] loss: 0.371, acc: 0.909: 100%|██████████| 91/91 [00:30<00:00,  2.99it/s]
[train epoch 9] loss: 0.355, acc: 0.926: 100%|██████████| 366/366 [01:46<00:00,  3.44it/s]
[valid epoch 9] loss: 0.353, acc: 0.912: 100%|██████████| 91/91 [00:30<00:00,  2.96it/s]
[train epoch 10] loss: 0.355, acc: 0.923: 100%|██████████| 366/366 [01:47<00:00,  3.40it/s]
[valid epoch 10] loss: 0.346, acc: 0.916: 100%|██████████| 91/91 [00:30<00:00,  2.97it/s]
Best model (head+MLP Stage 2) saved with accuracy: 0.9162
[train epoch 11] loss: 0.353, acc: 0.924: 100%|██████████| 366/366 [01:47<00:00,  3.42it/s]
[valid epoch 11] loss: 0.344, acc: 0.914: 100%|██████████| 91/91 [00:30<00:00,  3.02it/s]
[train epoch 12] loss: 0.333, acc: 0.932: 100%|██████████| 366/366 [01:46<00:00,  3.43it/s]
[valid epoch 12] loss: 0.342, acc: 0.923: 100%|██████████| 91/91 [00:29<00:00,  3.05it/s]
Best model (head+MLP Stage 2) saved with accuracy: 0.9230
[train epoch 13] loss: 0.330, acc: 0.935: 100%|██████████| 366/366 [01:46<00:00,  3.44it/s]
[valid epoch 13] loss: 0.337, acc: 0.918: 100%|██████████| 91/91 [00:30<00:00,  3.01it/s]
[train epoch 14] loss: 0.320, acc: 0.938: 100%|██████████| 366/366 [01:46<00:00,  3.43it/s]
[valid epoch 14] loss: 0.334, acc: 0.920: 100%|██████████| 91/91 [00:29<00:00,  3.06it/s]
[train epoch 15] loss: 0.316, acc: 0.939: 100%|██████████| 366/366 [01:46<00:00,  3.44it/s]
[valid epoch 15] loss: 0.334, acc: 0.922: 100%|██████████| 91/91 [00:30<00:00,  3.03it/s]
Stage 2 (head+MLP) finished. Best acc: 0.9230

=== QAT Stage 3 (4bit, head+MLP) ===
[train epoch 16] loss: 0.607, acc: 0.829: 100%|██████████| 366/366 [01:47<00:00,  3.41it/s]
[valid epoch 16] loss: 0.532, acc: 0.858: 100%|██████████| 91/91 [00:29<00:00,  3.04it/s]
Best model (head+MLP Stage 3) saved with accuracy: 0.8584
[train epoch 17] loss: 0.512, acc: 0.863: 100%|██████████| 366/366 [01:46<00:00,  3.44it/s]
[valid epoch 17] loss: 0.478, acc: 0.877: 100%|██████████| 91/91 [00:30<00:00,  3.01it/s]
Best model (head+MLP Stage 3) saved with accuracy: 0.8770
[train epoch 18] loss: 0.477, acc: 0.875: 100%|██████████| 366/366 [01:47<00:00,  3.41it/s]
[valid epoch 18] loss: 0.447, acc: 0.893: 100%|██████████| 91/91 [00:30<00:00,  3.02it/s]
Best model (head+MLP Stage 3) saved with accuracy: 0.8928
[train epoch 19] loss: 0.443, acc: 0.892: 100%|██████████| 366/366 [01:46<00:00,  3.45it/s]
[valid epoch 19] loss: 0.464, acc: 0.889: 100%|██████████| 91/91 [00:30<00:00,  3.03it/s]
[train epoch 20] loss: 0.442, acc: 0.893: 100%|██████████| 366/366 [01:46<00:00,  3.44it/s]
[valid epoch 20] loss: 0.431, acc: 0.891: 100%|██████████| 91/91 [00:29<00:00,  3.03it/s]
[train epoch 21] loss: 0.419, acc: 0.901: 100%|██████████| 366/366 [01:46<00:00,  3.44it/s]
[valid epoch 21] loss: 0.436, acc: 0.892: 100%|██████████| 91/91 [00:29<00:00,  3.05it/s]
[train epoch 22] loss: 0.409, acc: 0.906: 100%|██████████| 366/366 [01:46<00:00,  3.44it/s]
[valid epoch 22] loss: 0.434, acc: 0.898: 100%|██████████| 91/91 [00:29<00:00,  3.04it/s]
Best model (head+MLP Stage 3) saved with accuracy: 0.8976
[train epoch 23] loss: 0.403, acc: 0.913: 100%|██████████| 366/366 [01:46<00:00,  3.45it/s]
[valid epoch 23] loss: 0.417, acc: 0.905: 100%|██████████| 91/91 [00:29<00:00,  3.06it/s]
Best model (head+MLP Stage 3) saved with accuracy: 0.9052
[train epoch 24] loss: 0.383, acc: 0.920: 100%|██████████| 366/366 [01:45<00:00,  3.46it/s]
[valid epoch 24] loss: 0.417, acc: 0.903: 100%|██████████| 91/91 [00:29<00:00,  3.05it/s]
[train epoch 25] loss: 0.384, acc: 0.921: 100%|██████████| 366/366 [01:46<00:00,  3.45it/s]
[valid epoch 25] loss: 0.416, acc: 0.903: 100%|██████████| 91/91 [00:29<00:00,  3.05it/s]
Stage 3 (head+MLP) finished. Best acc: 0.9052
Progressive QAT completed. Best validation accuracy: 0.9230

==== Sweep 1: head+MLP+last1Attn ====

=== QAT Stage 1 (8bit, head+MLP+last1Attn) ===
[train epoch 0] loss: 1.029, acc: 0.671: 100%|██████████| 366/366 [01:48<00:00,  3.38it/s]
[valid epoch 0] loss: 0.816, acc: 0.752: 100%|██████████| 91/91 [00:30<00:00,  2.97it/s]
Best model (head+MLP+last1Attn Stage 1) saved with accuracy: 0.7519
[train epoch 1] loss: 0.785, acc: 0.757: 100%|██████████| 366/366 [01:50<00:00,  3.32it/s]
[valid epoch 1] loss: 0.705, acc: 0.797: 100%|██████████| 91/91 [00:30<00:00,  3.01it/s]
Best model (head+MLP+last1Attn Stage 1) saved with accuracy: 0.7966
[train epoch 2] loss: 0.760, acc: 0.772: 100%|██████████| 366/366 [01:48<00:00,  3.39it/s]
[valid epoch 2] loss: 0.696, acc: 0.803: 100%|██████████| 91/91 [00:30<00:00,  3.01it/s]
Best model (head+MLP+last1Attn Stage 1) saved with accuracy: 0.8027
[train epoch 3] loss: 0.681, acc: 0.797: 100%|██████████| 366/366 [01:48<00:00,  3.38it/s]
[valid epoch 3] loss: 0.578, acc: 0.847: 100%|██████████| 91/91 [00:30<00:00,  2.99it/s]
Best model (head+MLP+last1Attn Stage 1) saved with accuracy: 0.8467
[train epoch 4] loss: 0.607, acc: 0.821: 100%|██████████| 366/366 [01:47<00:00,  3.39it/s]
[valid epoch 4] loss: 0.549, acc: 0.858: 100%|██████████| 91/91 [00:30<00:00,  3.02it/s]
Best model (head+MLP+last1Attn Stage 1) saved with accuracy: 0.8584
[train epoch 5] loss: 0.541, acc: 0.850: 100%|██████████| 366/366 [01:50<00:00,  3.32it/s]
[valid epoch 5] loss: 0.509, acc: 0.873: 100%|██████████| 91/91 [00:30<00:00,  2.96it/s]
Best model (head+MLP+last1Attn Stage 1) saved with accuracy: 0.8729
[train epoch 6] loss: 0.494, acc: 0.869: 100%|██████████| 366/366 [01:49<00:00,  3.34it/s]
[valid epoch 6] loss: 0.465, acc: 0.886: 100%|██████████| 91/91 [00:30<00:00,  2.98it/s]
Best model (head+MLP+last1Attn Stage 1) saved with accuracy: 0.8859
[train epoch 7] loss: 0.464, acc: 0.879: 100%|██████████| 366/366 [01:49<00:00,  3.33it/s]
[valid epoch 7] loss: 0.447, acc: 0.886: 100%|██████████| 91/91 [00:30<00:00,  2.98it/s]
[train epoch 8] loss: 0.434, acc: 0.887: 100%|██████████| 366/366 [01:49<00:00,  3.33it/s]
[valid epoch 8] loss: 0.435, acc: 0.891: 100%|██████████| 91/91 [00:30<00:00,  2.96it/s]
Best model (head+MLP+last1Attn Stage 1) saved with accuracy: 0.8907
[train epoch 9] loss: 0.430, acc: 0.890: 100%|██████████| 366/366 [01:49<00:00,  3.36it/s]
[valid epoch 9] loss: 0.428, acc: 0.889: 100%|██████████| 91/91 [00:30<00:00,  2.97it/s]
Stage 1 (head+MLP+last1Attn) finished. Best acc: 0.8907

=== QAT Stage 2 (6bit, head+MLP+last1Attn) ===
[train epoch 10] loss: 0.467, acc: 0.879: 100%|██████████| 366/366 [01:39<00:00,  3.67it/s]
[valid epoch 10] loss: 0.440, acc: 0.893: 100%|██████████| 91/91 [00:28<00:00,  3.24it/s]
Best model (head+MLP+last1Attn Stage 2) saved with accuracy: 0.8935
[train epoch 11] loss: 0.448, acc: 0.889: 100%|██████████| 366/366 [01:37<00:00,  3.74it/s]
[valid epoch 11] loss: 0.451, acc: 0.887: 100%|██████████| 91/91 [00:27<00:00,  3.27it/s]
[train epoch 12] loss: 0.446, acc: 0.887: 100%|██████████| 366/366 [01:37<00:00,  3.75it/s]
[valid epoch 12] loss: 0.439, acc: 0.891: 100%|██████████| 91/91 [00:27<00:00,  3.26it/s]
[train epoch 13] loss: 0.429, acc: 0.895: 100%|██████████| 366/366 [01:38<00:00,  3.73it/s]
[valid epoch 13] loss: 0.437, acc: 0.893: 100%|██████████| 91/91 [00:28<00:00,  3.16it/s]
[train epoch 14] loss: 0.418, acc: 0.899: 100%|██████████| 366/366 [01:39<00:00,  3.67it/s]
[valid epoch 14] loss: 0.418, acc: 0.902: 100%|██████████| 91/91 [00:28<00:00,  3.16it/s]
Best model (head+MLP+last1Attn Stage 2) saved with accuracy: 0.9024
[train epoch 15] loss: 0.409, acc: 0.904: 100%|██████████| 366/366 [01:38<00:00,  3.73it/s]
[valid epoch 15] loss: 0.410, acc: 0.902: 100%|██████████| 91/91 [00:28<00:00,  3.23it/s]
[train epoch 16] loss: 0.400, acc: 0.908: 100%|██████████| 366/366 [01:39<00:00,  3.69it/s]
[valid epoch 16] loss: 0.407, acc: 0.900: 100%|██████████| 91/91 [00:29<00:00,  3.08it/s]
[train epoch 17] loss: 0.391, acc: 0.912: 100%|██████████| 366/366 [01:43<00:00,  3.53it/s]
[valid epoch 17] loss: 0.404, acc: 0.903: 100%|██████████| 91/91 [00:29<00:00,  3.04it/s]
Best model (head+MLP+last1Attn Stage 2) saved with accuracy: 0.9031
[train epoch 18] loss: 0.390, acc: 0.910: 100%|██████████| 366/366 [01:41<00:00,  3.60it/s]
[valid epoch 18] loss: 0.402, acc: 0.902: 100%|██████████| 91/91 [00:29<00:00,  3.04it/s]
Stage 2 (head+MLP+last1Attn) finished. Best acc: 0.9031

=== QAT Stage 3 (4bit, head+MLP+last1Attn) ===
[train epoch 19] loss: 0.722, acc: 0.787: 100%|██████████| 366/366 [01:43<00:00,  3.53it/s]
[valid epoch 19] loss: 0.637, acc: 0.828: 100%|██████████| 91/91 [00:29<00:00,  3.08it/s]
Best model (head+MLP+last1Attn Stage 3) saved with accuracy: 0.8282
[train epoch 20] loss: 0.613, acc: 0.822: 100%|██████████| 366/366 [01:43<00:00,  3.54it/s]
[valid epoch 20] loss: 0.614, acc: 0.840: 100%|██████████| 91/91 [00:29<00:00,  3.14it/s]
Best model (head+MLP+last1Attn Stage 3) saved with accuracy: 0.8399
[train epoch 21] loss: 0.591, acc: 0.832: 100%|██████████| 366/366 [01:43<00:00,  3.55it/s]
[valid epoch 21] loss: 0.585, acc: 0.839: 100%|██████████| 91/91 [00:29<00:00,  3.06it/s]
[train epoch 22] loss: 0.557, acc: 0.846: 100%|██████████| 366/366 [01:40<00:00,  3.65it/s]
[valid epoch 22] loss: 0.566, acc: 0.856: 100%|██████████| 91/91 [00:28<00:00,  3.14it/s]
Best model (head+MLP+last1Attn Stage 3) saved with accuracy: 0.8564
[train epoch 23] loss: 0.542, acc: 0.852: 100%|██████████| 366/366 [01:40<00:00,  3.66it/s]
[valid epoch 23] loss: 0.544, acc: 0.858: 100%|██████████| 91/91 [00:28<00:00,  3.24it/s]
Best model (head+MLP+last1Attn Stage 3) saved with accuracy: 0.8577
[train epoch 24] loss: 0.534, acc: 0.852: 100%|██████████| 366/366 [01:38<00:00,  3.70it/s]
[valid epoch 24] loss: 0.524, acc: 0.861: 100%|██████████| 91/91 [00:28<00:00,  3.22it/s]
Best model (head+MLP+last1Attn Stage 3) saved with accuracy: 0.8612
[train epoch 25] loss: 0.508, acc: 0.861: 100%|██████████| 366/366 [01:37<00:00,  3.77it/s]
[valid epoch 25] loss: 0.521, acc: 0.865: 100%|██████████| 91/91 [00:28<00:00,  3.19it/s]
Best model (head+MLP+last1Attn Stage 3) saved with accuracy: 0.8653
[train epoch 26] loss: 0.490, acc: 0.872: 100%|██████████| 366/366 [01:37<00:00,  3.74it/s]
[valid epoch 26] loss: 0.514, acc: 0.862: 100%|██████████| 91/91 [00:27<00:00,  3.25it/s]
[train epoch 27] loss: 0.493, acc: 0.870: 100%|██████████| 366/366 [01:38<00:00,  3.72it/s]
[valid epoch 27] loss: 0.514, acc: 0.868: 100%|██████████| 91/91 [00:28<00:00,  3.23it/s]
Best model (head+MLP+last1Attn Stage 3) saved with accuracy: 0.8680
[train epoch 28] loss: 0.476, acc: 0.882: 100%|██████████| 366/366 [01:37<00:00,  3.74it/s]
[valid epoch 28] loss: 0.504, acc: 0.865: 100%|██████████| 91/91 [00:28<00:00,  3.15it/s]
[train epoch 29] loss: 0.460, acc: 0.883: 100%|██████████| 366/366 [01:37<00:00,  3.77it/s]
[valid epoch 29] loss: 0.500, acc: 0.867: 100%|██████████| 91/91 [00:28<00:00,  3.19it/s]
[train epoch 30] loss: 0.454, acc: 0.886: 100%|██████████| 366/366 [01:38<00:00,  3.72it/s]
[valid epoch 30] loss: 0.494, acc: 0.875: 100%|██████████| 91/91 [00:28<00:00,  3.24it/s]
Best model (head+MLP+last1Attn Stage 3) saved with accuracy: 0.8749
[train epoch 31] loss: 0.450, acc: 0.889: 100%|██████████| 366/366 [01:38<00:00,  3.72it/s]
[valid epoch 31] loss: 0.491, acc: 0.870: 100%|██████████| 91/91 [00:29<00:00,  3.12it/s]
[train epoch 32] loss: 0.452, acc: 0.886: 100%|██████████| 366/366 [01:38<00:00,  3.72it/s]
[valid epoch 32] loss: 0.490, acc: 0.869: 100%|██████████| 91/91 [00:28<00:00,  3.23it/s]
Stage 3 (head+MLP+last1Attn) finished. Best acc: 0.8749
Progressive QAT completed. Best validation accuracy: 0.9031

==== Sweep 2: head+MLP+last2Attn ====

=== QAT Stage 1 (8bit, head+MLP+last2Attn) ===
[train epoch 0] loss: 0.777, acc: 0.764: 100%|██████████| 366/366 [01:40<00:00,  3.64it/s]
[valid epoch 0] loss: 0.668, acc: 0.818: 100%|██████████| 91/91 [00:29<00:00,  3.11it/s]
Best model (head+MLP+last2Attn Stage 1) saved with accuracy: 0.8179
[train epoch 1] loss: 0.631, acc: 0.812: 100%|██████████| 366/366 [01:39<00:00,  3.66it/s]
[valid epoch 1] loss: 0.602, acc: 0.830: 100%|██████████| 91/91 [00:28<00:00,  3.16it/s]
Best model (head+MLP+last2Attn Stage 1) saved with accuracy: 0.8302
[train epoch 2] loss: 0.582, acc: 0.834: 100%|██████████| 366/366 [01:41<00:00,  3.62it/s]
[valid epoch 2] loss: 0.576, acc: 0.836: 100%|██████████| 91/91 [00:28<00:00,  3.16it/s]
Best model (head+MLP+last2Attn Stage 1) saved with accuracy: 0.8357
[train epoch 3] loss: 0.577, acc: 0.837: 100%|██████████| 366/366 [01:39<00:00,  3.67it/s]
[valid epoch 3] loss: 0.559, acc: 0.852: 100%|██████████| 91/91 [00:29<00:00,  3.12it/s]
Best model (head+MLP+last2Attn Stage 1) saved with accuracy: 0.8522
[train epoch 4] loss: 0.549, acc: 0.847: 100%|██████████| 366/366 [01:40<00:00,  3.63it/s]
[valid epoch 4] loss: 0.559, acc: 0.849: 100%|██████████| 91/91 [00:29<00:00,  3.13it/s]
[train epoch 5] loss: 0.503, acc: 0.864: 100%|██████████| 366/366 [01:40<00:00,  3.64it/s]
[valid epoch 5] loss: 0.541, acc: 0.849: 100%|██████████| 91/91 [00:29<00:00,  3.08it/s]
[train epoch 6] loss: 0.475, acc: 0.870: 100%|██████████| 366/366 [01:40<00:00,  3.64it/s]
[valid epoch 6] loss: 0.478, acc: 0.888: 100%|██████████| 91/91 [00:28<00:00,  3.19it/s]
Best model (head+MLP+last2Attn Stage 1) saved with accuracy: 0.8880
[train epoch 7] loss: 0.442, acc: 0.892: 100%|██████████| 366/366 [01:40<00:00,  3.65it/s]
[valid epoch 7] loss: 0.451, acc: 0.887: 100%|██████████| 91/91 [00:28<00:00,  3.14it/s]
[train epoch 8] loss: 0.436, acc: 0.895: 100%|██████████| 366/366 [01:41<00:00,  3.61it/s]
[valid epoch 8] loss: 0.434, acc: 0.890: 100%|██████████| 91/91 [00:29<00:00,  3.13it/s]
Best model (head+MLP+last2Attn Stage 1) saved with accuracy: 0.8900
[train epoch 9] loss: 0.415, acc: 0.896: 100%|██████████| 366/366 [01:40<00:00,  3.65it/s]
[valid epoch 9] loss: 0.430, acc: 0.895: 100%|██████████| 91/91 [00:28<00:00,  3.14it/s]
Best model (head+MLP+last2Attn Stage 1) saved with accuracy: 0.8948
Stage 1 (head+MLP+last2Attn) finished. Best acc: 0.8948

=== QAT Stage 2 (6bit, head+MLP+last2Attn) ===
[train epoch 10] loss: 0.445, acc: 0.885: 100%|██████████| 366/366 [01:39<00:00,  3.69it/s]
[valid epoch 10] loss: 0.452, acc: 0.893: 100%|██████████| 91/91 [00:29<00:00,  3.09it/s]
Best model (head+MLP+last2Attn Stage 2) saved with accuracy: 0.8935
[train epoch 11] loss: 0.431, acc: 0.892: 100%|██████████| 366/366 [01:40<00:00,  3.63it/s]
[valid epoch 11] loss: 0.448, acc: 0.887: 100%|██████████| 91/91 [00:30<00:00,  3.00it/s]
[train epoch 12] loss: 0.436, acc: 0.893: 100%|██████████| 366/366 [01:41<00:00,  3.62it/s]
[valid epoch 12] loss: 0.449, acc: 0.890: 100%|██████████| 91/91 [00:29<00:00,  3.07it/s]
[train epoch 13] loss: 0.425, acc: 0.896: 100%|██████████| 366/366 [01:43<00:00,  3.55it/s]
[valid epoch 13] loss: 0.451, acc: 0.889: 100%|██████████| 91/91 [00:29<00:00,  3.08it/s]
[train epoch 14] loss: 0.416, acc: 0.895: 100%|██████████| 366/366 [01:40<00:00,  3.64it/s]
[valid epoch 14] loss: 0.442, acc: 0.889: 100%|██████████| 91/91 [00:29<00:00,  3.11it/s]
[train epoch 15] loss: 0.414, acc: 0.898: 100%|██████████| 366/366 [01:40<00:00,  3.64it/s]
[valid epoch 15] loss: 0.432, acc: 0.890: 100%|██████████| 91/91 [00:29<00:00,  3.12it/s]
[train epoch 16] loss: 0.400, acc: 0.901: 100%|██████████| 366/366 [01:40<00:00,  3.64it/s]
[valid epoch 16] loss: 0.424, acc: 0.894: 100%|██████████| 91/91 [00:28<00:00,  3.15it/s]
Best model (head+MLP+last2Attn Stage 2) saved with accuracy: 0.8942
[train epoch 17] loss: 0.397, acc: 0.906: 100%|██████████| 366/366 [01:40<00:00,  3.65it/s]
[valid epoch 17] loss: 0.415, acc: 0.898: 100%|██████████| 91/91 [00:29<00:00,  3.10it/s]
Best model (head+MLP+last2Attn Stage 2) saved with accuracy: 0.8976
[train epoch 18] loss: 0.378, acc: 0.912: 100%|██████████| 366/366 [01:40<00:00,  3.63it/s]
[valid epoch 18] loss: 0.417, acc: 0.892: 100%|██████████| 91/91 [00:29<00:00,  3.13it/s]
[train epoch 19] loss: 0.380, acc: 0.907: 100%|██████████| 366/366 [01:40<00:00,  3.65it/s]
[valid epoch 19] loss: 0.418, acc: 0.895: 100%|██████████| 91/91 [00:30<00:00,  3.01it/s]
[train epoch 20] loss: 0.381, acc: 0.913: 100%|██████████| 366/366 [01:43<00:00,  3.54it/s]
[valid epoch 20] loss: 0.416, acc: 0.898: 100%|██████████| 91/91 [00:29<00:00,  3.08it/s]
Best model (head+MLP+last2Attn Stage 2) saved with accuracy: 0.8983
[train epoch 21] loss: 0.371, acc: 0.918: 100%|██████████| 366/366 [01:42<00:00,  3.59it/s]
[valid epoch 21] loss: 0.414, acc: 0.897: 100%|██████████| 91/91 [00:29<00:00,  3.08it/s]
Stage 2 (head+MLP+last2Attn) finished. Best acc: 0.8983

=== QAT Stage 3 (4bit, head+MLP+last2Attn) ===
[train epoch 22] loss: 0.722, acc: 0.782: 100%|██████████| 366/366 [01:42<00:00,  3.58it/s]
[valid epoch 22] loss: 0.666, acc: 0.819: 100%|██████████| 91/91 [00:29<00:00,  3.11it/s]
Best model (head+MLP+last2Attn Stage 3) saved with accuracy: 0.8186
[train epoch 23] loss: 0.639, acc: 0.807: 100%|██████████| 366/366 [01:43<00:00,  3.54it/s]
[valid epoch 23] loss: 0.597, acc: 0.832: 100%|██████████| 91/91 [00:29<00:00,  3.05it/s]
Best model (head+MLP+last2Attn Stage 3) saved with accuracy: 0.8316
[train epoch 24] loss: 0.581, acc: 0.833: 100%|██████████| 366/366 [01:40<00:00,  3.63it/s]
[valid epoch 24] loss: 0.586, acc: 0.843: 100%|██████████| 91/91 [00:29<00:00,  3.12it/s]
Best model (head+MLP+last2Attn Stage 3) saved with accuracy: 0.8426
[train epoch 25] loss: 0.559, acc: 0.845: 100%|██████████| 366/366 [01:42<00:00,  3.59it/s]
[valid epoch 25] loss: 0.568, acc: 0.852: 100%|██████████| 91/91 [00:29<00:00,  3.10it/s]
Best model (head+MLP+last2Attn Stage 3) saved with accuracy: 0.8522
[train epoch 26] loss: 0.564, acc: 0.839: 100%|██████████| 366/366 [01:43<00:00,  3.55it/s]
[valid epoch 26] loss: 0.559, acc: 0.852: 100%|██████████| 91/91 [00:29<00:00,  3.06it/s]
[train epoch 27] loss: 0.514, acc: 0.863: 100%|██████████| 366/366 [01:41<00:00,  3.61it/s]
[valid epoch 27] loss: 0.531, acc: 0.860: 100%|██████████| 91/91 [00:29<00:00,  3.08it/s]
Best model (head+MLP+last2Attn Stage 3) saved with accuracy: 0.8598
[train epoch 28] loss: 0.504, acc: 0.864: 100%|██████████| 366/366 [01:41<00:00,  3.60it/s]
[valid epoch 28] loss: 0.529, acc: 0.866: 100%|██████████| 91/91 [00:29<00:00,  3.12it/s]
Best model (head+MLP+last2Attn Stage 3) saved with accuracy: 0.8660
[train epoch 29] loss: 0.506, acc: 0.863: 100%|██████████| 366/366 [01:40<00:00,  3.63it/s]
[valid epoch 29] loss: 0.531, acc: 0.856: 100%|██████████| 91/91 [00:29<00:00,  3.06it/s]
[train epoch 30] loss: 0.483, acc: 0.872: 100%|██████████| 366/366 [01:43<00:00,  3.55it/s]
[valid epoch 30] loss: 0.526, acc: 0.868: 100%|██████████| 91/91 [00:29<00:00,  3.08it/s]
Best model (head+MLP+last2Attn Stage 3) saved with accuracy: 0.8680
[train epoch 31] loss: 0.476, acc: 0.881: 100%|██████████| 366/366 [01:41<00:00,  3.61it/s]
[valid epoch 31] loss: 0.519, acc: 0.864: 100%|██████████| 91/91 [00:29<00:00,  3.07it/s]
[train epoch 32] loss: 0.459, acc: 0.881: 100%|██████████| 366/366 [01:42<00:00,  3.57it/s]
[valid epoch 32] loss: 0.515, acc: 0.865: 100%|██████████| 91/91 [00:29<00:00,  3.05it/s]
[train epoch 33] loss: 0.459, acc: 0.884: 100%|██████████| 366/366 [01:44<00:00,  3.51it/s]
[valid epoch 33] loss: 0.512, acc: 0.867: 100%|██████████| 91/91 [00:29<00:00,  3.06it/s]
Stage 3 (head+MLP+last2Attn) finished. Best acc: 0.8680
Progressive QAT completed. Best validation accuracy: 0.8983

==== Sweep 3: head+MLP+last3Attn ====

=== QAT Stage 1 (8bit, head+MLP+last3Attn) ===
[train epoch 0] loss: 0.900, acc: 0.721: 100%|██████████| 366/366 [01:44<00:00,  3.51it/s]
[valid epoch 0] loss: 0.827, acc: 0.755: 100%|██████████| 91/91 [00:29<00:00,  3.06it/s]
Best model (head+MLP+last3Attn Stage 1) saved with accuracy: 0.7553
[train epoch 1] loss: 0.789, acc: 0.764: 100%|██████████| 366/366 [01:45<00:00,  3.46it/s]
[valid epoch 1] loss: 0.707, acc: 0.792: 100%|██████████| 91/91 [00:29<00:00,  3.08it/s]
Best model (head+MLP+last3Attn Stage 1) saved with accuracy: 0.7918
[train epoch 2] loss: 0.752, acc: 0.766: 100%|██████████| 366/366 [01:42<00:00,  3.59it/s]
[valid epoch 2] loss: 0.700, acc: 0.793: 100%|██████████| 91/91 [00:29<00:00,  3.06it/s]
Best model (head+MLP+last3Attn Stage 1) saved with accuracy: 0.7931
[train epoch 3] loss: 0.718, acc: 0.772: 100%|██████████| 366/366 [01:41<00:00,  3.59it/s]
[valid epoch 3] loss: 0.774, acc: 0.773: 100%|██████████| 91/91 [00:30<00:00,  3.02it/s]
[train epoch 4] loss: 0.665, acc: 0.800: 100%|██████████| 366/366 [01:41<00:00,  3.60it/s]
[valid epoch 4] loss: 0.638, acc: 0.820: 100%|██████████| 91/91 [00:29<00:00,  3.06it/s]
Best model (head+MLP+last3Attn Stage 1) saved with accuracy: 0.8199
[train epoch 5] loss: 0.633, acc: 0.804: 100%|██████████| 366/366 [01:42<00:00,  3.59it/s]
[valid epoch 5] loss: 0.609, acc: 0.824: 100%|██████████| 91/91 [00:30<00:00,  3.03it/s]
Best model (head+MLP+last3Attn Stage 1) saved with accuracy: 0.8241
[train epoch 6] loss: 0.595, acc: 0.818: 100%|██████████| 366/366 [01:45<00:00,  3.47it/s]
[valid epoch 6] loss: 0.619, acc: 0.821: 100%|██████████| 91/91 [00:31<00:00,  2.94it/s]
[train epoch 7] loss: 0.553, acc: 0.836: 100%|██████████| 366/366 [01:43<00:00,  3.53it/s]
[valid epoch 7] loss: 0.526, acc: 0.847: 100%|██████████| 91/91 [00:30<00:00,  2.99it/s]
Best model (head+MLP+last3Attn Stage 1) saved with accuracy: 0.8474
[train epoch 8] loss: 0.494, acc: 0.859: 100%|██████████| 366/366 [01:45<00:00,  3.45it/s]
[valid epoch 8] loss: 0.507, acc: 0.854: 100%|██████████| 91/91 [00:31<00:00,  2.88it/s]
Best model (head+MLP+last3Attn Stage 1) saved with accuracy: 0.8543
[train epoch 9] loss: 0.462, acc: 0.876: 100%|██████████| 366/366 [01:44<00:00,  3.52it/s]
[valid epoch 9] loss: 0.470, acc: 0.874: 100%|██████████| 91/91 [00:29<00:00,  3.09it/s]
Best model (head+MLP+last3Attn Stage 1) saved with accuracy: 0.8742
[train epoch 10] loss: 0.454, acc: 0.877: 100%|██████████| 366/366 [01:42<00:00,  3.58it/s]
[valid epoch 10] loss: 0.469, acc: 0.880: 100%|██████████| 91/91 [00:29<00:00,  3.07it/s]
Best model (head+MLP+last3Attn Stage 1) saved with accuracy: 0.8797
[train epoch 11] loss: 0.437, acc: 0.886: 100%|██████████| 366/366 [01:44<00:00,  3.50it/s]
[valid epoch 11] loss: 0.455, acc: 0.885: 100%|██████████| 91/91 [00:29<00:00,  3.03it/s]
Best model (head+MLP+last3Attn Stage 1) saved with accuracy: 0.8852
Stage 1 (head+MLP+last3Attn) finished. Best acc: 0.8852

=== QAT Stage 2 (6bit, head+MLP+last3Attn) ===
[train epoch 12] loss: 0.449, acc: 0.882: 100%|██████████| 366/366 [01:45<00:00,  3.48it/s]
[valid epoch 12] loss: 0.466, acc: 0.878: 100%|██████████| 91/91 [00:30<00:00,  2.97it/s]
Best model (head+MLP+last3Attn Stage 2) saved with accuracy: 0.8777
[train epoch 13] loss: 0.446, acc: 0.882: 100%|██████████| 366/366 [01:45<00:00,  3.47it/s]
[valid epoch 13] loss: 0.453, acc: 0.879: 100%|██████████| 91/91 [00:30<00:00,  3.03it/s]
Best model (head+MLP+last3Attn Stage 2) saved with accuracy: 0.8790
[train epoch 14] loss: 0.440, acc: 0.882: 100%|██████████| 366/366 [01:43<00:00,  3.55it/s]
[valid epoch 14] loss: 0.460, acc: 0.877: 100%|██████████| 91/91 [00:30<00:00,  2.96it/s]
[train epoch 15] loss: 0.430, acc: 0.886: 100%|██████████| 366/366 [01:43<00:00,  3.52it/s]
[valid epoch 15] loss: 0.456, acc: 0.883: 100%|██████████| 91/91 [00:29<00:00,  3.06it/s]
Best model (head+MLP+last3Attn Stage 2) saved with accuracy: 0.8832
[train epoch 16] loss: 0.434, acc: 0.888: 100%|██████████| 366/366 [01:44<00:00,  3.51it/s]
[valid epoch 16] loss: 0.456, acc: 0.881: 100%|██████████| 91/91 [00:30<00:00,  2.96it/s]
[train epoch 17] loss: 0.416, acc: 0.894: 100%|██████████| 366/366 [01:42<00:00,  3.58it/s]
[valid epoch 17] loss: 0.451, acc: 0.876: 100%|██████████| 91/91 [00:29<00:00,  3.09it/s]
[train epoch 18] loss: 0.416, acc: 0.892: 100%|██████████| 366/366 [01:43<00:00,  3.53it/s]
[valid epoch 18] loss: 0.441, acc: 0.885: 100%|██████████| 91/91 [00:29<00:00,  3.08it/s]
Best model (head+MLP+last3Attn Stage 2) saved with accuracy: 0.8845
[train epoch 19] loss: 0.406, acc: 0.897: 100%|██████████| 366/366 [01:45<00:00,  3.47it/s]
[valid epoch 19] loss: 0.440, acc: 0.878: 100%|██████████| 91/91 [00:29<00:00,  3.10it/s]
[train epoch 20] loss: 0.395, acc: 0.904: 100%|██████████| 366/366 [01:42<00:00,  3.57it/s]
[valid epoch 20] loss: 0.438, acc: 0.884: 100%|██████████| 91/91 [00:29<00:00,  3.07it/s]
[train epoch 21] loss: 0.393, acc: 0.901: 100%|██████████| 366/366 [01:41<00:00,  3.62it/s]
[valid epoch 21] loss: 0.436, acc: 0.888: 100%|██████████| 91/91 [00:29<00:00,  3.10it/s]
Best model (head+MLP+last3Attn Stage 2) saved with accuracy: 0.8880
[train epoch 22] loss: 0.390, acc: 0.907: 100%|██████████| 366/366 [01:41<00:00,  3.62it/s]
[valid epoch 22] loss: 0.435, acc: 0.885: 100%|██████████| 91/91 [00:29<00:00,  3.10it/s]
[train epoch 23] loss: 0.391, acc: 0.899: 100%|██████████| 366/366 [01:41<00:00,  3.59it/s]
[valid epoch 23] loss: 0.429, acc: 0.886: 100%|██████████| 91/91 [00:29<00:00,  3.09it/s]
[train epoch 24] loss: 0.390, acc: 0.908: 100%|██████████| 366/366 [01:42<00:00,  3.55it/s]
[valid epoch 24] loss: 0.423, acc: 0.889: 100%|██████████| 91/91 [00:30<00:00,  3.03it/s]
Best model (head+MLP+last3Attn Stage 2) saved with accuracy: 0.8893
[train epoch 25] loss: 0.374, acc: 0.912: 100%|██████████| 366/366 [01:42<00:00,  3.56it/s]
[valid epoch 25] loss: 0.422, acc: 0.891: 100%|██████████| 91/91 [00:29<00:00,  3.06it/s]
Best model (head+MLP+last3Attn Stage 2) saved with accuracy: 0.8907
[train epoch 26] loss: 0.379, acc: 0.912: 100%|██████████| 366/366 [01:43<00:00,  3.54it/s]
[valid epoch 26] loss: 0.421, acc: 0.890: 100%|██████████| 91/91 [00:30<00:00,  3.02it/s]
[train epoch 27] loss: 0.381, acc: 0.908: 100%|██████████| 366/366 [01:43<00:00,  3.55it/s]
[valid epoch 27] loss: 0.420, acc: 0.893: 100%|██████████| 91/91 [00:29<00:00,  3.09it/s]
Best model (head+MLP+last3Attn Stage 2) saved with accuracy: 0.8928
Stage 2 (head+MLP+last3Attn) finished. Best acc: 0.8928

=== QAT Stage 3 (4bit, head+MLP+last3Attn) ===
[train epoch 28] loss: 0.763, acc: 0.762: 100%|██████████| 366/366 [01:41<00:00,  3.62it/s]
[valid epoch 28] loss: 0.660, acc: 0.810: 100%|██████████| 91/91 [00:29<00:00,  3.11it/s]
Best model (head+MLP+last3Attn Stage 3) saved with accuracy: 0.8103
[train epoch 29] loss: 0.633, acc: 0.809: 100%|██████████| 366/366 [01:42<00:00,  3.56it/s]
[valid epoch 29] loss: 0.629, acc: 0.827: 100%|██████████| 91/91 [00:29<00:00,  3.09it/s]
Best model (head+MLP+last3Attn Stage 3) saved with accuracy: 0.8268
[train epoch 30] loss: 0.627, acc: 0.810: 100%|██████████| 366/366 [01:43<00:00,  3.53it/s]
[valid epoch 30] loss: 0.600, acc: 0.840: 100%|██████████| 91/91 [00:30<00:00,  2.96it/s]
Best model (head+MLP+last3Attn Stage 3) saved with accuracy: 0.8399
[train epoch 31] loss: 0.578, acc: 0.830: 100%|██████████| 366/366 [01:44<00:00,  3.51it/s]
[valid epoch 31] loss: 0.603, acc: 0.830: 100%|██████████| 91/91 [00:30<00:00,  3.00it/s]
[train epoch 32] loss: 0.571, acc: 0.833: 100%|██████████| 366/366 [01:41<00:00,  3.59it/s]
[valid epoch 32] loss: 0.576, acc: 0.847: 100%|██████████| 91/91 [00:29<00:00,  3.07it/s]
Best model (head+MLP+last3Attn Stage 3) saved with accuracy: 0.8467
[train epoch 33] loss: 0.540, acc: 0.842: 100%|██████████| 366/366 [01:43<00:00,  3.53it/s]
[valid epoch 33] loss: 0.560, acc: 0.855: 100%|██████████| 91/91 [00:29<00:00,  3.04it/s]
Best model (head+MLP+last3Attn Stage 3) saved with accuracy: 0.8550
[train epoch 34] loss: 0.528, acc: 0.847: 100%|██████████| 366/366 [01:44<00:00,  3.50it/s]
[valid epoch 34] loss: 0.550, acc: 0.850: 100%|██████████| 91/91 [00:31<00:00,  2.91it/s]
[train epoch 35] loss: 0.511, acc: 0.855: 100%|██████████| 366/366 [01:44<00:00,  3.49it/s]
[valid epoch 35] loss: 0.545, acc: 0.854: 100%|██████████| 91/91 [00:29<00:00,  3.05it/s]
[train epoch 36] loss: 0.501, acc: 0.863: 100%|██████████| 366/366 [01:45<00:00,  3.46it/s]
[valid epoch 36] loss: 0.527, acc: 0.863: 100%|██████████| 91/91 [00:29<00:00,  3.05it/s]
Best model (head+MLP+last3Attn Stage 3) saved with accuracy: 0.8632
[train epoch 37] loss: 0.482, acc: 0.871: 100%|██████████| 366/366 [01:45<00:00,  3.48it/s]
[valid epoch 37] loss: 0.522, acc: 0.863: 100%|██████████| 91/91 [00:29<00:00,  3.10it/s]
[train epoch 38] loss: 0.480, acc: 0.865: 100%|██████████| 366/366 [01:41<00:00,  3.60it/s]
[valid epoch 38] loss: 0.519, acc: 0.860: 100%|██████████| 91/91 [00:29<00:00,  3.08it/s]
[train epoch 39] loss: 0.480, acc: 0.870: 100%|██████████| 366/366 [01:41<00:00,  3.60it/s]
[valid epoch 39] loss: 0.513, acc: 0.857: 100%|██████████| 91/91 [00:29<00:00,  3.08it/s]
[train epoch 40] loss: 0.465, acc: 0.876: 100%|██████████| 366/366 [01:41<00:00,  3.60it/s]
[valid epoch 40] loss: 0.511, acc: 0.857: 100%|██████████| 91/91 [00:29<00:00,  3.07it/s]
[train epoch 41] loss: 0.448, acc: 0.885: 100%|██████████| 366/366 [01:41<00:00,  3.60it/s]
[valid epoch 41] loss: 0.510, acc: 0.856: 100%|██████████| 91/91 [00:30<00:00,  2.99it/s]
Stage 3 (head+MLP+last3Attn) finished. Best acc: 0.8632
Progressive QAT completed. Best validation accuracy: 0.8928

==== Sweep 4: head+MLP+last4Attn ====

=== QAT Stage 1 (8bit, head+MLP+last4Attn) ===
[train epoch 0] loss: 0.825, acc: 0.739: 100%|██████████| 366/366 [01:44<00:00,  3.49it/s]
[valid epoch 0] loss: 0.697, acc: 0.807: 100%|██████████| 91/91 [00:29<00:00,  3.06it/s]
Best model (head+MLP+last4Attn Stage 1) saved with accuracy: 0.8069
[train epoch 1] loss: 0.727, acc: 0.767: 100%|██████████| 366/366 [01:42<00:00,  3.57it/s]
[valid epoch 1] loss: 0.724, acc: 0.794: 100%|██████████| 91/91 [00:29<00:00,  3.06it/s]
[train epoch 2] loss: 0.684, acc: 0.780: 100%|██████████| 366/366 [01:42<00:00,  3.58it/s]
[valid epoch 2] loss: 0.685, acc: 0.802: 100%|██████████| 91/91 [00:29<00:00,  3.06it/s]
[train epoch 3] loss: 0.654, acc: 0.796: 100%|██████████| 366/366 [01:43<00:00,  3.55it/s]
[valid epoch 3] loss: 0.666, acc: 0.793: 100%|██████████| 91/91 [00:29<00:00,  3.06it/s]
[train epoch 4] loss: 0.627, acc: 0.803: 100%|██████████| 366/366 [01:42<00:00,  3.57it/s]
[valid epoch 4] loss: 0.651, acc: 0.816: 100%|██████████| 91/91 [00:29<00:00,  3.07it/s]
Best model (head+MLP+last4Attn Stage 1) saved with accuracy: 0.8165
[train epoch 5] loss: 0.575, acc: 0.825: 100%|██████████| 366/366 [01:42<00:00,  3.57it/s]
[valid epoch 5] loss: 0.578, acc: 0.840: 100%|██████████| 91/91 [00:30<00:00,  3.02it/s]
Best model (head+MLP+last4Attn Stage 1) saved with accuracy: 0.8399
[train epoch 6] loss: 0.552, acc: 0.833: 100%|██████████| 366/366 [01:42<00:00,  3.57it/s]
[valid epoch 6] loss: 0.600, acc: 0.833: 100%|██████████| 91/91 [00:29<00:00,  3.07it/s]
[train epoch 7] loss: 0.527, acc: 0.846: 100%|██████████| 366/366 [01:42<00:00,  3.56it/s]
[valid epoch 7] loss: 0.546, acc: 0.843: 100%|██████████| 91/91 [00:29<00:00,  3.07it/s]
Best model (head+MLP+last4Attn Stage 1) saved with accuracy: 0.8426
[train epoch 8] loss: 0.479, acc: 0.863: 100%|██████████| 366/366 [01:42<00:00,  3.57it/s]
[valid epoch 8] loss: 0.524, acc: 0.860: 100%|██████████| 91/91 [00:29<00:00,  3.05it/s]
Best model (head+MLP+last4Attn Stage 1) saved with accuracy: 0.8598
[train epoch 9] loss: 0.463, acc: 0.871: 100%|██████████| 366/366 [01:43<00:00,  3.55it/s]
[valid epoch 9] loss: 0.516, acc: 0.858: 100%|██████████| 91/91 [00:29<00:00,  3.07it/s]
[train epoch 10] loss: 0.456, acc: 0.874: 100%|██████████| 366/366 [01:44<00:00,  3.51it/s]
[valid epoch 10] loss: 0.505, acc: 0.856: 100%|██████████| 91/91 [00:29<00:00,  3.08it/s]
[train epoch 11] loss: 0.442, acc: 0.877: 100%|██████████| 366/366 [01:40<00:00,  3.64it/s]
[valid epoch 11] loss: 0.498, acc: 0.860: 100%|██████████| 91/91 [00:29<00:00,  3.10it/s]
Stage 1 (head+MLP+last4Attn) finished. Best acc: 0.8598

=== QAT Stage 2 (6bit, head+MLP+last4Attn) ===
[train epoch 12] loss: 0.488, acc: 0.863: 100%|██████████| 366/366 [01:40<00:00,  3.64it/s]
[valid epoch 12] loss: 0.535, acc: 0.852: 100%|██████████| 91/91 [00:29<00:00,  3.07it/s]
Best model (head+MLP+last4Attn Stage 2) saved with accuracy: 0.8515
[train epoch 13] loss: 0.481, acc: 0.865: 100%|██████████| 366/366 [01:40<00:00,  3.64it/s]
[valid epoch 13] loss: 0.510, acc: 0.863: 100%|██████████| 91/91 [00:29<00:00,  3.10it/s]
Best model (head+MLP+last4Attn Stage 2) saved with accuracy: 0.8625
[train epoch 14] loss: 0.463, acc: 0.873: 100%|██████████| 366/366 [01:40<00:00,  3.63it/s]
[valid epoch 14] loss: 0.536, acc: 0.850: 100%|██████████| 91/91 [00:29<00:00,  3.10it/s]
[train epoch 15] loss: 0.470, acc: 0.869: 100%|██████████| 366/366 [01:40<00:00,  3.64it/s]
[valid epoch 15] loss: 0.504, acc: 0.852: 100%|██████████| 91/91 [00:29<00:00,  3.09it/s]
[train epoch 16] loss: 0.445, acc: 0.881: 100%|██████████| 366/366 [01:40<00:00,  3.64it/s]
[valid epoch 16] loss: 0.505, acc: 0.859: 100%|██████████| 91/91 [00:29<00:00,  3.09it/s]
[train epoch 17] loss: 0.456, acc: 0.874: 100%|██████████| 366/366 [01:40<00:00,  3.64it/s]
[valid epoch 17] loss: 0.508, acc: 0.859: 100%|██████████| 91/91 [00:29<00:00,  3.09it/s]
[train epoch 18] loss: 0.436, acc: 0.881: 100%|██████████| 366/366 [01:40<00:00,  3.64it/s]
[valid epoch 18] loss: 0.501, acc: 0.859: 100%|██████████| 91/91 [00:29<00:00,  3.09it/s]
[train epoch 19] loss: 0.425, acc: 0.884: 100%|██████████| 366/366 [01:40<00:00,  3.64it/s]
[valid epoch 19] loss: 0.491, acc: 0.868: 100%|██████████| 91/91 [00:29<00:00,  3.11it/s]
Best model (head+MLP+last4Attn Stage 2) saved with accuracy: 0.8680
[train epoch 20] loss: 0.409, acc: 0.896: 100%|██████████| 366/366 [01:40<00:00,  3.64it/s]
[valid epoch 20] loss: 0.480, acc: 0.867: 100%|██████████| 91/91 [00:29<00:00,  3.10it/s]
[train epoch 21] loss: 0.405, acc: 0.897: 100%|██████████| 366/366 [01:40<00:00,  3.64it/s]
[valid epoch 21] loss: 0.481, acc: 0.871: 100%|██████████| 91/91 [00:29<00:00,  3.09it/s]
Best model (head+MLP+last4Attn Stage 2) saved with accuracy: 0.8715
[train epoch 22] loss: 0.405, acc: 0.898: 100%|██████████| 366/366 [01:40<00:00,  3.64it/s]
[valid epoch 22] loss: 0.481, acc: 0.872: 100%|██████████| 91/91 [00:29<00:00,  3.10it/s]
Best model (head+MLP+last4Attn Stage 2) saved with accuracy: 0.8722
[train epoch 23] loss: 0.403, acc: 0.900: 100%|██████████| 366/366 [01:40<00:00,  3.64it/s]
[valid epoch 23] loss: 0.470, acc: 0.870: 100%|██████████| 91/91 [00:29<00:00,  3.10it/s]
[train epoch 24] loss: 0.392, acc: 0.901: 100%|██████████| 366/366 [01:40<00:00,  3.64it/s]
[valid epoch 24] loss: 0.469, acc: 0.872: 100%|██████████| 91/91 [00:29<00:00,  3.10it/s]
[train epoch 25] loss: 0.386, acc: 0.907: 100%|██████████| 366/366 [01:40<00:00,  3.64it/s]
[valid epoch 25] loss: 0.466, acc: 0.871: 100%|██████████| 91/91 [00:29<00:00,  3.11it/s]
[train epoch 26] loss: 0.381, acc: 0.906: 100%|██████████| 366/366 [01:40<00:00,  3.64it/s]
[valid epoch 26] loss: 0.465, acc: 0.870: 100%|██████████| 91/91 [00:29<00:00,  3.10it/s]
[train epoch 27] loss: 0.378, acc: 0.910: 100%|██████████| 366/366 [01:40<00:00,  3.64it/s]
[valid epoch 27] loss: 0.464, acc: 0.871: 100%|██████████| 91/91 [00:29<00:00,  3.09it/s]
Stage 2 (head+MLP+last4Attn) finished. Best acc: 0.8722

=== QAT Stage 3 (4bit, head+MLP+last4Attn) ===
[train epoch 28] loss: 0.844, acc: 0.728: 100%|██████████| 366/366 [01:40<00:00,  3.64it/s]
[valid epoch 28] loss: 0.745, acc: 0.788: 100%|██████████| 91/91 [00:29<00:00,  3.08it/s]
Best model (head+MLP+last4Attn Stage 3) saved with accuracy: 0.7876
[train epoch 29] loss: 0.684, acc: 0.785: 100%|██████████| 366/366 [01:40<00:00,  3.64it/s]
[valid epoch 29] loss: 0.724, acc: 0.793: 100%|██████████| 91/91 [00:29<00:00,  3.09it/s]
Best model (head+MLP+last4Attn Stage 3) saved with accuracy: 0.7931
[train epoch 30] loss: 0.656, acc: 0.797: 100%|██████████| 366/366 [01:40<00:00,  3.64it/s]
[valid epoch 30] loss: 0.664, acc: 0.816: 100%|██████████| 91/91 [00:29<00:00,  3.09it/s]
Best model (head+MLP+last4Attn Stage 3) saved with accuracy: 0.8158
[train epoch 31] loss: 0.610, acc: 0.813: 100%|██████████| 366/366 [01:40<00:00,  3.64it/s]
[valid epoch 31] loss: 0.662, acc: 0.805: 100%|██████████| 91/91 [00:29<00:00,  3.08it/s]
[train epoch 32] loss: 0.608, acc: 0.812: 100%|██████████| 366/366 [01:40<00:00,  3.64it/s]
[valid epoch 32] loss: 0.629, acc: 0.817: 100%|██████████| 91/91 [00:29<00:00,  3.10it/s]
Best model (head+MLP+last4Attn Stage 3) saved with accuracy: 0.8172
[train epoch 33] loss: 0.572, acc: 0.828: 100%|██████████| 366/366 [01:40<00:00,  3.64it/s]
[valid epoch 33] loss: 0.628, acc: 0.827: 100%|██████████| 91/91 [00:29<00:00,  3.09it/s]
Best model (head+MLP+last4Attn Stage 3) saved with accuracy: 0.8268
[train epoch 34] loss: 0.564, acc: 0.834: 100%|██████████| 366/366 [01:40<00:00,  3.64it/s]
[valid epoch 34] loss: 0.612, acc: 0.825: 100%|██████████| 91/91 [00:29<00:00,  3.09it/s]
[train epoch 35] loss: 0.554, acc: 0.835: 100%|██████████| 366/366 [01:40<00:00,  3.64it/s]
[valid epoch 35] loss: 0.606, acc: 0.833: 100%|██████████| 91/91 [00:29<00:00,  3.09it/s]
Best model (head+MLP+last4Attn Stage 3) saved with accuracy: 0.8330
[train epoch 36] loss: 0.535, acc: 0.845: 100%|██████████| 366/366 [01:40<00:00,  3.64it/s]
[valid epoch 36] loss: 0.579, acc: 0.840: 100%|██████████| 91/91 [00:29<00:00,  3.09it/s]
Best model (head+MLP+last4Attn Stage 3) saved with accuracy: 0.8399
[train epoch 37] loss: 0.520, acc: 0.849: 100%|██████████| 366/366 [01:40<00:00,  3.63it/s]
[valid epoch 37] loss: 0.573, acc: 0.841: 100%|██████████| 91/91 [00:29<00:00,  3.10it/s]
Best model (head+MLP+last4Attn Stage 3) saved with accuracy: 0.8412
[train epoch 38] loss: 0.503, acc: 0.859: 100%|██████████| 366/366 [01:40<00:00,  3.64it/s]
[valid epoch 38] loss: 0.566, acc: 0.850: 100%|██████████| 91/91 [00:29<00:00,  3.10it/s]
Best model (head+MLP+last4Attn Stage 3) saved with accuracy: 0.8502
[train epoch 39] loss: 0.497, acc: 0.856: 100%|██████████| 366/366 [01:40<00:00,  3.64it/s]
[valid epoch 39] loss: 0.562, acc: 0.847: 100%|██████████| 91/91 [00:29<00:00,  3.10it/s]
[train epoch 40] loss: 0.480, acc: 0.870: 100%|██████████| 366/366 [01:40<00:00,  3.64it/s]
[valid epoch 40] loss: 0.556, acc: 0.845: 100%|██████████| 91/91 [00:29<00:00,  3.09it/s]
[train epoch 41] loss: 0.473, acc: 0.871: 100%|██████████| 366/366 [01:40<00:00,  3.64it/s]
[valid epoch 41] loss: 0.553, acc: 0.854: 100%|██████████| 91/91 [00:29<00:00,  3.09it/s]
Best model (head+MLP+last4Attn Stage 3) saved with accuracy: 0.8536
[train epoch 42] loss: 0.463, acc: 0.874: 100%|██████████| 366/366 [01:40<00:00,  3.64it/s]
[valid epoch 42] loss: 0.555, acc: 0.845: 100%|██████████| 91/91 [00:29<00:00,  3.09it/s]
[train epoch 43] loss: 0.466, acc: 0.873: 100%|██████████| 366/366 [01:40<00:00,  3.64it/s]
[valid epoch 43] loss: 0.554, acc: 0.849: 100%|██████████| 91/91 [00:29<00:00,  3.10it/s]
Stage 3 (head+MLP+last4Attn) finished. Best acc: 0.8536
Progressive QAT completed. Best validation accuracy: 0.8722

==== Sweep 5: head+MLP+last5Attn ====

=== QAT Stage 1 (8bit, head+MLP+last5Attn) ===
[train epoch 0] loss: 1.153, acc: 0.623: 100%|██████████| 366/366 [01:41<00:00,  3.59it/s]
[valid epoch 0] loss: 1.071, acc: 0.678: 100%|██████████| 91/91 [00:29<00:00,  3.07it/s]
Best model (head+MLP+last5Attn Stage 1) saved with accuracy: 0.6777
[train epoch 1] loss: 0.971, acc: 0.683: 100%|██████████| 366/366 [01:41<00:00,  3.60it/s]
[valid epoch 1] loss: 0.944, acc: 0.728: 100%|██████████| 91/91 [00:29<00:00,  3.06it/s]
Best model (head+MLP+last5Attn Stage 1) saved with accuracy: 0.7278
[train epoch 2] loss: 0.928, acc: 0.695: 100%|██████████| 366/366 [01:41<00:00,  3.59it/s]
[valid epoch 2] loss: 0.872, acc: 0.740: 100%|██████████| 91/91 [00:29<00:00,  3.07it/s]
Best model (head+MLP+last5Attn Stage 1) saved with accuracy: 0.7395
[train epoch 3] loss: 0.883, acc: 0.706: 100%|██████████| 366/366 [01:41<00:00,  3.60it/s]
[valid epoch 3] loss: 0.858, acc: 0.745: 100%|██████████| 91/91 [00:29<00:00,  3.07it/s]
Best model (head+MLP+last5Attn Stage 1) saved with accuracy: 0.7450
[train epoch 4] loss: 0.837, acc: 0.716: 100%|██████████| 366/366 [01:41<00:00,  3.59it/s]
[valid epoch 4] loss: 0.859, acc: 0.748: 100%|██████████| 91/91 [00:29<00:00,  3.06it/s]
Best model (head+MLP+last5Attn Stage 1) saved with accuracy: 0.7485
[train epoch 5] loss: 0.788, acc: 0.741: 100%|██████████| 366/366 [01:41<00:00,  3.60it/s]
[valid epoch 5] loss: 0.818, acc: 0.752: 100%|██████████| 91/91 [00:29<00:00,  3.06it/s]
Best model (head+MLP+last5Attn Stage 1) saved with accuracy: 0.7519
[train epoch 6] loss: 0.768, acc: 0.751: 100%|██████████| 366/366 [01:41<00:00,  3.59it/s]
[valid epoch 6] loss: 0.773, acc: 0.770: 100%|██████████| 91/91 [00:29<00:00,  3.07it/s]
Best model (head+MLP+last5Attn Stage 1) saved with accuracy: 0.7698
[train epoch 7] loss: 0.700, acc: 0.775: 100%|██████████| 366/366 [01:41<00:00,  3.59it/s]
[valid epoch 7] loss: 0.758, acc: 0.785: 100%|██████████| 91/91 [00:29<00:00,  3.07it/s]
Best model (head+MLP+last5Attn Stage 1) saved with accuracy: 0.7849
[train epoch 8] loss: 0.657, acc: 0.791: 100%|██████████| 366/366 [01:41<00:00,  3.59it/s]
[valid epoch 8] loss: 0.721, acc: 0.789: 100%|██████████| 91/91 [00:29<00:00,  3.08it/s]
Best model (head+MLP+last5Attn Stage 1) saved with accuracy: 0.7890
[train epoch 9] loss: 0.607, acc: 0.813: 100%|██████████| 366/366 [01:41<00:00,  3.59it/s]
[valid epoch 9] loss: 0.671, acc: 0.797: 100%|██████████| 91/91 [00:29<00:00,  3.08it/s]
Best model (head+MLP+last5Attn Stage 1) saved with accuracy: 0.7973
[train epoch 10] loss: 0.575, acc: 0.822: 100%|██████████| 366/366 [01:41<00:00,  3.59it/s]
[valid epoch 10] loss: 0.618, acc: 0.819: 100%|██████████| 91/91 [00:29<00:00,  3.06it/s]
Best model (head+MLP+last5Attn Stage 1) saved with accuracy: 0.8186
[train epoch 11] loss: 0.552, acc: 0.835: 100%|██████████| 366/366 [01:42<00:00,  3.59it/s]
[valid epoch 11] loss: 0.580, acc: 0.830: 100%|██████████| 91/91 [00:29<00:00,  3.06it/s]
Best model (head+MLP+last5Attn Stage 1) saved with accuracy: 0.8296
[train epoch 12] loss: 0.509, acc: 0.848: 100%|██████████| 366/366 [01:41<00:00,  3.60it/s]
[valid epoch 12] loss: 0.561, acc: 0.844: 100%|██████████| 91/91 [00:29<00:00,  3.06it/s]
Best model (head+MLP+last5Attn Stage 1) saved with accuracy: 0.8440
[train epoch 13] loss: 0.488, acc: 0.860: 100%|██████████| 366/366 [01:41<00:00,  3.60it/s]
[valid epoch 13] loss: 0.545, acc: 0.839: 100%|██████████| 91/91 [00:29<00:00,  3.06it/s]
[train epoch 14] loss: 0.482, acc: 0.857: 100%|██████████| 366/366 [01:41<00:00,  3.59it/s]
[valid epoch 14] loss: 0.542, acc: 0.844: 100%|██████████| 91/91 [00:29<00:00,  3.06it/s]
Stage 1 (head+MLP+last5Attn) finished. Best acc: 0.8440

=== QAT Stage 2 (6bit, head+MLP+last5Attn) ===
[train epoch 15] loss: 0.559, acc: 0.831: 100%|██████████| 366/366 [01:41<00:00,  3.60it/s]
[valid epoch 15] loss: 0.601, acc: 0.827: 100%|██████████| 91/91 [00:29<00:00,  3.08it/s]
Best model (head+MLP+last5Attn Stage 2) saved with accuracy: 0.8275
[train epoch 16] loss: 0.543, acc: 0.835: 100%|██████████| 366/366 [01:41<00:00,  3.60it/s]
[valid epoch 16] loss: 0.593, acc: 0.827: 100%|██████████| 91/91 [00:29<00:00,  3.07it/s]
[train epoch 17] loss: 0.539, acc: 0.842: 100%|██████████| 366/366 [01:41<00:00,  3.59it/s]
[valid epoch 17] loss: 0.589, acc: 0.824: 100%|██████████| 91/91 [00:29<00:00,  3.08it/s]
[train epoch 18] loss: 0.524, acc: 0.843: 100%|██████████| 366/366 [01:41<00:00,  3.60it/s]
[valid epoch 18] loss: 0.601, acc: 0.824: 100%|██████████| 91/91 [00:29<00:00,  3.08it/s]
[train epoch 19] loss: 0.495, acc: 0.853: 100%|██████████| 366/366 [01:41<00:00,  3.59it/s]
[valid epoch 19] loss: 0.563, acc: 0.833: 100%|██████████| 91/91 [00:29<00:00,  3.07it/s]
Best model (head+MLP+last5Attn Stage 2) saved with accuracy: 0.8330
[train epoch 20] loss: 0.506, acc: 0.851: 100%|██████████| 366/366 [01:41<00:00,  3.60it/s]
[valid epoch 20] loss: 0.554, acc: 0.845: 100%|██████████| 91/91 [00:29<00:00,  3.07it/s]
Best model (head+MLP+last5Attn Stage 2) saved with accuracy: 0.8447
[train epoch 21] loss: 0.485, acc: 0.864: 100%|██████████| 366/366 [01:41<00:00,  3.60it/s]
[valid epoch 21] loss: 0.554, acc: 0.846: 100%|██████████| 91/91 [00:29<00:00,  3.06it/s]
Best model (head+MLP+last5Attn Stage 2) saved with accuracy: 0.8460
[train epoch 22] loss: 0.475, acc: 0.866: 100%|██████████| 366/366 [01:41<00:00,  3.60it/s]
[valid epoch 22] loss: 0.563, acc: 0.846: 100%|██████████| 91/91 [00:29<00:00,  3.07it/s]
[train epoch 23] loss: 0.456, acc: 0.874: 100%|██████████| 366/366 [01:41<00:00,  3.59it/s]
[valid epoch 23] loss: 0.537, acc: 0.850: 100%|██████████| 91/91 [00:29<00:00,  3.07it/s]
Best model (head+MLP+last5Attn Stage 2) saved with accuracy: 0.8502
[train epoch 24] loss: 0.447, acc: 0.877: 100%|██████████| 366/366 [01:41<00:00,  3.60it/s]
[valid epoch 24] loss: 0.542, acc: 0.843: 100%|██████████| 91/91 [00:29<00:00,  3.07it/s]
[train epoch 25] loss: 0.438, acc: 0.879: 100%|██████████| 366/366 [01:41<00:00,  3.59it/s]
[valid epoch 25] loss: 0.534, acc: 0.852: 100%|██████████| 91/91 [00:29<00:00,  3.07it/s]
Best model (head+MLP+last5Attn Stage 2) saved with accuracy: 0.8522
[train epoch 26] loss: 0.439, acc: 0.882: 100%|██████████| 366/366 [01:41<00:00,  3.59it/s]
[valid epoch 26] loss: 0.534, acc: 0.851: 100%|██████████| 91/91 [00:29<00:00,  3.05it/s]
[train epoch 27] loss: 0.433, acc: 0.881: 100%|██████████| 366/366 [01:41<00:00,  3.60it/s]
[valid epoch 27] loss: 0.525, acc: 0.852: 100%|██████████| 91/91 [00:29<00:00,  3.06it/s]
[train epoch 28] loss: 0.429, acc: 0.887: 100%|██████████| 366/366 [01:41<00:00,  3.60it/s]
[valid epoch 28] loss: 0.524, acc: 0.849: 100%|██████████| 91/91 [00:29<00:00,  3.07it/s]
Stage 2 (head+MLP+last5Attn) finished. Best acc: 0.8522

=== QAT Stage 3 (4bit, head+MLP+last5Attn) ===
[train epoch 29] loss: 0.935, acc: 0.694: 100%|██████████| 366/366 [02:03<00:00,  2.96it/s]
[valid epoch 29] loss: 0.850, acc: 0.745: 100%|██████████| 91/91 [00:30<00:00,  2.96it/s]
Best model (head+MLP+last5Attn Stage 3) saved with accuracy: 0.7450
[train epoch 30] loss: 0.779, acc: 0.746: 100%|██████████| 366/366 [02:02<00:00,  2.98it/s]
[valid epoch 30] loss: 0.796, acc: 0.759: 100%|██████████| 91/91 [00:30<00:00,  2.96it/s]
Best model (head+MLP+last5Attn Stage 3) saved with accuracy: 0.7588
[train epoch 31] loss: 0.715, acc: 0.778: 100%|██████████| 366/366 [02:03<00:00,  2.97it/s]
[valid epoch 31] loss: 0.773, acc: 0.772: 100%|██████████| 91/91 [00:30<00:00,  2.96it/s]
Best model (head+MLP+last5Attn Stage 3) saved with accuracy: 0.7718
[train epoch 32] loss: 0.683, acc: 0.782: 100%|██████████| 366/366 [02:02<00:00,  2.98it/s]
[valid epoch 32] loss: 0.801, acc: 0.771: 100%|██████████| 91/91 [00:30<00:00,  2.95it/s]
[train epoch 33] loss: 0.660, acc: 0.785: 100%|██████████| 366/366 [02:03<00:00,  2.97it/s]
[valid epoch 33] loss: 0.712, acc: 0.791: 100%|██████████| 91/91 [00:30<00:00,  2.96it/s]
Best model (head+MLP+last5Attn Stage 3) saved with accuracy: 0.7911
[train epoch 34] loss: 0.647, acc: 0.796: 100%|██████████| 366/366 [02:03<00:00,  2.97it/s]
[valid epoch 34] loss: 0.699, acc: 0.797: 100%|██████████| 91/91 [00:31<00:00,  2.92it/s]
Best model (head+MLP+last5Attn Stage 3) saved with accuracy: 0.7973
[train epoch 35] loss: 0.639, acc: 0.797: 100%|██████████| 366/366 [02:03<00:00,  2.97it/s]
[valid epoch 35] loss: 0.683, acc: 0.802: 100%|██████████| 91/91 [00:30<00:00,  2.95it/s]
Best model (head+MLP+last5Attn Stage 3) saved with accuracy: 0.8021
[train epoch 36] loss: 0.598, acc: 0.816: 100%|██████████| 366/366 [02:03<00:00,  2.97it/s]
[valid epoch 36] loss: 0.667, acc: 0.808: 100%|██████████| 91/91 [00:31<00:00,  2.93it/s]
Best model (head+MLP+last5Attn Stage 3) saved with accuracy: 0.8076
[train epoch 37] loss: 0.590, acc: 0.820: 100%|██████████| 366/366 [02:03<00:00,  2.97it/s]
[valid epoch 37] loss: 0.658, acc: 0.806: 100%|██████████| 91/91 [00:30<00:00,  2.97it/s]
[train epoch 38] loss: 0.562, acc: 0.835: 100%|██████████| 366/366 [02:03<00:00,  2.97it/s]
[valid epoch 38] loss: 0.643, acc: 0.815: 100%|██████████| 91/91 [00:30<00:00,  2.94it/s]
Best model (head+MLP+last5Attn Stage 3) saved with accuracy: 0.8151
[train epoch 39] loss: 0.547, acc: 0.837: 100%|██████████| 366/366 [02:02<00:00,  2.98it/s]
[valid epoch 39] loss: 0.626, acc: 0.823: 100%|██████████| 91/91 [00:30<00:00,  2.97it/s]
Best model (head+MLP+last5Attn Stage 3) saved with accuracy: 0.8227
[train epoch 40] loss: 0.536, acc: 0.844: 100%|██████████| 366/366 [02:03<00:00,  2.97it/s]
[valid epoch 40] loss: 0.619, acc: 0.821: 100%|██████████| 91/91 [00:30<00:00,  2.95it/s]
[train epoch 41] loss: 0.539, acc: 0.836: 100%|██████████| 366/366 [02:02<00:00,  2.98it/s]
[valid epoch 41] loss: 0.611, acc: 0.821: 100%|██████████| 91/91 [00:30<00:00,  2.96it/s]
[train epoch 42] loss: 0.516, acc: 0.852: 100%|██████████| 366/366 [02:03<00:00,  2.97it/s]
[valid epoch 42] loss: 0.604, acc: 0.825: 100%|██████████| 91/91 [00:30<00:00,  2.95it/s]
Best model (head+MLP+last5Attn Stage 3) saved with accuracy: 0.8247
[train epoch 43] loss: 0.511, acc: 0.853: 100%|██████████| 366/366 [02:02<00:00,  2.98it/s]
[valid epoch 43] loss: 0.600, acc: 0.827: 100%|██████████| 91/91 [00:30<00:00,  2.95it/s]
Best model (head+MLP+last5Attn Stage 3) saved with accuracy: 0.8275
[train epoch 44] loss: 0.510, acc: 0.854: 100%|██████████| 366/366 [02:03<00:00,  2.97it/s]
[valid epoch 44] loss: 0.599, acc: 0.829: 100%|██████████| 91/91 [00:30<00:00,  2.96it/s]
Best model (head+MLP+last5Attn Stage 3) saved with accuracy: 0.8289
Stage 3 (head+MLP+last5Attn) finished. Best acc: 0.8289
Progressive QAT completed. Best validation accuracy: 0.8522

==== Sweep 6: head+MLP+last6Attn ====

=== QAT Stage 1 (8bit, head+MLP+last6Attn) ===
[train epoch 0] loss: 1.278, acc: 0.581: 100%|██████████| 366/366 [02:23<00:00,  2.55it/s]
[valid epoch 0] loss: 1.273, acc: 0.594: 100%|██████████| 91/91 [00:38<00:00,  2.36it/s]
Best model (head+MLP+last6Attn Stage 1) saved with accuracy: 0.5938
[train epoch 1] loss: 1.124, acc: 0.623: 100%|██████████| 366/366 [02:23<00:00,  2.55it/s]
[valid epoch 1] loss: 1.077, acc: 0.671: 100%|██████████| 91/91 [00:38<00:00,  2.36it/s]
Best model (head+MLP+last6Attn Stage 1) saved with accuracy: 0.6708
[train epoch 2] loss: 1.029, acc: 0.662: 100%|██████████| 366/366 [02:23<00:00,  2.55it/s]
[valid epoch 2] loss: 1.065, acc: 0.675: 100%|██████████| 91/91 [00:38<00:00,  2.36it/s]
Best model (head+MLP+last6Attn Stage 1) saved with accuracy: 0.6749
[train epoch 3] loss: 1.013, acc: 0.666: 100%|██████████| 366/366 [02:23<00:00,  2.55it/s]
[valid epoch 3] loss: 1.074, acc: 0.676: 100%|██████████| 91/91 [00:38<00:00,  2.36it/s]
Best model (head+MLP+last6Attn Stage 1) saved with accuracy: 0.6763
[train epoch 4] loss: 0.987, acc: 0.673: 100%|██████████| 366/366 [02:23<00:00,  2.55it/s]
[valid epoch 4] loss: 0.981, acc: 0.705: 100%|██████████| 91/91 [00:38<00:00,  2.37it/s]
Best model (head+MLP+last6Attn Stage 1) saved with accuracy: 0.7052
[train epoch 5] loss: 0.892, acc: 0.708: 100%|██████████| 366/366 [02:23<00:00,  2.55it/s]
[valid epoch 5] loss: 0.948, acc: 0.715: 100%|██████████| 91/91 [00:38<00:00,  2.37it/s]
Best model (head+MLP+last6Attn Stage 1) saved with accuracy: 0.7148
[train epoch 6] loss: 0.892, acc: 0.706: 100%|██████████| 366/366 [02:23<00:00,  2.56it/s]
[valid epoch 6] loss: 0.850, acc: 0.753: 100%|██████████| 91/91 [00:38<00:00,  2.37it/s]
Best model (head+MLP+last6Attn Stage 1) saved with accuracy: 0.7533
[train epoch 7] loss: 0.820, acc: 0.730: 100%|██████████| 366/366 [02:23<00:00,  2.55it/s]
[valid epoch 7] loss: 0.808, acc: 0.763: 100%|██████████| 91/91 [00:38<00:00,  2.36it/s]
Best model (head+MLP+last6Attn Stage 1) saved with accuracy: 0.7629
[train epoch 8] loss: 0.761, acc: 0.756: 100%|██████████| 366/366 [02:23<00:00,  2.55it/s]
[valid epoch 8] loss: 0.764, acc: 0.770: 100%|██████████| 91/91 [00:38<00:00,  2.35it/s]
Best model (head+MLP+last6Attn Stage 1) saved with accuracy: 0.7698
[train epoch 9] loss: 0.708, acc: 0.767: 100%|██████████| 366/366 [02:23<00:00,  2.55it/s]
[valid epoch 9] loss: 0.759, acc: 0.770: 100%|██████████| 91/91 [00:38<00:00,  2.36it/s]
[train epoch 10] loss: 0.666, acc: 0.787: 100%|██████████| 366/366 [02:24<00:00,  2.54it/s]
[valid epoch 10] loss: 0.710, acc: 0.790: 100%|██████████| 91/91 [00:38<00:00,  2.37it/s]
Best model (head+MLP+last6Attn Stage 1) saved with accuracy: 0.7904
[train epoch 11] loss: 0.648, acc: 0.790: 100%|██████████| 366/366 [02:23<00:00,  2.55it/s]
[valid epoch 11] loss: 0.710, acc: 0.784: 100%|██████████| 91/91 [00:38<00:00,  2.36it/s]
[train epoch 12] loss: 0.601, acc: 0.810: 100%|██████████| 366/366 [02:23<00:00,  2.55it/s]
[valid epoch 12] loss: 0.652, acc: 0.800: 100%|██████████| 91/91 [00:38<00:00,  2.36it/s]
Best model (head+MLP+last6Attn Stage 1) saved with accuracy: 0.8000
[train epoch 13] loss: 0.585, acc: 0.817: 100%|██████████| 366/366 [02:23<00:00,  2.55it/s]
[valid epoch 13] loss: 0.637, acc: 0.815: 100%|██████████| 91/91 [00:38<00:00,  2.36it/s]
Best model (head+MLP+last6Attn Stage 1) saved with accuracy: 0.8151
[train epoch 14] loss: 0.553, acc: 0.832: 100%|██████████| 366/366 [02:23<00:00,  2.55it/s]
[valid epoch 14] loss: 0.626, acc: 0.814: 100%|██████████| 91/91 [00:38<00:00,  2.36it/s]
[train epoch 15] loss: 0.554, acc: 0.830: 100%|██████████| 366/366 [02:23<00:00,  2.54it/s]
[valid epoch 15] loss: 0.616, acc: 0.821: 100%|██████████| 91/91 [00:38<00:00,  2.36it/s]
Best model (head+MLP+last6Attn Stage 1) saved with accuracy: 0.8213
Stage 1 (head+MLP+last6Attn) finished. Best acc: 0.8213

=== QAT Stage 2 (6bit, head+MLP+last6Attn) ===
[train epoch 16] loss: 0.609, acc: 0.811: 100%|██████████| 366/366 [02:04<00:00,  2.94it/s]
[valid epoch 16] loss: 0.692, acc: 0.792: 100%|██████████| 91/91 [00:31<00:00,  2.92it/s]
Best model (head+MLP+last6Attn Stage 2) saved with accuracy: 0.7918
[train epoch 17] loss: 0.592, acc: 0.814: 100%|██████████| 366/366 [02:05<00:00,  2.92it/s]
[valid epoch 17] loss: 0.673, acc: 0.803: 100%|██████████| 91/91 [00:31<00:00,  2.92it/s]
Best model (head+MLP+last6Attn Stage 2) saved with accuracy: 0.8034
[train epoch 18] loss: 0.592, acc: 0.814: 100%|██████████| 366/366 [02:05<00:00,  2.93it/s]
[valid epoch 18] loss: 0.656, acc: 0.805: 100%|██████████| 91/91 [00:31<00:00,  2.92it/s]
Best model (head+MLP+last6Attn Stage 2) saved with accuracy: 0.8048
[train epoch 19] loss: 0.570, acc: 0.826: 100%|██████████| 366/366 [02:04<00:00,  2.94it/s]
[valid epoch 19] loss: 0.650, acc: 0.820: 100%|██████████| 91/91 [00:31<00:00,  2.93it/s]
Best model (head+MLP+last6Attn Stage 2) saved with accuracy: 0.8199
[train epoch 20] loss: 0.578, acc: 0.816: 100%|██████████| 366/366 [02:04<00:00,  2.93it/s]
[valid epoch 20] loss: 0.677, acc: 0.799: 100%|██████████| 91/91 [00:31<00:00,  2.93it/s]
[train epoch 21] loss: 0.563, acc: 0.831: 100%|██████████| 366/366 [02:04<00:00,  2.94it/s]
[valid epoch 21] loss: 0.661, acc: 0.804: 100%|██████████| 91/91 [00:31<00:00,  2.92it/s]
[train epoch 22] loss: 0.561, acc: 0.826: 100%|██████████| 366/366 [02:05<00:00,  2.92it/s]
[valid epoch 22] loss: 0.645, acc: 0.815: 100%|██████████| 91/91 [00:31<00:00,  2.92it/s]
[train epoch 23] loss: 0.536, acc: 0.841: 100%|██████████| 366/366 [02:04<00:00,  2.94it/s]
[valid epoch 23] loss: 0.612, acc: 0.823: 100%|██████████| 91/91 [00:31<00:00,  2.91it/s]
Best model (head+MLP+last6Attn Stage 2) saved with accuracy: 0.8227
[train epoch 24] loss: 0.534, acc: 0.846: 100%|██████████| 366/366 [02:04<00:00,  2.93it/s]
[valid epoch 24] loss: 0.633, acc: 0.813: 100%|██████████| 91/91 [00:31<00:00,  2.92it/s]
[train epoch 25] loss: 0.515, acc: 0.850: 100%|██████████| 366/366 [02:04<00:00,  2.93it/s]
[valid epoch 25] loss: 0.610, acc: 0.816: 100%|██████████| 91/91 [00:31<00:00,  2.91it/s]
[train epoch 26] loss: 0.515, acc: 0.849: 100%|██████████| 366/366 [02:05<00:00,  2.93it/s]
[valid epoch 26] loss: 0.621, acc: 0.819: 100%|██████████| 91/91 [00:31<00:00,  2.92it/s]
[train epoch 27] loss: 0.506, acc: 0.853: 100%|██████████| 366/366 [02:04<00:00,  2.94it/s]
[valid epoch 27] loss: 0.608, acc: 0.820: 100%|██████████| 91/91 [00:31<00:00,  2.91it/s]
[train epoch 28] loss: 0.500, acc: 0.854: 100%|██████████| 366/366 [02:04<00:00,  2.94it/s]
[valid epoch 28] loss: 0.603, acc: 0.826: 100%|██████████| 91/91 [00:31<00:00,  2.93it/s]
Best model (head+MLP+last6Attn Stage 2) saved with accuracy: 0.8261
[train epoch 29] loss: 0.488, acc: 0.857: 100%|██████████| 366/366 [02:04<00:00,  2.93it/s]
[valid epoch 29] loss: 0.594, acc: 0.823: 100%|██████████| 91/91 [00:31<00:00,  2.93it/s]
[train epoch 30] loss: 0.477, acc: 0.867: 100%|██████████| 366/366 [02:04<00:00,  2.94it/s]
[valid epoch 30] loss: 0.587, acc: 0.825: 100%|██████████| 91/91 [00:31<00:00,  2.92it/s]
[train epoch 31] loss: 0.475, acc: 0.864: 100%|██████████| 366/366 [02:04<00:00,  2.93it/s]
[valid epoch 31] loss: 0.583, acc: 0.827: 100%|██████████| 91/91 [00:31<00:00,  2.92it/s]
Best model (head+MLP+last6Attn Stage 2) saved with accuracy: 0.8268
[train epoch 32] loss: 0.471, acc: 0.869: 100%|██████████| 366/366 [02:04<00:00,  2.95it/s]
[valid epoch 32] loss: 0.584, acc: 0.825: 100%|██████████| 91/91 [00:31<00:00,  2.93it/s]
[train epoch 33] loss: 0.478, acc: 0.867: 100%|██████████| 366/366 [02:04<00:00,  2.93it/s]
[valid epoch 33] loss: 0.583, acc: 0.823: 100%|██████████| 91/91 [00:31<00:00,  2.92it/s]
Stage 2 (head+MLP+last6Attn) finished. Best acc: 0.8268

=== QAT Stage 3 (4bit, head+MLP+last6Attn) ===
[train epoch 34] loss: 1.070, acc: 0.651: 100%|██████████| 366/366 [02:04<00:00,  2.95it/s]
[valid epoch 34] loss: 1.035, acc: 0.678: 100%|██████████| 91/91 [00:31<00:00,  2.91it/s]
Best model (head+MLP+last6Attn Stage 3) saved with accuracy: 0.6784
[train epoch 35] loss: 0.892, acc: 0.704: 100%|██████████| 366/366 [02:04<00:00,  2.93it/s]
[valid epoch 35] loss: 0.899, acc: 0.716: 100%|██████████| 91/91 [00:31<00:00,  2.93it/s]
Best model (head+MLP+last6Attn Stage 3) saved with accuracy: 0.7162
[train epoch 36] loss: 0.811, acc: 0.740: 100%|██████████| 366/366 [02:04<00:00,  2.94it/s]
[valid epoch 36] loss: 0.888, acc: 0.728: 100%|██████████| 91/91 [00:31<00:00,  2.91it/s]
Best model (head+MLP+last6Attn Stage 3) saved with accuracy: 0.7278
[train epoch 37] loss: 0.788, acc: 0.745: 100%|██████████| 366/366 [02:04<00:00,  2.94it/s]
[valid epoch 37] loss: 0.826, acc: 0.750: 100%|██████████| 91/91 [00:31<00:00,  2.93it/s]
Best model (head+MLP+last6Attn Stage 3) saved with accuracy: 0.7498
[train epoch 38] loss: 0.772, acc: 0.745: 100%|██████████| 366/366 [02:04<00:00,  2.94it/s]
[valid epoch 38] loss: 0.831, acc: 0.755: 100%|██████████| 91/91 [00:31<00:00,  2.92it/s]
Best model (head+MLP+last6Attn Stage 3) saved with accuracy: 0.7546
[train epoch 39] loss: 0.745, acc: 0.760: 100%|██████████| 366/366 [02:04<00:00,  2.94it/s]
[valid epoch 39] loss: 0.817, acc: 0.752: 100%|██████████| 91/91 [00:30<00:00,  2.94it/s]
[train epoch 40] loss: 0.725, acc: 0.768: 100%|██████████| 366/366 [02:04<00:00,  2.94it/s]
[valid epoch 40] loss: 0.788, acc: 0.766: 100%|██████████| 91/91 [00:31<00:00,  2.91it/s]
Best model (head+MLP+last6Attn Stage 3) saved with accuracy: 0.7663
[train epoch 41] loss: 0.718, acc: 0.768: 100%|██████████| 366/366 [02:04<00:00,  2.94it/s]
[valid epoch 41] loss: 0.787, acc: 0.762: 100%|██████████| 91/91 [00:31<00:00,  2.92it/s]
[train epoch 42] loss: 0.681, acc: 0.784: 100%|██████████| 366/366 [02:04<00:00,  2.94it/s]
[valid epoch 42] loss: 0.763, acc: 0.774: 100%|██████████| 91/91 [00:31<00:00,  2.92it/s]
Best model (head+MLP+last6Attn Stage 3) saved with accuracy: 0.7739
[train epoch 43] loss: 0.671, acc: 0.789: 100%|██████████| 366/366 [02:04<00:00,  2.95it/s]
[valid epoch 43] loss: 0.733, acc: 0.786: 100%|██████████| 91/91 [00:31<00:00,  2.92it/s]
Best model (head+MLP+last6Attn Stage 3) saved with accuracy: 0.7856
[train epoch 44] loss: 0.651, acc: 0.794: 100%|██████████| 366/366 [02:04<00:00,  2.93it/s]
[valid epoch 44] loss: 0.721, acc: 0.790: 100%|██████████| 91/91 [00:31<00:00,  2.92it/s]
Best model (head+MLP+last6Attn Stage 3) saved with accuracy: 0.7897
[train epoch 45] loss: 0.637, acc: 0.804: 100%|██████████| 366/366 [02:04<00:00,  2.94it/s]
[valid epoch 45] loss: 0.726, acc: 0.784: 100%|██████████| 91/91 [00:31<00:00,  2.92it/s]
[train epoch 46] loss: 0.621, acc: 0.806: 100%|██████████| 366/366 [02:04<00:00,  2.94it/s]
[valid epoch 46] loss: 0.697, acc: 0.796: 100%|██████████| 91/91 [00:31<00:00,  2.92it/s]
Best model (head+MLP+last6Attn Stage 3) saved with accuracy: 0.7959
[train epoch 47] loss: 0.611, acc: 0.807: 100%|██████████| 366/366 [02:04<00:00,  2.94it/s]
[valid epoch 47] loss: 0.685, acc: 0.794: 100%|██████████| 91/91 [00:31<00:00,  2.90it/s]
[train epoch 48] loss: 0.589, acc: 0.820: 100%|██████████| 366/366 [02:04<00:00,  2.94it/s]
[valid epoch 48] loss: 0.677, acc: 0.803: 100%|██████████| 91/91 [00:31<00:00,  2.92it/s]
Best model (head+MLP+last6Attn Stage 3) saved with accuracy: 0.8034
[train epoch 49] loss: 0.584, acc: 0.825: 100%|██████████| 366/366 [02:04<00:00,  2.93it/s]
[valid epoch 49] loss: 0.672, acc: 0.805: 100%|██████████| 91/91 [00:31<00:00,  2.90it/s]
Best model (head+MLP+last6Attn Stage 3) saved with accuracy: 0.8055
[train epoch 50] loss: 0.578, acc: 0.823: 100%|██████████| 366/366 [02:04<00:00,  2.94it/s]
[valid epoch 50] loss: 0.668, acc: 0.803: 100%|██████████| 91/91 [00:31<00:00,  2.92it/s]
[train epoch 51] loss: 0.558, acc: 0.831: 100%|██████████| 366/366 [02:04<00:00,  2.93it/s]
[valid epoch 51] loss: 0.661, acc: 0.814: 100%|██████████| 91/91 [00:31<00:00,  2.93it/s]
Best model (head+MLP+last6Attn Stage 3) saved with accuracy: 0.8144
[train epoch 52] loss: 0.563, acc: 0.830: 100%|██████████| 366/366 [02:04<00:00,  2.94it/s]
[valid epoch 52] loss: 0.661, acc: 0.803: 100%|██████████| 91/91 [00:31<00:00,  2.90it/s]
[train epoch 53] loss: 0.557, acc: 0.830: 100%|██████████| 366/366 [02:04<00:00,  2.93it/s]
[valid epoch 53] loss: 0.660, acc: 0.813: 100%|██████████| 91/91 [00:31<00:00,  2.92it/s]
Stage 3 (head+MLP+last6Attn) finished. Best acc: 0.8144
Progressive QAT completed. Best validation accuracy: 0.8268

==== Sweep 7: head+MLP+last7Attn ====

=== QAT Stage 1 (8bit, head+MLP+last7Attn) ===
[train epoch 0] loss: 1.870, acc: 0.365: 100%|██████████| 366/366 [02:06<00:00,  2.90it/s]
[valid epoch 0] loss: 1.633, acc: 0.495: 100%|██████████| 91/91 [00:31<00:00,  2.89it/s]
Best model (head+MLP+last7Attn Stage 1) saved with accuracy: 0.4948
[train epoch 1] loss: 1.557, acc: 0.493: 100%|██████████| 366/366 [02:06<00:00,  2.90it/s]
[valid epoch 1] loss: 1.685, acc: 0.488: 100%|██████████| 91/91 [00:31<00:00,  2.89it/s]
[train epoch 2] loss: 1.422, acc: 0.532: 100%|██████████| 366/366 [02:06<00:00,  2.90it/s]
[valid epoch 2] loss: 1.450, acc: 0.547: 100%|██████████| 91/91 [00:31<00:00,  2.89it/s]
Best model (head+MLP+last7Attn Stage 1) saved with accuracy: 0.5471
[train epoch 3] loss: 1.359, acc: 0.549: 100%|██████████| 366/366 [02:06<00:00,  2.90it/s]
[valid epoch 3] loss: 1.326, acc: 0.603: 100%|██████████| 91/91 [00:31<00:00,  2.89it/s]
Best model (head+MLP+last7Attn Stage 1) saved with accuracy: 0.6027
[train epoch 4] loss: 1.286, acc: 0.577: 100%|██████████| 366/366 [02:06<00:00,  2.90it/s]
[valid epoch 4] loss: 1.340, acc: 0.581: 100%|██████████| 91/91 [00:31<00:00,  2.88it/s]
[train epoch 5] loss: 1.218, acc: 0.595: 100%|██████████| 366/366 [02:06<00:00,  2.90it/s]
[valid epoch 5] loss: 1.245, acc: 0.618: 100%|██████████| 91/91 [00:31<00:00,  2.89it/s]
Best model (head+MLP+last7Attn Stage 1) saved with accuracy: 0.6179
[train epoch 6] loss: 1.206, acc: 0.602: 100%|██████████| 366/366 [02:06<00:00,  2.90it/s]
[valid epoch 6] loss: 1.251, acc: 0.628: 100%|██████████| 91/91 [00:31<00:00,  2.89it/s]
Best model (head+MLP+last7Attn Stage 1) saved with accuracy: 0.6282
[train epoch 7] loss: 1.137, acc: 0.614: 100%|██████████| 366/366 [02:05<00:00,  2.91it/s]
[valid epoch 7] loss: 1.244, acc: 0.626: 100%|██████████| 91/91 [00:31<00:00,  2.89it/s]
[train epoch 8] loss: 1.086, acc: 0.647: 100%|██████████| 366/366 [02:06<00:00,  2.90it/s]
[valid epoch 8] loss: 1.077, acc: 0.682: 100%|██████████| 91/91 [00:31<00:00,  2.89it/s]
Best model (head+MLP+last7Attn Stage 1) saved with accuracy: 0.6825
[train epoch 9] loss: 1.030, acc: 0.659: 100%|██████████| 366/366 [02:05<00:00,  2.91it/s]
[valid epoch 9] loss: 1.055, acc: 0.692: 100%|██████████| 91/91 [00:31<00:00,  2.88it/s]
Best model (head+MLP+last7Attn Stage 1) saved with accuracy: 0.6921
[train epoch 10] loss: 0.996, acc: 0.669: 100%|██████████| 366/366 [02:06<00:00,  2.90it/s]
[valid epoch 10] loss: 0.975, acc: 0.708: 100%|██████████| 91/91 [00:31<00:00,  2.90it/s]
Best model (head+MLP+last7Attn Stage 1) saved with accuracy: 0.7079
[train epoch 11] loss: 0.933, acc: 0.694: 100%|██████████| 366/366 [02:06<00:00,  2.90it/s]
[valid epoch 11] loss: 0.936, acc: 0.727: 100%|██████████| 91/91 [00:31<00:00,  2.87it/s]
Best model (head+MLP+last7Attn Stage 1) saved with accuracy: 0.7271
[train epoch 12] loss: 0.882, acc: 0.709: 100%|██████████| 366/366 [02:05<00:00,  2.91it/s]
[valid epoch 12] loss: 0.920, acc: 0.722: 100%|██████████| 91/91 [00:31<00:00,  2.90it/s]
[train epoch 13] loss: 0.847, acc: 0.724: 100%|██████████| 366/366 [02:06<00:00,  2.90it/s]
[valid epoch 13] loss: 0.887, acc: 0.742: 100%|██████████| 91/91 [00:31<00:00,  2.89it/s]
Best model (head+MLP+last7Attn Stage 1) saved with accuracy: 0.7423
[train epoch 14] loss: 0.807, acc: 0.736: 100%|██████████| 366/366 [02:05<00:00,  2.91it/s]
[valid epoch 14] loss: 0.855, acc: 0.744: 100%|██████████| 91/91 [00:31<00:00,  2.90it/s]
Best model (head+MLP+last7Attn Stage 1) saved with accuracy: 0.7443
[train epoch 15] loss: 0.770, acc: 0.750: 100%|██████████| 366/366 [02:06<00:00,  2.89it/s]
[valid epoch 15] loss: 0.867, acc: 0.748: 100%|██████████| 91/91 [00:31<00:00,  2.89it/s]
Best model (head+MLP+last7Attn Stage 1) saved with accuracy: 0.7478
[train epoch 16] loss: 0.724, acc: 0.771: 100%|██████████| 366/366 [02:05<00:00,  2.91it/s]
[valid epoch 16] loss: 0.805, acc: 0.764: 100%|██████████| 91/91 [00:31<00:00,  2.89it/s]
Best model (head+MLP+last7Attn Stage 1) saved with accuracy: 0.7643
[train epoch 17] loss: 0.698, acc: 0.776: 100%|██████████| 366/366 [02:06<00:00,  2.90it/s]
[valid epoch 17] loss: 0.791, acc: 0.775: 100%|██████████| 91/91 [00:31<00:00,  2.89it/s]
Best model (head+MLP+last7Attn Stage 1) saved with accuracy: 0.7753
[train epoch 18] loss: 0.677, acc: 0.784: 100%|██████████| 366/366 [02:05<00:00,  2.91it/s]
[valid epoch 18] loss: 0.790, acc: 0.779: 100%|██████████| 91/91 [00:31<00:00,  2.88it/s]
Best model (head+MLP+last7Attn Stage 1) saved with accuracy: 0.7787
[train epoch 19] loss: 0.667, acc: 0.788: 100%|██████████| 366/366 [02:06<00:00,  2.90it/s]
[valid epoch 19] loss: 0.780, acc: 0.780: 100%|██████████| 91/91 [00:31<00:00,  2.90it/s]
Best model (head+MLP+last7Attn Stage 1) saved with accuracy: 0.7801
Stage 1 (head+MLP+last7Attn) finished. Best acc: 0.7801

=== QAT Stage 2 (6bit, head+MLP+last7Attn) ===
[train epoch 20] loss: 0.754, acc: 0.754: 100%|██████████| 366/366 [02:05<00:00,  2.91it/s]
[valid epoch 20] loss: 0.840, acc: 0.755: 100%|██████████| 91/91 [00:31<00:00,  2.88it/s]
Best model (head+MLP+last7Attn Stage 2) saved with accuracy: 0.7553
[train epoch 21] loss: 0.747, acc: 0.762: 100%|██████████| 366/366 [02:06<00:00,  2.90it/s]
[valid epoch 21] loss: 0.860, acc: 0.743: 100%|██████████| 91/91 [00:31<00:00,  2.88it/s]
[train epoch 22] loss: 0.739, acc: 0.757: 100%|██████████| 366/366 [02:05<00:00,  2.91it/s]
[valid epoch 22] loss: 0.813, acc: 0.759: 100%|██████████| 91/91 [00:31<00:00,  2.90it/s]
Best model (head+MLP+last7Attn Stage 2) saved with accuracy: 0.7595
[train epoch 23] loss: 0.738, acc: 0.764: 100%|██████████| 366/366 [02:05<00:00,  2.91it/s]
[valid epoch 23] loss: 0.834, acc: 0.755: 100%|██████████| 91/91 [00:31<00:00,  2.89it/s]
[train epoch 24] loss: 0.722, acc: 0.765: 100%|██████████| 366/366 [02:05<00:00,  2.91it/s]
[valid epoch 24] loss: 0.804, acc: 0.773: 100%|██████████| 91/91 [00:31<00:00,  2.87it/s]
Best model (head+MLP+last7Attn Stage 2) saved with accuracy: 0.7725
[train epoch 25] loss: 0.704, acc: 0.774: 100%|██████████| 366/366 [02:05<00:00,  2.91it/s]
[valid epoch 25] loss: 0.795, acc: 0.775: 100%|██████████| 91/91 [00:31<00:00,  2.89it/s]
Best model (head+MLP+last7Attn Stage 2) saved with accuracy: 0.7746
[train epoch 26] loss: 0.698, acc: 0.779: 100%|██████████| 366/366 [02:06<00:00,  2.90it/s]
[valid epoch 26] loss: 0.764, acc: 0.780: 100%|██████████| 91/91 [00:31<00:00,  2.89it/s]
Best model (head+MLP+last7Attn Stage 2) saved with accuracy: 0.7801
[train epoch 27] loss: 0.664, acc: 0.792: 100%|██████████| 366/366 [02:05<00:00,  2.92it/s]
[valid epoch 27] loss: 0.768, acc: 0.778: 100%|██████████| 91/91 [00:31<00:00,  2.87it/s]
[train epoch 28] loss: 0.652, acc: 0.798: 100%|██████████| 366/366 [02:05<00:00,  2.91it/s]
[valid epoch 28] loss: 0.749, acc: 0.782: 100%|██████████| 91/91 [00:31<00:00,  2.89it/s]
Best model (head+MLP+last7Attn Stage 2) saved with accuracy: 0.7821
[train epoch 29] loss: 0.638, acc: 0.805: 100%|██████████| 366/366 [02:06<00:00,  2.90it/s]
[valid epoch 29] loss: 0.744, acc: 0.784: 100%|██████████| 91/91 [00:31<00:00,  2.88it/s]
Best model (head+MLP+last7Attn Stage 2) saved with accuracy: 0.7835
[train epoch 30] loss: 0.605, acc: 0.815: 100%|██████████| 366/366 [02:05<00:00,  2.91it/s]
[valid epoch 30] loss: 0.740, acc: 0.788: 100%|██████████| 91/91 [00:31<00:00,  2.89it/s]
Best model (head+MLP+last7Attn Stage 2) saved with accuracy: 0.7883
[train epoch 31] loss: 0.614, acc: 0.812: 100%|██████████| 366/366 [02:05<00:00,  2.91it/s]
[valid epoch 31] loss: 0.729, acc: 0.792: 100%|██████████| 91/91 [00:31<00:00,  2.87it/s]
Best model (head+MLP+last7Attn Stage 2) saved with accuracy: 0.7924
[train epoch 32] loss: 0.603, acc: 0.819: 100%|██████████| 366/366 [02:05<00:00,  2.91it/s]
[valid epoch 32] loss: 0.733, acc: 0.793: 100%|██████████| 91/91 [00:31<00:00,  2.90it/s]
Best model (head+MLP+last7Attn Stage 2) saved with accuracy: 0.7931
[train epoch 33] loss: 0.604, acc: 0.821: 100%|██████████| 366/366 [02:05<00:00,  2.91it/s]
[valid epoch 33] loss: 0.731, acc: 0.790: 100%|██████████| 91/91 [00:31<00:00,  2.88it/s]
Stage 2 (head+MLP+last7Attn) finished. Best acc: 0.7931

=== QAT Stage 3 (4bit, head+MLP+last7Attn) ===
[train epoch 34] loss: 1.285, acc: 0.577: 100%|██████████| 366/366 [02:05<00:00,  2.91it/s]
[valid epoch 34] loss: 1.124, acc: 0.658: 100%|██████████| 91/91 [00:31<00:00,  2.87it/s]
Best model (head+MLP+last7Attn Stage 3) saved with accuracy: 0.6577
[train epoch 35] loss: 1.037, acc: 0.666: 100%|██████████| 366/366 [02:06<00:00,  2.90it/s]
[valid epoch 35] loss: 1.070, acc: 0.686: 100%|██████████| 91/91 [00:31<00:00,  2.89it/s]
Best model (head+MLP+last7Attn Stage 3) saved with accuracy: 0.6859
[train epoch 36] loss: 0.990, acc: 0.674: 100%|██████████| 366/366 [02:05<00:00,  2.91it/s]
[valid epoch 36] loss: 1.039, acc: 0.684: 100%|██████████| 91/91 [00:31<00:00,  2.89it/s]
[train epoch 37] loss: 0.947, acc: 0.689: 100%|██████████| 366/366 [02:06<00:00,  2.90it/s]
[valid epoch 37] loss: 1.008, acc: 0.700: 100%|██████████| 91/91 [00:31<00:00,  2.90it/s]
Best model (head+MLP+last7Attn Stage 3) saved with accuracy: 0.7003
[train epoch 38] loss: 0.930, acc: 0.699: 100%|██████████| 366/366 [02:06<00:00,  2.90it/s]
[valid epoch 38] loss: 0.977, acc: 0.701: 100%|██████████| 91/91 [00:31<00:00,  2.88it/s]
Best model (head+MLP+last7Attn Stage 3) saved with accuracy: 0.7010
[train epoch 39] loss: 0.879, acc: 0.712: 100%|██████████| 366/366 [02:05<00:00,  2.91it/s]
[valid epoch 39] loss: 0.974, acc: 0.713: 100%|██████████| 91/91 [00:31<00:00,  2.89it/s]
Best model (head+MLP+last7Attn Stage 3) saved with accuracy: 0.7134
[train epoch 40] loss: 0.872, acc: 0.712: 100%|██████████| 366/366 [02:06<00:00,  2.90it/s]
[valid epoch 40] loss: 0.934, acc: 0.727: 100%|██████████| 91/91 [00:31<00:00,  2.88it/s]
Best model (head+MLP+last7Attn Stage 3) saved with accuracy: 0.7271
[train epoch 41] loss: 0.843, acc: 0.726: 100%|██████████| 366/366 [02:05<00:00,  2.91it/s]
[valid epoch 41] loss: 0.928, acc: 0.724: 100%|██████████| 91/91 [00:31<00:00,  2.89it/s]
[train epoch 42] loss: 0.813, acc: 0.736: 100%|██████████| 366/366 [02:06<00:00,  2.90it/s]
[valid epoch 42] loss: 0.934, acc: 0.709: 100%|██████████| 91/91 [00:31<00:00,  2.88it/s]
[train epoch 43] loss: 0.794, acc: 0.744: 100%|██████████| 366/366 [02:05<00:00,  2.91it/s]
[valid epoch 43] loss: 0.873, acc: 0.756: 100%|██████████| 91/91 [00:31<00:00,  2.90it/s]
Best model (head+MLP+last7Attn Stage 3) saved with accuracy: 0.7560
[train epoch 44] loss: 0.781, acc: 0.749: 100%|██████████| 366/366 [02:06<00:00,  2.90it/s]
[valid epoch 44] loss: 0.874, acc: 0.735: 100%|██████████| 91/91 [00:31<00:00,  2.89it/s]
[train epoch 45] loss: 0.760, acc: 0.753: 100%|██████████| 366/366 [02:05<00:00,  2.91it/s]
[valid epoch 45] loss: 0.860, acc: 0.744: 100%|██████████| 91/91 [00:31<00:00,  2.89it/s]
[train epoch 46] loss: 0.740, acc: 0.760: 100%|██████████| 366/366 [02:05<00:00,  2.91it/s]
[valid epoch 46] loss: 0.851, acc: 0.745: 100%|██████████| 91/91 [00:31<00:00,  2.90it/s]
[train epoch 47] loss: 0.747, acc: 0.757: 100%|██████████| 366/366 [02:05<00:00,  2.91it/s]
[valid epoch 47] loss: 0.852, acc: 0.745: 100%|██████████| 91/91 [00:31<00:00,  2.89it/s]
[train epoch 48] loss: 0.724, acc: 0.766: 100%|██████████| 366/366 [02:05<00:00,  2.91it/s]
[valid epoch 48] loss: 0.838, acc: 0.753: 100%|██████████| 91/91 [00:31<00:00,  2.90it/s]
[train epoch 49] loss: 0.710, acc: 0.777: 100%|██████████| 366/366 [02:05<00:00,  2.90it/s]
[valid epoch 49] loss: 0.835, acc: 0.754: 100%|██████████| 91/91 [00:31<00:00,  2.89it/s]
Stage 3 (head+MLP+last7Attn) finished. Best acc: 0.7560
Progressive QAT completed. Best validation accuracy: 0.7931

==== Sweep 8: head+MLP+last8Attn ====

=== QAT Stage 1 (8bit, head+MLP+last8Attn) ===
[train epoch 0] loss: 1.967, acc: 0.351: 100%|██████████| 366/366 [02:06<00:00,  2.88it/s]
[valid epoch 0] loss: 1.898, acc: 0.423: 100%|██████████| 91/91 [00:32<00:00,  2.83it/s]
Best model (head+MLP+last8Attn Stage 1) saved with accuracy: 0.4234
[train epoch 1] loss: 1.692, acc: 0.442: 100%|██████████| 366/366 [02:07<00:00,  2.87it/s]
[valid epoch 1] loss: 1.752, acc: 0.454: 100%|██████████| 91/91 [00:31<00:00,  2.86it/s]
Best model (head+MLP+last8Attn Stage 1) saved with accuracy: 0.4536
[train epoch 2] loss: 1.618, acc: 0.462: 100%|██████████| 366/366 [02:07<00:00,  2.88it/s]
[valid epoch 2] loss: 1.676, acc: 0.476: 100%|██████████| 91/91 [00:31<00:00,  2.87it/s]
Best model (head+MLP+last8Attn Stage 1) saved with accuracy: 0.4763
[train epoch 3] loss: 1.537, acc: 0.490: 100%|██████████| 366/366 [02:07<00:00,  2.88it/s]
[valid epoch 3] loss: 1.565, acc: 0.515: 100%|██████████| 91/91 [00:31<00:00,  2.87it/s]
Best model (head+MLP+last8Attn Stage 1) saved with accuracy: 0.5155
[train epoch 4] loss: 1.467, acc: 0.520: 100%|██████████| 366/366 [02:07<00:00,  2.88it/s]
[valid epoch 4] loss: 1.486, acc: 0.537: 100%|██████████| 91/91 [00:31<00:00,  2.86it/s]
Best model (head+MLP+last8Attn Stage 1) saved with accuracy: 0.5375
[train epoch 5] loss: 1.417, acc: 0.534: 100%|██████████| 366/366 [02:07<00:00,  2.88it/s]
[valid epoch 5] loss: 1.492, acc: 0.531: 100%|██████████| 91/91 [00:31<00:00,  2.87it/s]
[train epoch 6] loss: 1.374, acc: 0.546: 100%|██████████| 366/366 [02:07<00:00,  2.88it/s]
[valid epoch 6] loss: 1.465, acc: 0.549: 100%|██████████| 91/91 [00:31<00:00,  2.86it/s]
Best model (head+MLP+last8Attn Stage 1) saved with accuracy: 0.5491
[train epoch 7] loss: 1.300, acc: 0.571: 100%|██████████| 366/366 [02:07<00:00,  2.88it/s]
[valid epoch 7] loss: 1.295, acc: 0.593: 100%|██████████| 91/91 [00:31<00:00,  2.87it/s]
Best model (head+MLP+last8Attn Stage 1) saved with accuracy: 0.5931
[train epoch 8] loss: 1.266, acc: 0.582: 100%|██████████| 366/366 [02:07<00:00,  2.87it/s]
[valid epoch 8] loss: 1.321, acc: 0.595: 100%|██████████| 91/91 [00:31<00:00,  2.85it/s]
Best model (head+MLP+last8Attn Stage 1) saved with accuracy: 0.5952
[train epoch 9] loss: 1.196, acc: 0.606: 100%|██████████| 366/366 [02:07<00:00,  2.88it/s]
[valid epoch 9] loss: 1.184, acc: 0.636: 100%|██████████| 91/91 [00:32<00:00,  2.82it/s]
Best model (head+MLP+last8Attn Stage 1) saved with accuracy: 0.6364
[train epoch 10] loss: 1.148, acc: 0.620: 100%|██████████| 366/366 [02:07<00:00,  2.87it/s]
[valid epoch 10] loss: 1.160, acc: 0.636: 100%|██████████| 91/91 [00:31<00:00,  2.85it/s]
[train epoch 11] loss: 1.086, acc: 0.639: 100%|██████████| 366/366 [02:07<00:00,  2.88it/s]
[valid epoch 11] loss: 1.117, acc: 0.648: 100%|██████████| 91/91 [00:31<00:00,  2.86it/s]
Best model (head+MLP+last8Attn Stage 1) saved with accuracy: 0.6481
[train epoch 12] loss: 1.032, acc: 0.656: 100%|██████████| 366/366 [02:07<00:00,  2.87it/s]
[valid epoch 12] loss: 1.128, acc: 0.651: 100%|██████████| 91/91 [00:31<00:00,  2.86it/s]
Best model (head+MLP+last8Attn Stage 1) saved with accuracy: 0.6509
[train epoch 13] loss: 0.975, acc: 0.672: 100%|██████████| 366/366 [02:07<00:00,  2.88it/s]
[valid epoch 13] loss: 1.072, acc: 0.671: 100%|██████████| 91/91 [00:32<00:00,  2.83it/s]
Best model (head+MLP+last8Attn Stage 1) saved with accuracy: 0.6715
[train epoch 14] loss: 0.941, acc: 0.691: 100%|██████████| 366/366 [02:07<00:00,  2.87it/s]
[valid epoch 14] loss: 1.012, acc: 0.691: 100%|██████████| 91/91 [00:31<00:00,  2.86it/s]
Best model (head+MLP+last8Attn Stage 1) saved with accuracy: 0.6907
[train epoch 15] loss: 0.896, acc: 0.705: 100%|██████████| 366/366 [02:07<00:00,  2.87it/s]
[valid epoch 15] loss: 0.983, acc: 0.698: 100%|██████████| 91/91 [00:31<00:00,  2.85it/s]
Best model (head+MLP+last8Attn Stage 1) saved with accuracy: 0.6976
[train epoch 16] loss: 0.880, acc: 0.710: 100%|██████████| 366/366 [02:07<00:00,  2.88it/s]
[valid epoch 16] loss: 0.972, acc: 0.699: 100%|██████████| 91/91 [00:31<00:00,  2.86it/s]
Best model (head+MLP+last8Attn Stage 1) saved with accuracy: 0.6990
[train epoch 17] loss: 0.852, acc: 0.720: 100%|██████████| 366/366 [02:07<00:00,  2.87it/s]
[valid epoch 17] loss: 0.960, acc: 0.707: 100%|██████████| 91/91 [00:31<00:00,  2.85it/s]
Best model (head+MLP+last8Attn Stage 1) saved with accuracy: 0.7072
Stage 1 (head+MLP+last8Attn) finished. Best acc: 0.7072

=== QAT Stage 2 (6bit, head+MLP+last8Attn) ===
[train epoch 18] loss: 0.955, acc: 0.687: 100%|██████████| 366/366 [02:06<00:00,  2.88it/s]
[valid epoch 18] loss: 1.036, acc: 0.692: 100%|██████████| 91/91 [00:31<00:00,  2.85it/s]
Best model (head+MLP+last8Attn Stage 2) saved with accuracy: 0.6921
[train epoch 19] loss: 0.940, acc: 0.689: 100%|██████████| 366/366 [02:07<00:00,  2.87it/s]
[valid epoch 19] loss: 1.049, acc: 0.682: 100%|██████████| 91/91 [00:32<00:00,  2.80it/s]
[train epoch 20] loss: 0.936, acc: 0.698: 100%|██████████| 366/366 [02:08<00:00,  2.86it/s]
[valid epoch 20] loss: 1.034, acc: 0.693: 100%|██████████| 91/91 [00:32<00:00,  2.78it/s]
Best model (head+MLP+last8Attn Stage 2) saved with accuracy: 0.6928
[train epoch 21] loss: 0.916, acc: 0.699: 100%|██████████| 366/366 [02:07<00:00,  2.86it/s]
[valid epoch 21] loss: 0.975, acc: 0.707: 100%|██████████| 91/91 [00:32<00:00,  2.83it/s]
Best model (head+MLP+last8Attn Stage 2) saved with accuracy: 0.7065
[train epoch 22] loss: 0.894, acc: 0.700: 100%|██████████| 366/366 [02:07<00:00,  2.86it/s]
[valid epoch 22] loss: 0.988, acc: 0.704: 100%|██████████| 91/91 [00:32<00:00,  2.83it/s]
[train epoch 23] loss: 0.862, acc: 0.719: 100%|██████████| 366/366 [02:07<00:00,  2.86it/s]
[valid epoch 23] loss: 0.964, acc: 0.707: 100%|██████████| 91/91 [00:32<00:00,  2.82it/s]
[train epoch 24] loss: 0.842, acc: 0.727: 100%|██████████| 366/366 [02:08<00:00,  2.85it/s]
[valid epoch 24] loss: 0.946, acc: 0.718: 100%|██████████| 91/91 [00:32<00:00,  2.82it/s]
Best model (head+MLP+last8Attn Stage 2) saved with accuracy: 0.7182
[train epoch 25] loss: 0.828, acc: 0.734: 100%|██████████| 366/366 [02:07<00:00,  2.87it/s]
[valid epoch 25] loss: 0.918, acc: 0.740: 100%|██████████| 91/91 [00:32<00:00,  2.82it/s]
Best model (head+MLP+last8Attn Stage 2) saved with accuracy: 0.7395
[train epoch 26] loss: 0.820, acc: 0.733: 100%|██████████| 366/366 [02:07<00:00,  2.86it/s]
[valid epoch 26] loss: 0.908, acc: 0.736: 100%|██████████| 91/91 [00:32<00:00,  2.83it/s]
[train epoch 27] loss: 0.796, acc: 0.749: 100%|██████████| 366/366 [02:07<00:00,  2.87it/s]
[valid epoch 27] loss: 0.906, acc: 0.736: 100%|██████████| 91/91 [00:32<00:00,  2.82it/s]
[train epoch 28] loss: 0.793, acc: 0.744: 100%|██████████| 366/366 [02:07<00:00,  2.87it/s]
[valid epoch 28] loss: 0.906, acc: 0.731: 100%|██████████| 91/91 [00:32<00:00,  2.82it/s]
[train epoch 29] loss: 0.788, acc: 0.749: 100%|██████████| 366/366 [02:07<00:00,  2.86it/s]
[valid epoch 29] loss: 0.899, acc: 0.736: 100%|██████████| 91/91 [00:34<00:00,  2.61it/s]
Stage 2 (head+MLP+last8Attn) finished. Best acc: 0.7395

=== QAT Stage 3 (4bit, head+MLP+last8Attn) ===
[train epoch 30] loss: 1.583, acc: 0.480: 100%|██████████| 366/366 [02:14<00:00,  2.73it/s]
[valid epoch 30] loss: 1.449, acc: 0.561: 100%|██████████| 91/91 [00:32<00:00,  2.78it/s]
Best model (head+MLP+last8Attn Stage 3) saved with accuracy: 0.5608
[train epoch 31] loss: 1.299, acc: 0.568: 100%|██████████| 366/366 [02:13<00:00,  2.74it/s]
[valid epoch 31] loss: 1.364, acc: 0.586: 100%|██████████| 91/91 [00:32<00:00,  2.77it/s]
Best model (head+MLP+last8Attn Stage 3) saved with accuracy: 0.5856
[train epoch 32] loss: 1.208, acc: 0.602: 100%|██████████| 366/366 [02:12<00:00,  2.76it/s]
[valid epoch 32] loss: 1.255, acc: 0.614: 100%|██████████| 91/91 [00:32<00:00,  2.78it/s]
Best model (head+MLP+last8Attn Stage 3) saved with accuracy: 0.6144
[train epoch 33] loss: 1.150, acc: 0.615: 100%|██████████| 366/366 [02:35<00:00,  2.36it/s]
[valid epoch 33] loss: 1.282, acc: 0.610: 100%|██████████| 91/91 [00:34<00:00,  2.62it/s]
[train epoch 34] loss: 1.129, acc: 0.627: 100%|██████████| 366/366 [02:29<00:00,  2.44it/s]
[valid epoch 34] loss: 1.237, acc: 0.605: 100%|██████████| 91/91 [00:40<00:00,  2.22it/s]
[train epoch 35] loss: 1.097, acc: 0.640: 100%|██████████| 366/366 [02:42<00:00,  2.26it/s]
[valid epoch 35] loss: 1.204, acc: 0.636: 100%|██████████| 91/91 [00:35<00:00,  2.56it/s]
Best model (head+MLP+last8Attn Stage 3) saved with accuracy: 0.6357
[train epoch 36] loss: 1.059, acc: 0.651: 100%|██████████| 366/366 [02:40<00:00,  2.28it/s]
[valid epoch 36] loss: 1.175, acc: 0.636: 100%|██████████| 91/91 [00:37<00:00,  2.44it/s]
Best model (head+MLP+last8Attn Stage 3) saved with accuracy: 0.6364
[train epoch 37] loss: 1.046, acc: 0.648: 100%|██████████| 366/366 [02:42<00:00,  2.26it/s]
[valid epoch 37] loss: 1.160, acc: 0.633: 100%|██████████| 91/91 [00:40<00:00,  2.27it/s]
[train epoch 38] loss: 1.025, acc: 0.657: 100%|██████████| 366/366 [02:54<00:00,  2.09it/s]
[valid epoch 38] loss: 1.128, acc: 0.654: 100%|██████████| 91/91 [00:36<00:00,  2.46it/s]
Best model (head+MLP+last8Attn Stage 3) saved with accuracy: 0.6543
[train epoch 39] loss: 0.980, acc: 0.676: 100%|██████████| 366/366 [03:02<00:00,  2.00it/s]
[valid epoch 39] loss: 1.109, acc: 0.665: 100%|██████████| 91/91 [00:37<00:00,  2.43it/s]
Best model (head+MLP+last8Attn Stage 3) saved with accuracy: 0.6646
[train epoch 40] loss: 0.961, acc: 0.682: 100%|██████████| 366/366 [02:45<00:00,  2.22it/s]
[valid epoch 40] loss: 1.112, acc: 0.663: 100%|██████████| 91/91 [00:35<00:00,  2.55it/s]
[train epoch 41] loss: 0.949, acc: 0.686: 100%|██████████| 366/366 [02:52<00:00,  2.12it/s]
[valid epoch 41] loss: 1.097, acc: 0.659: 100%|██████████| 91/91 [00:34<00:00,  2.61it/s]
[train epoch 42] loss: 0.942, acc: 0.689: 100%|██████████| 366/366 [02:28<00:00,  2.47it/s]
[valid epoch 42] loss: 1.094, acc: 0.672: 100%|██████████| 91/91 [00:34<00:00,  2.61it/s]
Best model (head+MLP+last8Attn Stage 3) saved with accuracy: 0.6722
[train epoch 43] loss: 0.924, acc: 0.698: 100%|██████████| 366/366 [02:33<00:00,  2.39it/s]
[valid epoch 43] loss: 1.068, acc: 0.680: 100%|██████████| 91/91 [00:44<00:00,  2.05it/s]
Best model (head+MLP+last8Attn Stage 3) saved with accuracy: 0.6804
[train epoch 44] loss: 0.929, acc: 0.698: 100%|██████████| 366/366 [03:18<00:00,  1.84it/s]
[valid epoch 44] loss: 1.072, acc: 0.678: 100%|██████████| 91/91 [00:37<00:00,  2.41it/s]
[train epoch 45] loss: 0.908, acc: 0.706: 100%|██████████| 366/366 [02:42<00:00,  2.25it/s]
[valid epoch 45] loss: 1.068, acc: 0.676: 100%|██████████| 91/91 [00:42<00:00,  2.12it/s]
Stage 3 (head+MLP+last8Attn) finished. Best acc: 0.6804
Progressive QAT completed. Best validation accuracy: 0.7395

==== Sweep 9: head+MLP+last9Attn ====

=== QAT Stage 1 (8bit, head+MLP+last9Attn) ===
[train epoch 0] loss: 2.080, acc: 0.309: 100%|██████████| 366/366 [02:37<00:00,  2.33it/s]
[valid epoch 0] loss: 2.297, acc: 0.292: 100%|██████████| 91/91 [00:36<00:00,  2.49it/s]
Best model (head+MLP+last9Attn Stage 1) saved with accuracy: 0.2921
[train epoch 1] loss: 1.855, acc: 0.392: 100%|██████████| 366/366 [02:54<00:00,  2.09it/s]
[valid epoch 1] loss: 1.876, acc: 0.423: 100%|██████████| 91/91 [00:35<00:00,  2.56it/s]
Best model (head+MLP+last9Attn Stage 1) saved with accuracy: 0.4234
[train epoch 2] loss: 1.790, acc: 0.412: 100%|██████████| 366/366 [02:45<00:00,  2.21it/s]
[valid epoch 2] loss: 1.800, acc: 0.448: 100%|██████████| 91/91 [00:35<00:00,  2.53it/s]
Best model (head+MLP+last9Attn Stage 1) saved with accuracy: 0.4481
[train epoch 3] loss: 1.708, acc: 0.440: 100%|██████████| 366/366 [02:40<00:00,  2.28it/s]
[valid epoch 3] loss: 1.725, acc: 0.467: 100%|██████████| 91/91 [00:35<00:00,  2.53it/s]
Best model (head+MLP+last9Attn Stage 1) saved with accuracy: 0.4667
[train epoch 4] loss: 1.660, acc: 0.453: 100%|██████████| 366/366 [02:47<00:00,  2.18it/s]
[valid epoch 4] loss: 1.714, acc: 0.471: 100%|██████████| 91/91 [00:36<00:00,  2.52it/s]
Best model (head+MLP+last9Attn Stage 1) saved with accuracy: 0.4715
[train epoch 5] loss: 1.604, acc: 0.477: 100%|██████████| 366/366 [02:47<00:00,  2.19it/s]
[valid epoch 5] loss: 1.611, acc: 0.524: 100%|██████████| 91/91 [00:36<00:00,  2.48it/s]
Best model (head+MLP+last9Attn Stage 1) saved with accuracy: 0.5244
[train epoch 6] loss: 1.578, acc: 0.483: 100%|██████████| 366/366 [02:53<00:00,  2.11it/s]
[valid epoch 6] loss: 1.596, acc: 0.520: 100%|██████████| 91/91 [00:43<00:00,  2.09it/s]
[train epoch 7] loss: 1.517, acc: 0.498: 100%|██████████| 366/366 [03:10<00:00,  1.92it/s]
[valid epoch 7] loss: 1.589, acc: 0.516: 100%|██████████| 91/91 [00:37<00:00,  2.43it/s]
[train epoch 8] loss: 1.461, acc: 0.521: 100%|██████████| 366/366 [02:46<00:00,  2.20it/s]
[valid epoch 8] loss: 1.504, acc: 0.548: 100%|██████████| 91/91 [00:37<00:00,  2.44it/s]
Best model (head+MLP+last9Attn Stage 1) saved with accuracy: 0.5478
[train epoch 9] loss: 1.412, acc: 0.534: 100%|██████████| 366/366 [02:41<00:00,  2.26it/s]
[valid epoch 9] loss: 1.491, acc: 0.546: 100%|██████████| 91/91 [00:36<00:00,  2.52it/s]
[train epoch 10] loss: 1.346, acc: 0.556: 100%|██████████| 366/366 [02:37<00:00,  2.32it/s]
[valid epoch 10] loss: 1.391, acc: 0.570: 100%|██████████| 91/91 [00:37<00:00,  2.45it/s]
Best model (head+MLP+last9Attn Stage 1) saved with accuracy: 0.5698
[train epoch 11] loss: 1.283, acc: 0.575: 100%|██████████| 366/366 [02:47<00:00,  2.19it/s]
[valid epoch 11] loss: 1.356, acc: 0.594: 100%|██████████| 91/91 [00:36<00:00,  2.49it/s]
Best model (head+MLP+last9Attn Stage 1) saved with accuracy: 0.5938
[train epoch 12] loss: 1.242, acc: 0.589: 100%|██████████| 366/366 [02:47<00:00,  2.18it/s]
[valid epoch 12] loss: 1.335, acc: 0.597: 100%|██████████| 91/91 [00:37<00:00,  2.44it/s]
Best model (head+MLP+last9Attn Stage 1) saved with accuracy: 0.5966
[train epoch 13] loss: 1.198, acc: 0.604: 100%|██████████| 366/366 [03:11<00:00,  1.91it/s]
[valid epoch 13] loss: 1.281, acc: 0.616: 100%|██████████| 91/91 [00:37<00:00,  2.40it/s]
Best model (head+MLP+last9Attn Stage 1) saved with accuracy: 0.6165
[train epoch 14] loss: 1.156, acc: 0.615: 100%|██████████| 366/366 [02:44<00:00,  2.22it/s]
[valid epoch 14] loss: 1.219, acc: 0.630: 100%|██████████| 91/91 [00:37<00:00,  2.41it/s]
Best model (head+MLP+last9Attn Stage 1) saved with accuracy: 0.6296
[train epoch 15] loss: 1.130, acc: 0.626: 100%|██████████| 366/366 [02:59<00:00,  2.04it/s]
[valid epoch 15] loss: 1.206, acc: 0.638: 100%|██████████| 91/91 [00:35<00:00,  2.55it/s]
Best model (head+MLP+last9Attn Stage 1) saved with accuracy: 0.6378
[train epoch 16] loss: 1.088, acc: 0.639: 100%|██████████| 366/366 [02:41<00:00,  2.27it/s]
[valid epoch 16] loss: 1.204, acc: 0.630: 100%|██████████| 91/91 [00:35<00:00,  2.56it/s]
[train epoch 17] loss: 1.076, acc: 0.647: 100%|██████████| 366/366 [02:34<00:00,  2.37it/s]
[valid epoch 17] loss: 1.176, acc: 0.639: 100%|██████████| 91/91 [00:35<00:00,  2.57it/s]
Best model (head+MLP+last9Attn Stage 1) saved with accuracy: 0.6392
Stage 1 (head+MLP+last9Attn) finished. Best acc: 0.6392

=== QAT Stage 2 (6bit, head+MLP+last9Attn) ===
[train epoch 18] loss: 1.178, acc: 0.607: 100%|██████████| 366/366 [02:34<00:00,  2.37it/s]
[valid epoch 18] loss: 1.230, acc: 0.634: 100%|██████████| 91/91 [00:35<00:00,  2.57it/s]
Best model (head+MLP+last9Attn Stage 2) saved with accuracy: 0.6337
[train epoch 19] loss: 1.154, acc: 0.619: 100%|██████████| 366/366 [02:34<00:00,  2.36it/s]
[valid epoch 19] loss: 1.206, acc: 0.629: 100%|██████████| 91/91 [00:35<00:00,  2.55it/s]
[train epoch 20] loss: 1.143, acc: 0.615: 100%|██████████| 366/366 [02:36<00:00,  2.35it/s]
[valid epoch 20] loss: 1.205, acc: 0.642: 100%|██████████| 91/91 [00:37<00:00,  2.42it/s]
Best model (head+MLP+last9Attn Stage 2) saved with accuracy: 0.6419
[train epoch 21] loss: 1.116, acc: 0.633: 100%|██████████| 366/366 [05:43<00:00,  1.06it/s]
[valid epoch 21] loss: 1.197, acc: 0.630: 100%|██████████| 91/91 [00:47<00:00,  1.92it/s]
[train epoch 22] loss: 1.095, acc: 0.642: 100%|██████████| 366/366 [03:42<00:00,  1.65it/s]
[valid epoch 22] loss: 1.208, acc: 0.630: 100%|██████████| 91/91 [00:43<00:00,  2.08it/s]
[train epoch 23] loss: 1.085, acc: 0.639: 100%|██████████| 366/366 [03:44<00:00,  1.63it/s]
[valid epoch 23] loss: 1.195, acc: 0.643: 100%|██████████| 91/91 [00:46<00:00,  1.97it/s]
Best model (head+MLP+last9Attn Stage 2) saved with accuracy: 0.6426
[train epoch 24] loss: 1.059, acc: 0.654: 100%|██████████| 366/366 [03:49<00:00,  1.60it/s]
[valid epoch 24] loss: 1.147, acc: 0.650: 100%|██████████| 91/91 [01:03<00:00,  1.42it/s]
Best model (head+MLP+last9Attn Stage 2) saved with accuracy: 0.6502
[train epoch 25] loss: 1.024, acc: 0.662: 100%|██████████| 366/366 [04:35<00:00,  1.33it/s]
[valid epoch 25] loss: 1.149, acc: 0.650: 100%|██████████| 91/91 [00:46<00:00,  1.98it/s]
[train epoch 26] loss: 1.018, acc: 0.664: 100%|██████████| 366/366 [03:52<00:00,  1.58it/s]
[valid epoch 26] loss: 1.121, acc: 0.665: 100%|██████████| 91/91 [00:40<00:00,  2.26it/s]
Best model (head+MLP+last9Attn Stage 2) saved with accuracy: 0.6646
[train epoch 27] loss: 0.993, acc: 0.672: 100%|██████████| 366/366 [03:18<00:00,  1.84it/s]
[valid epoch 27] loss: 1.118, acc: 0.663: 100%|██████████| 91/91 [00:41<00:00,  2.18it/s]
[train epoch 28] loss: 0.981, acc: 0.681: 100%|██████████| 366/366 [02:56<00:00,  2.08it/s]
[valid epoch 28] loss: 1.115, acc: 0.665: 100%|██████████| 91/91 [00:29<00:00,  3.08it/s]
[train epoch 29] loss: 0.962, acc: 0.685: 100%|██████████| 366/366 [01:54<00:00,  3.18it/s]
[valid epoch 29] loss: 1.112, acc: 0.665: 100%|██████████| 91/91 [00:29<00:00,  3.04it/s]
Best model (head+MLP+last9Attn Stage 2) saved with accuracy: 0.6653
Stage 2 (head+MLP+last9Attn) finished. Best acc: 0.6653

=== QAT Stage 3 (4bit, head+MLP+last9Attn) ===
[train epoch 30] loss: 1.753, acc: 0.428: 100%|██████████| 366/366 [01:55<00:00,  3.18it/s]
[valid epoch 30] loss: 1.588, acc: 0.522: 100%|██████████| 91/91 [00:30<00:00,  3.02it/s]
Best model (head+MLP+last9Attn Stage 3) saved with accuracy: 0.5223
[train epoch 31] loss: 1.480, acc: 0.509: 100%|██████████| 366/366 [01:55<00:00,  3.18it/s]
[valid epoch 31] loss: 1.511, acc: 0.536: 100%|██████████| 91/91 [00:29<00:00,  3.03it/s]
Best model (head+MLP+last9Attn Stage 3) saved with accuracy: 0.5361
[train epoch 32] loss: 1.420, acc: 0.527: 100%|██████████| 366/366 [01:54<00:00,  3.18it/s]
[valid epoch 32] loss: 1.458, acc: 0.550: 100%|██████████| 91/91 [00:29<00:00,  3.04it/s]
Best model (head+MLP+last9Attn Stage 3) saved with accuracy: 0.5498
[train epoch 33] loss: 1.366, acc: 0.547: 100%|██████████| 366/366 [01:55<00:00,  3.18it/s]
[valid epoch 33] loss: 1.467, acc: 0.555: 100%|██████████| 91/91 [00:29<00:00,  3.05it/s]
Best model (head+MLP+last9Attn Stage 3) saved with accuracy: 0.5546
[train epoch 34] loss: 1.358, acc: 0.552: 100%|██████████| 366/366 [01:54<00:00,  3.19it/s]
[valid epoch 34] loss: 1.415, acc: 0.585: 100%|██████████| 91/91 [00:29<00:00,  3.05it/s]
Best model (head+MLP+last9Attn Stage 3) saved with accuracy: 0.5849
[train epoch 35] loss: 1.305, acc: 0.568: 100%|██████████| 366/366 [01:54<00:00,  3.19it/s]
[valid epoch 35] loss: 1.400, acc: 0.577: 100%|██████████| 91/91 [00:30<00:00,  3.03it/s]
[train epoch 36] loss: 1.290, acc: 0.571: 100%|██████████| 366/366 [01:54<00:00,  3.19it/s]
[valid epoch 36] loss: 1.377, acc: 0.577: 100%|██████████| 91/91 [00:29<00:00,  3.06it/s]
[train epoch 37] loss: 1.262, acc: 0.576: 100%|██████████| 366/366 [01:54<00:00,  3.19it/s]
[valid epoch 37] loss: 1.324, acc: 0.601: 100%|██████████| 91/91 [00:29<00:00,  3.07it/s]
Best model (head+MLP+last9Attn Stage 3) saved with accuracy: 0.6007
[train epoch 38] loss: 1.220, acc: 0.596: 100%|██████████| 366/366 [01:54<00:00,  3.19it/s]
[valid epoch 38] loss: 1.333, acc: 0.592: 100%|██████████| 91/91 [00:31<00:00,  2.89it/s]
[train epoch 39] loss: 1.206, acc: 0.601: 100%|██████████| 366/366 [01:54<00:00,  3.20it/s]
[valid epoch 39] loss: 1.339, acc: 0.594: 100%|██████████| 91/91 [00:29<00:00,  3.10it/s]
[train epoch 40] loss: 1.196, acc: 0.606: 100%|██████████| 366/366 [01:54<00:00,  3.20it/s]
[valid epoch 40] loss: 1.295, acc: 0.607: 100%|██████████| 91/91 [00:29<00:00,  3.07it/s]
Best model (head+MLP+last9Attn Stage 3) saved with accuracy: 0.6069
[train epoch 41] loss: 1.174, acc: 0.615: 100%|██████████| 366/366 [01:54<00:00,  3.20it/s]
[valid epoch 41] loss: 1.262, acc: 0.616: 100%|██████████| 91/91 [00:29<00:00,  3.07it/s]
Best model (head+MLP+last9Attn Stage 3) saved with accuracy: 0.6165
[train epoch 42] loss: 1.153, acc: 0.620: 100%|██████████| 366/366 [01:54<00:00,  3.20it/s]
[valid epoch 42] loss: 1.264, acc: 0.609: 100%|██████████| 91/91 [00:29<00:00,  3.03it/s]
[train epoch 43] loss: 1.148, acc: 0.620: 100%|██████████| 366/366 [01:55<00:00,  3.18it/s]
[valid epoch 43] loss: 1.266, acc: 0.617: 100%|██████████| 91/91 [00:29<00:00,  3.07it/s]
Best model (head+MLP+last9Attn Stage 3) saved with accuracy: 0.6172
[train epoch 44] loss: 1.129, acc: 0.629: 100%|██████████| 366/366 [01:54<00:00,  3.20it/s]
[valid epoch 44] loss: 1.257, acc: 0.609: 100%|██████████| 91/91 [00:29<00:00,  3.07it/s]
[train epoch 45] loss: 1.133, acc: 0.629: 100%|██████████| 366/366 [01:54<00:00,  3.20it/s]
[valid epoch 45] loss: 1.257, acc: 0.612: 100%|██████████| 91/91 [00:29<00:00,  3.05it/s]
Stage 3 (head+MLP+last9Attn) finished. Best acc: 0.6172
Progressive QAT completed. Best validation accuracy: 0.6653

==== Sweep 10: head+MLP+last10Attn ====

=== QAT Stage 1 (8bit, head+MLP+last10Attn) ===
[train epoch 0] loss: 2.221, acc: 0.259: 100%|██████████| 366/366 [01:55<00:00,  3.16it/s]
[valid epoch 0] loss: 2.218, acc: 0.310: 100%|██████████| 91/91 [00:30<00:00,  3.03it/s]
Best model (head+MLP+last10Attn Stage 1) saved with accuracy: 0.3100
[train epoch 1] loss: 2.057, acc: 0.308: 100%|██████████| 366/366 [01:55<00:00,  3.16it/s]
[valid epoch 1] loss: 2.161, acc: 0.301: 100%|██████████| 91/91 [00:30<00:00,  3.01it/s]
[train epoch 2] loss: 1.989, acc: 0.344: 100%|██████████| 366/366 [01:55<00:00,  3.16it/s]
[valid epoch 2] loss: 1.982, acc: 0.371: 100%|██████████| 91/91 [00:29<00:00,  3.04it/s]
Best model (head+MLP+last10Attn Stage 1) saved with accuracy: 0.3711
[train epoch 3] loss: 1.938, acc: 0.365: 100%|██████████| 366/366 [01:55<00:00,  3.16it/s]
[valid epoch 3] loss: 1.908, acc: 0.400: 100%|██████████| 91/91 [00:30<00:00,  3.02it/s]
Best model (head+MLP+last10Attn Stage 1) saved with accuracy: 0.4000
[train epoch 4] loss: 1.878, acc: 0.380: 100%|██████████| 366/366 [01:55<00:00,  3.16it/s]
[valid epoch 4] loss: 1.987, acc: 0.385: 100%|██████████| 91/91 [00:30<00:00,  3.03it/s]
[train epoch 5] loss: 1.857, acc: 0.385: 100%|██████████| 366/366 [01:59<00:00,  3.07it/s]
[valid epoch 5] loss: 1.909, acc: 0.402: 100%|██████████| 91/91 [00:30<00:00,  3.02it/s]
Best model (head+MLP+last10Attn Stage 1) saved with accuracy: 0.4021
[train epoch 6] loss: 1.824, acc: 0.402: 100%|██████████| 366/366 [01:51<00:00,  3.28it/s]
[valid epoch 6] loss: 1.908, acc: 0.405: 100%|██████████| 91/91 [00:29<00:00,  3.09it/s]
Best model (head+MLP+last10Attn Stage 1) saved with accuracy: 0.4055
[train epoch 7] loss: 1.765, acc: 0.412: 100%|██████████| 366/366 [01:51<00:00,  3.28it/s]
[valid epoch 7] loss: 1.854, acc: 0.418: 100%|██████████| 91/91 [00:29<00:00,  3.10it/s]
Best model (head+MLP+last10Attn Stage 1) saved with accuracy: 0.4179
[train epoch 8] loss: 1.729, acc: 0.437: 100%|██████████| 366/366 [01:51<00:00,  3.28it/s]
[valid epoch 8] loss: 1.808, acc: 0.439: 100%|██████████| 91/91 [00:29<00:00,  3.09it/s]
Best model (head+MLP+last10Attn Stage 1) saved with accuracy: 0.4392
[train epoch 9] loss: 1.671, acc: 0.456: 100%|██████████| 366/366 [01:51<00:00,  3.28it/s]
[valid epoch 9] loss: 1.765, acc: 0.452: 100%|██████████| 91/91 [00:29<00:00,  3.11it/s]
Best model (head+MLP+last10Attn Stage 1) saved with accuracy: 0.4522
[train epoch 10] loss: 1.605, acc: 0.457: 100%|██████████| 366/366 [01:51<00:00,  3.29it/s]
[valid epoch 10] loss: 1.764, acc: 0.460: 100%|██████████| 91/91 [00:29<00:00,  3.10it/s]
Best model (head+MLP+last10Attn Stage 1) saved with accuracy: 0.4605
[train epoch 11] loss: 1.553, acc: 0.489: 100%|██████████| 366/366 [01:51<00:00,  3.28it/s]
[valid epoch 11] loss: 1.617, acc: 0.497: 100%|██████████| 91/91 [00:29<00:00,  3.11it/s]
Best model (head+MLP+last10Attn Stage 1) saved with accuracy: 0.4969
[train epoch 12] loss: 1.493, acc: 0.509: 100%|██████████| 366/366 [01:51<00:00,  3.28it/s]
[valid epoch 12] loss: 1.582, acc: 0.518: 100%|██████████| 91/91 [00:29<00:00,  3.10it/s]
Best model (head+MLP+last10Attn Stage 1) saved with accuracy: 0.5175
[train epoch 13] loss: 1.439, acc: 0.524: 100%|██████████| 366/366 [01:51<00:00,  3.28it/s]
[valid epoch 13] loss: 1.569, acc: 0.527: 100%|██████████| 91/91 [00:29<00:00,  3.10it/s]
Best model (head+MLP+last10Attn Stage 1) saved with accuracy: 0.5271
[train epoch 14] loss: 1.401, acc: 0.538: 100%|██████████| 366/366 [01:51<00:00,  3.28it/s]
[valid epoch 14] loss: 1.529, acc: 0.538: 100%|██████████| 91/91 [00:29<00:00,  3.10it/s]
Best model (head+MLP+last10Attn Stage 1) saved with accuracy: 0.5381
[train epoch 15] loss: 1.371, acc: 0.546: 100%|██████████| 366/366 [01:51<00:00,  3.28it/s]
[valid epoch 15] loss: 1.527, acc: 0.533: 100%|██████████| 91/91 [00:29<00:00,  3.09it/s]
[train epoch 16] loss: 1.352, acc: 0.553: 100%|██████████| 366/366 [01:51<00:00,  3.28it/s]
[valid epoch 16] loss: 1.507, acc: 0.547: 100%|██████████| 91/91 [00:29<00:00,  3.11it/s]
Best model (head+MLP+last10Attn Stage 1) saved with accuracy: 0.5471
[train epoch 17] loss: 1.340, acc: 0.554: 100%|██████████| 366/366 [01:51<00:00,  3.28it/s]
[valid epoch 17] loss: 1.487, acc: 0.551: 100%|██████████| 91/91 [00:29<00:00,  3.10it/s]
Best model (head+MLP+last10Attn Stage 1) saved with accuracy: 0.5512
Stage 1 (head+MLP+last10Attn) finished. Best acc: 0.5512

=== QAT Stage 2 (6bit, head+MLP+last10Attn) ===
[train epoch 18] loss: 1.413, acc: 0.532: 100%|██████████| 366/366 [01:51<00:00,  3.27it/s]
[valid epoch 18] loss: 1.507, acc: 0.542: 100%|██████████| 91/91 [00:29<00:00,  3.10it/s]
Best model (head+MLP+last10Attn Stage 2) saved with accuracy: 0.5423
[train epoch 19] loss: 1.390, acc: 0.545: 100%|██████████| 366/366 [01:51<00:00,  3.27it/s]
[valid epoch 19] loss: 1.531, acc: 0.539: 100%|██████████| 91/91 [00:29<00:00,  3.10it/s]
[train epoch 20] loss: 1.376, acc: 0.541: 100%|██████████| 366/366 [01:51<00:00,  3.27it/s]
[valid epoch 20] loss: 1.477, acc: 0.551: 100%|██████████| 91/91 [00:29<00:00,  3.09it/s]
Best model (head+MLP+last10Attn Stage 2) saved with accuracy: 0.5512
[train epoch 21] loss: 1.378, acc: 0.542: 100%|██████████| 366/366 [01:51<00:00,  3.28it/s]
[valid epoch 21] loss: 1.463, acc: 0.559: 100%|██████████| 91/91 [00:29<00:00,  3.10it/s]
Best model (head+MLP+last10Attn Stage 2) saved with accuracy: 0.5588
[train epoch 22] loss: 1.333, acc: 0.556: 100%|██████████| 366/366 [01:51<00:00,  3.27it/s]
[valid epoch 22] loss: 1.471, acc: 0.555: 100%|██████████| 91/91 [00:29<00:00,  3.11it/s]
[train epoch 23] loss: 1.309, acc: 0.571: 100%|██████████| 366/366 [01:51<00:00,  3.27it/s]
[valid epoch 23] loss: 1.450, acc: 0.558: 100%|██████████| 91/91 [00:29<00:00,  3.11it/s]
[train epoch 24] loss: 1.285, acc: 0.572: 100%|██████████| 366/366 [01:51<00:00,  3.27it/s]
[valid epoch 24] loss: 1.428, acc: 0.574: 100%|██████████| 91/91 [00:29<00:00,  3.10it/s]
Best model (head+MLP+last10Attn Stage 2) saved with accuracy: 0.5739
[train epoch 25] loss: 1.280, acc: 0.579: 100%|██████████| 366/366 [01:51<00:00,  3.28it/s]
[valid epoch 25] loss: 1.406, acc: 0.575: 100%|██████████| 91/91 [00:29<00:00,  3.10it/s]
Best model (head+MLP+last10Attn Stage 2) saved with accuracy: 0.5753
[train epoch 26] loss: 1.256, acc: 0.588: 100%|██████████| 366/366 [01:51<00:00,  3.28it/s]
[valid epoch 26] loss: 1.399, acc: 0.578: 100%|██████████| 91/91 [00:29<00:00,  3.10it/s]
Best model (head+MLP+last10Attn Stage 2) saved with accuracy: 0.5780
[train epoch 27] loss: 1.229, acc: 0.596: 100%|██████████| 366/366 [01:51<00:00,  3.27it/s]
[valid epoch 27] loss: 1.392, acc: 0.584: 100%|██████████| 91/91 [00:29<00:00,  3.10it/s]
Best model (head+MLP+last10Attn Stage 2) saved with accuracy: 0.5842
[train epoch 28] loss: 1.228, acc: 0.597: 100%|██████████| 366/366 [01:51<00:00,  3.28it/s]
[valid epoch 28] loss: 1.386, acc: 0.580: 100%|██████████| 91/91 [00:29<00:00,  3.09it/s]
[train epoch 29] loss: 1.235, acc: 0.586: 100%|██████████| 366/366 [01:51<00:00,  3.28it/s]
[valid epoch 29] loss: 1.383, acc: 0.583: 100%|██████████| 91/91 [00:29<00:00,  3.10it/s]
Stage 2 (head+MLP+last10Attn) finished. Best acc: 0.5842

=== QAT Stage 3 (4bit, head+MLP+last10Attn) ===
[train epoch 30] loss: 1.902, acc: 0.385: 100%|██████████| 366/366 [01:51<00:00,  3.28it/s]
[valid epoch 30] loss: 1.838, acc: 0.436: 100%|██████████| 91/91 [00:29<00:00,  3.10it/s]
Best model (head+MLP+last10Attn Stage 3) saved with accuracy: 0.4364
[train epoch 31] loss: 1.704, acc: 0.440: 100%|██████████| 366/366 [01:51<00:00,  3.27it/s]
[valid epoch 31] loss: 1.783, acc: 0.441: 100%|██████████| 91/91 [00:29<00:00,  3.10it/s]
Best model (head+MLP+last10Attn Stage 3) saved with accuracy: 0.4412
[train epoch 32] loss: 1.635, acc: 0.459: 100%|██████████| 366/366 [01:51<00:00,  3.28it/s]
[valid epoch 32] loss: 1.709, acc: 0.482: 100%|██████████| 91/91 [00:29<00:00,  3.07it/s]
Best model (head+MLP+last10Attn Stage 3) saved with accuracy: 0.4825
[train epoch 33] loss: 1.601, acc: 0.470: 100%|██████████| 366/366 [01:51<00:00,  3.28it/s]
[valid epoch 33] loss: 1.722, acc: 0.464: 100%|██████████| 91/91 [00:29<00:00,  3.08it/s]
[train epoch 34] loss: 1.552, acc: 0.487: 100%|██████████| 366/366 [01:51<00:00,  3.28it/s]
[valid epoch 34] loss: 1.669, acc: 0.489: 100%|██████████| 91/91 [00:29<00:00,  3.09it/s]
Best model (head+MLP+last10Attn Stage 3) saved with accuracy: 0.4893
[train epoch 35] loss: 1.522, acc: 0.499: 100%|██████████| 366/366 [01:51<00:00,  3.27it/s]
[valid epoch 35] loss: 1.665, acc: 0.487: 100%|██████████| 91/91 [00:29<00:00,  3.11it/s]
[train epoch 36] loss: 1.476, acc: 0.518: 100%|██████████| 366/366 [01:51<00:00,  3.27it/s]
[valid epoch 36] loss: 1.588, acc: 0.501: 100%|██████████| 91/91 [00:29<00:00,  3.10it/s]
Best model (head+MLP+last10Attn Stage 3) saved with accuracy: 0.5010
[train epoch 37] loss: 1.471, acc: 0.518: 100%|██████████| 366/366 [01:51<00:00,  3.28it/s]
[valid epoch 37] loss: 1.602, acc: 0.517: 100%|██████████| 91/91 [00:29<00:00,  3.10it/s]
Best model (head+MLP+last10Attn Stage 3) saved with accuracy: 0.5168
[train epoch 38] loss: 1.442, acc: 0.525: 100%|██████████| 366/366 [01:51<00:00,  3.27it/s]
[valid epoch 38] loss: 1.574, acc: 0.525: 100%|██████████| 91/91 [00:29<00:00,  3.12it/s]
Best model (head+MLP+last10Attn Stage 3) saved with accuracy: 0.5251
[train epoch 39] loss: 1.423, acc: 0.532: 100%|██████████| 366/366 [01:51<00:00,  3.27it/s]
[valid epoch 39] loss: 1.579, acc: 0.521: 100%|██████████| 91/91 [00:29<00:00,  3.10it/s]
[train epoch 40] loss: 1.389, acc: 0.541: 100%|██████████| 366/366 [01:51<00:00,  3.27it/s]
[valid epoch 40] loss: 1.547, acc: 0.528: 100%|██████████| 91/91 [00:29<00:00,  3.10it/s]
Best model (head+MLP+last10Attn Stage 3) saved with accuracy: 0.5278
[train epoch 41] loss: 1.376, acc: 0.540: 100%|██████████| 366/366 [01:51<00:00,  3.27it/s]
[valid epoch 41] loss: 1.553, acc: 0.527: 100%|██████████| 91/91 [00:29<00:00,  3.12it/s]
[train epoch 42] loss: 1.366, acc: 0.547: 100%|██████████| 366/366 [01:51<00:00,  3.28it/s]
[valid epoch 42] loss: 1.538, acc: 0.533: 100%|██████████| 91/91 [00:29<00:00,  3.09it/s]
Best model (head+MLP+last10Attn Stage 3) saved with accuracy: 0.5326
[train epoch 43] loss: 1.350, acc: 0.551: 100%|██████████| 366/366 [01:51<00:00,  3.28it/s]
[valid epoch 43] loss: 1.513, acc: 0.533: 100%|██████████| 91/91 [00:29<00:00,  3.08it/s]
[train epoch 44] loss: 1.339, acc: 0.562: 100%|██████████| 366/366 [01:51<00:00,  3.27it/s]
[valid epoch 44] loss: 1.518, acc: 0.532: 100%|██████████| 91/91 [00:29<00:00,  3.10it/s]
[train epoch 45] loss: 1.328, acc: 0.562: 100%|██████████| 366/366 [01:51<00:00,  3.27it/s]
[valid epoch 45] loss: 1.516, acc: 0.529: 100%|██████████| 91/91 [00:29<00:00,  3.11it/s]
Stage 3 (head+MLP+last10Attn) finished. Best acc: 0.5326
Progressive QAT completed. Best validation accuracy: 0.5842

==== Sweep 11: head+MLP+last11Attn ====

=== QAT Stage 1 (8bit, head+MLP+last11Attn) ===
[train epoch 0] loss: 2.247, acc: 0.248: 100%|██████████| 366/366 [01:52<00:00,  3.25it/s]
[valid epoch 0] loss: 2.227, acc: 0.302: 100%|██████████| 91/91 [00:29<00:00,  3.10it/s]
Best model (head+MLP+last11Attn Stage 1) saved with accuracy: 0.3024
[train epoch 1] loss: 2.102, acc: 0.305: 100%|██████████| 366/366 [01:52<00:00,  3.25it/s]
[valid epoch 1] loss: 2.297, acc: 0.255: 100%|██████████| 91/91 [00:29<00:00,  3.07it/s]
[train epoch 2] loss: 2.038, acc: 0.317: 100%|██████████| 366/366 [01:52<00:00,  3.25it/s]
[valid epoch 2] loss: 2.153, acc: 0.310: 100%|██████████| 91/91 [00:29<00:00,  3.08it/s]
Best model (head+MLP+last11Attn Stage 1) saved with accuracy: 0.3100
[train epoch 3] loss: 2.001, acc: 0.336: 100%|██████████| 366/366 [01:52<00:00,  3.25it/s]
[valid epoch 3] loss: 2.103, acc: 0.337: 100%|██████████| 91/91 [00:29<00:00,  3.05it/s]
Best model (head+MLP+last11Attn Stage 1) saved with accuracy: 0.3375
[train epoch 4] loss: 1.978, acc: 0.350: 100%|██████████| 366/366 [01:52<00:00,  3.25it/s]
[valid epoch 4] loss: 2.157, acc: 0.333: 100%|██████████| 91/91 [00:29<00:00,  3.06it/s]
[train epoch 5] loss: 1.933, acc: 0.352: 100%|██████████| 366/366 [01:52<00:00,  3.25it/s]
[valid epoch 5] loss: 2.033, acc: 0.381: 100%|██████████| 91/91 [00:29<00:00,  3.08it/s]
Best model (head+MLP+last11Attn Stage 1) saved with accuracy: 0.3814
[train epoch 6] loss: 1.917, acc: 0.362: 100%|██████████| 366/366 [01:52<00:00,  3.25it/s]
[valid epoch 6] loss: 2.003, acc: 0.372: 100%|██████████| 91/91 [00:29<00:00,  3.07it/s]
[train epoch 7] loss: 1.859, acc: 0.386: 100%|██████████| 366/366 [01:52<00:00,  3.25it/s]
[valid epoch 7] loss: 1.909, acc: 0.388: 100%|██████████| 91/91 [00:29<00:00,  3.08it/s]
Best model (head+MLP+last11Attn Stage 1) saved with accuracy: 0.3883
[train epoch 8] loss: 1.840, acc: 0.396: 100%|██████████| 366/366 [01:52<00:00,  3.26it/s]
[valid epoch 8] loss: 1.953, acc: 0.390: 100%|██████████| 91/91 [00:30<00:00,  3.03it/s]
Best model (head+MLP+last11Attn Stage 1) saved with accuracy: 0.3904
[train epoch 9] loss: 1.786, acc: 0.412: 100%|██████████| 366/366 [01:52<00:00,  3.25it/s]
[valid epoch 9] loss: 1.857, acc: 0.419: 100%|██████████| 91/91 [00:29<00:00,  3.07it/s]
Best model (head+MLP+last11Attn Stage 1) saved with accuracy: 0.4186
[train epoch 10] loss: 1.733, acc: 0.426: 100%|██████████| 366/366 [01:52<00:00,  3.25it/s]
[valid epoch 10] loss: 1.824, acc: 0.436: 100%|██████████| 91/91 [00:29<00:00,  3.08it/s]
Best model (head+MLP+last11Attn Stage 1) saved with accuracy: 0.4357
[train epoch 11] loss: 1.682, acc: 0.441: 100%|██████████| 366/366 [01:52<00:00,  3.25it/s]
[valid epoch 11] loss: 1.840, acc: 0.432: 100%|██████████| 91/91 [00:29<00:00,  3.08it/s]
[train epoch 12] loss: 1.632, acc: 0.462: 100%|██████████| 366/366 [01:52<00:00,  3.25it/s]
[valid epoch 12] loss: 1.753, acc: 0.457: 100%|██████████| 91/91 [00:29<00:00,  3.08it/s]
Best model (head+MLP+last11Attn Stage 1) saved with accuracy: 0.4570
[train epoch 13] loss: 1.592, acc: 0.475: 100%|██████████| 366/366 [01:52<00:00,  3.25it/s]
[valid epoch 13] loss: 1.770, acc: 0.456: 100%|██████████| 91/91 [00:29<00:00,  3.07it/s]
[train epoch 14] loss: 1.554, acc: 0.480: 100%|██████████| 366/366 [01:52<00:00,  3.25it/s]
[valid epoch 14] loss: 1.710, acc: 0.466: 100%|██████████| 91/91 [00:29<00:00,  3.08it/s]
Best model (head+MLP+last11Attn Stage 1) saved with accuracy: 0.4660
[train epoch 15] loss: 1.510, acc: 0.493: 100%|██████████| 366/366 [01:52<00:00,  3.25it/s]
[valid epoch 15] loss: 1.686, acc: 0.485: 100%|██████████| 91/91 [00:29<00:00,  3.08it/s]
Best model (head+MLP+last11Attn Stage 1) saved with accuracy: 0.4852
[train epoch 16] loss: 1.480, acc: 0.506: 100%|██████████| 366/366 [01:52<00:00,  3.25it/s]
[valid epoch 16] loss: 1.673, acc: 0.485: 100%|██████████| 91/91 [00:29<00:00,  3.07it/s]
[train epoch 17] loss: 1.469, acc: 0.508: 100%|██████████| 366/366 [01:52<00:00,  3.25it/s]
[valid epoch 17] loss: 1.673, acc: 0.482: 100%|██████████| 91/91 [00:29<00:00,  3.07it/s]
Stage 1 (head+MLP+last11Attn) finished. Best acc: 0.4852

=== QAT Stage 2 (6bit, head+MLP+last11Attn) ===
[train epoch 18] loss: 1.558, acc: 0.485: 100%|██████████| 366/366 [01:52<00:00,  3.25it/s]
[valid epoch 18] loss: 1.737, acc: 0.466: 100%|██████████| 91/91 [00:29<00:00,  3.08it/s]
Best model (head+MLP+last11Attn Stage 2) saved with accuracy: 0.4660
[train epoch 19] loss: 1.538, acc: 0.480: 100%|██████████| 366/366 [01:52<00:00,  3.25it/s]
[valid epoch 19] loss: 1.722, acc: 0.473: 100%|██████████| 91/91 [00:29<00:00,  3.08it/s]
Best model (head+MLP+last11Attn Stage 2) saved with accuracy: 0.4729
[train epoch 20] loss: 1.515, acc: 0.493: 100%|██████████| 366/366 [01:52<00:00,  3.25it/s]
[valid epoch 20] loss: 1.697, acc: 0.485: 100%|██████████| 91/91 [00:29<00:00,  3.08it/s]
Best model (head+MLP+last11Attn Stage 2) saved with accuracy: 0.4845
[train epoch 21] loss: 1.508, acc: 0.497: 100%|██████████| 366/366 [01:52<00:00,  3.25it/s]
[valid epoch 21] loss: 1.685, acc: 0.479: 100%|██████████| 91/91 [00:29<00:00,  3.09it/s]
[train epoch 22] loss: 1.494, acc: 0.493: 100%|██████████| 366/366 [01:52<00:00,  3.25it/s]
[valid epoch 22] loss: 1.668, acc: 0.480: 100%|██████████| 91/91 [00:29<00:00,  3.09it/s]
[train epoch 23] loss: 1.479, acc: 0.503: 100%|██████████| 366/366 [01:52<00:00,  3.25it/s]
[valid epoch 23] loss: 1.650, acc: 0.498: 100%|██████████| 91/91 [00:29<00:00,  3.08it/s]
Best model (head+MLP+last11Attn Stage 2) saved with accuracy: 0.4983
[train epoch 24] loss: 1.451, acc: 0.516: 100%|██████████| 366/366 [01:52<00:00,  3.25it/s]
[valid epoch 24] loss: 1.646, acc: 0.500: 100%|██████████| 91/91 [00:29<00:00,  3.09it/s]
Best model (head+MLP+last11Attn Stage 2) saved with accuracy: 0.4997
[train epoch 25] loss: 1.426, acc: 0.516: 100%|██████████| 366/366 [01:52<00:00,  3.25it/s]
[valid epoch 25] loss: 1.625, acc: 0.502: 100%|██████████| 91/91 [00:29<00:00,  3.07it/s]
Best model (head+MLP+last11Attn Stage 2) saved with accuracy: 0.5024
[train epoch 26] loss: 1.411, acc: 0.524: 100%|██████████| 366/366 [01:52<00:00,  3.25it/s]
[valid epoch 26] loss: 1.618, acc: 0.504: 100%|██████████| 91/91 [00:29<00:00,  3.09it/s]
Best model (head+MLP+last11Attn Stage 2) saved with accuracy: 0.5038
[train epoch 27] loss: 1.383, acc: 0.534: 100%|██████████| 366/366 [01:52<00:00,  3.25it/s]
[valid epoch 27] loss: 1.621, acc: 0.500: 100%|██████████| 91/91 [00:29<00:00,  3.08it/s]
[train epoch 28] loss: 1.388, acc: 0.536: 100%|██████████| 366/366 [01:52<00:00,  3.25it/s]
[valid epoch 28] loss: 1.607, acc: 0.507: 100%|██████████| 91/91 [00:29<00:00,  3.08it/s]
Best model (head+MLP+last11Attn Stage 2) saved with accuracy: 0.5072
[train epoch 29] loss: 1.374, acc: 0.540: 100%|██████████| 366/366 [01:52<00:00,  3.25it/s]
[valid epoch 29] loss: 1.609, acc: 0.511: 100%|██████████| 91/91 [00:29<00:00,  3.07it/s]
Best model (head+MLP+last11Attn Stage 2) saved with accuracy: 0.5107
Stage 2 (head+MLP+last11Attn) finished. Best acc: 0.5107

=== QAT Stage 3 (4bit, head+MLP+last11Attn) ===
[train epoch 30] loss: 2.077, acc: 0.315: 100%|██████████| 366/366 [01:52<00:00,  3.25it/s]
[valid epoch 30] loss: 1.986, acc: 0.397: 100%|██████████| 91/91 [00:29<00:00,  3.07it/s]
Best model (head+MLP+last11Attn Stage 3) saved with accuracy: 0.3966
[train epoch 31] loss: 1.857, acc: 0.388: 100%|██████████| 366/366 [01:52<00:00,  3.25it/s]
[valid epoch 31] loss: 1.895, acc: 0.421: 100%|██████████| 91/91 [00:29<00:00,  3.03it/s]
Best model (head+MLP+last11Attn Stage 3) saved with accuracy: 0.4206
[train epoch 32] loss: 1.774, acc: 0.416: 100%|██████████| 366/366 [01:52<00:00,  3.25it/s]
[valid epoch 32] loss: 1.920, acc: 0.405: 100%|██████████| 91/91 [00:29<00:00,  3.06it/s]
[train epoch 33] loss: 1.745, acc: 0.423: 100%|██████████| 366/366 [01:52<00:00,  3.25it/s]
[valid epoch 33] loss: 1.853, acc: 0.412: 100%|██████████| 91/91 [00:29<00:00,  3.07it/s]
[train epoch 34] loss: 1.716, acc: 0.432: 100%|██████████| 366/366 [01:52<00:00,  3.25it/s]
[valid epoch 34] loss: 1.824, acc: 0.430: 100%|██████████| 91/91 [00:29<00:00,  3.06it/s]
Best model (head+MLP+last11Attn Stage 3) saved with accuracy: 0.4296
[train epoch 35] loss: 1.693, acc: 0.436: 100%|██████████| 366/366 [01:52<00:00,  3.25it/s]
[valid epoch 35] loss: 1.791, acc: 0.447: 100%|██████████| 91/91 [00:29<00:00,  3.04it/s]
Best model (head+MLP+last11Attn Stage 3) saved with accuracy: 0.4467
[train epoch 36] loss: 1.662, acc: 0.449: 100%|██████████| 366/366 [01:52<00:00,  3.26it/s]
[valid epoch 36] loss: 1.791, acc: 0.456: 100%|██████████| 91/91 [00:29<00:00,  3.09it/s]
Best model (head+MLP+last11Attn Stage 3) saved with accuracy: 0.4564
[train epoch 37] loss: 1.633, acc: 0.462: 100%|██████████| 366/366 [01:52<00:00,  3.25it/s]
[valid epoch 37] loss: 1.769, acc: 0.457: 100%|██████████| 91/91 [00:29<00:00,  3.08it/s]
Best model (head+MLP+last11Attn Stage 3) saved with accuracy: 0.4570
[train epoch 38] loss: 1.612, acc: 0.464: 100%|██████████| 366/366 [01:52<00:00,  3.25it/s]
[valid epoch 38] loss: 1.757, acc: 0.471: 100%|██████████| 91/91 [00:29<00:00,  3.09it/s]
Best model (head+MLP+last11Attn Stage 3) saved with accuracy: 0.4708
[train epoch 39] loss: 1.602, acc: 0.466: 100%|██████████| 366/366 [01:52<00:00,  3.25it/s]
[valid epoch 39] loss: 1.757, acc: 0.465: 100%|██████████| 91/91 [00:29<00:00,  3.09it/s]
[train epoch 40] loss: 1.569, acc: 0.485: 100%|██████████| 366/366 [01:52<00:00,  3.25it/s]
[valid epoch 40] loss: 1.752, acc: 0.473: 100%|██████████| 91/91 [00:29<00:00,  3.06it/s]
Best model (head+MLP+last11Attn Stage 3) saved with accuracy: 0.4729
[train epoch 41] loss: 1.552, acc: 0.483: 100%|██████████| 366/366 [01:52<00:00,  3.25it/s]
[valid epoch 41] loss: 1.777, acc: 0.454: 100%|██████████| 91/91 [00:29<00:00,  3.08it/s]
[train epoch 42] loss: 1.542, acc: 0.488: 100%|██████████| 366/366 [01:52<00:00,  3.25it/s]
[valid epoch 42] loss: 1.725, acc: 0.455: 100%|██████████| 91/91 [00:29<00:00,  3.09it/s]
[train epoch 43] loss: 1.537, acc: 0.482: 100%|██████████| 366/366 [01:52<00:00,  3.25it/s]
[valid epoch 43] loss: 1.711, acc: 0.482: 100%|██████████| 91/91 [00:29<00:00,  3.06it/s]
Best model (head+MLP+last11Attn Stage 3) saved with accuracy: 0.4818
[train epoch 44] loss: 1.517, acc: 0.493: 100%|██████████| 366/366 [01:52<00:00,  3.25it/s]
[valid epoch 44] loss: 1.714, acc: 0.471: 100%|██████████| 91/91 [00:29<00:00,  3.09it/s]
[train epoch 45] loss: 1.512, acc: 0.503: 100%|██████████| 366/366 [01:52<00:00,  3.25it/s]
[valid epoch 45] loss: 1.704, acc: 0.475: 100%|██████████| 91/91 [00:29<00:00,  3.08it/s]
Stage 3 (head+MLP+last11Attn) finished. Best acc: 0.4818
Progressive QAT completed. Best validation accuracy: 0.5107

==== Sweep 12: head+MLP+allAttn ====

=== QAT Stage 1 (8bit, head+MLP+allAttn) ===
[train epoch 0] loss: 2.188, acc: 0.276: 100%|██████████| 366/366 [01:53<00:00,  3.22it/s]
[valid epoch 0] loss: 2.163, acc: 0.309: 100%|██████████| 91/91 [00:29<00:00,  3.04it/s]
Best model (head+MLP+allAttn Stage 1) saved with accuracy: 0.3086
[train epoch 1] loss: 2.069, acc: 0.309: 100%|██████████| 366/366 [01:53<00:00,  3.22it/s]
[valid epoch 1] loss: 2.106, acc: 0.321: 100%|██████████| 91/91 [00:29<00:00,  3.04it/s]
Best model (head+MLP+allAttn Stage 1) saved with accuracy: 0.3210
[train epoch 2] loss: 2.015, acc: 0.342: 100%|██████████| 366/366 [01:53<00:00,  3.22it/s]
[valid epoch 2] loss: 2.121, acc: 0.328: 100%|██████████| 91/91 [00:29<00:00,  3.04it/s]
Best model (head+MLP+allAttn Stage 1) saved with accuracy: 0.3278
[train epoch 3] loss: 1.986, acc: 0.343: 100%|██████████| 366/366 [01:53<00:00,  3.22it/s]
[valid epoch 3] loss: 2.100, acc: 0.344: 100%|██████████| 91/91 [00:29<00:00,  3.04it/s]
Best model (head+MLP+allAttn Stage 1) saved with accuracy: 0.3436
[train epoch 4] loss: 1.987, acc: 0.339: 100%|██████████| 366/366 [01:53<00:00,  3.22it/s]
[valid epoch 4] loss: 2.057, acc: 0.362: 100%|██████████| 91/91 [00:29<00:00,  3.05it/s]
Best model (head+MLP+allAttn Stage 1) saved with accuracy: 0.3615
[train epoch 5] loss: 1.925, acc: 0.365: 100%|██████████| 366/366 [01:53<00:00,  3.22it/s]
[valid epoch 5] loss: 2.008, acc: 0.364: 100%|██████████| 91/91 [00:29<00:00,  3.05it/s]
Best model (head+MLP+allAttn Stage 1) saved with accuracy: 0.3636
[train epoch 6] loss: 1.887, acc: 0.380: 100%|██████████| 366/366 [01:53<00:00,  3.22it/s]
[valid epoch 6] loss: 2.012, acc: 0.355: 100%|██████████| 91/91 [00:29<00:00,  3.06it/s]
[train epoch 7] loss: 1.856, acc: 0.381: 100%|██████████| 366/366 [01:53<00:00,  3.22it/s]
[valid epoch 7] loss: 2.000, acc: 0.366: 100%|██████████| 91/91 [00:29<00:00,  3.04it/s]
Best model (head+MLP+allAttn Stage 1) saved with accuracy: 0.3663
[train epoch 8] loss: 1.818, acc: 0.396: 100%|██████████| 366/366 [01:53<00:00,  3.22it/s]
[valid epoch 8] loss: 1.913, acc: 0.385: 100%|██████████| 91/91 [00:29<00:00,  3.04it/s]
Best model (head+MLP+allAttn Stage 1) saved with accuracy: 0.3849
[train epoch 9] loss: 1.795, acc: 0.399: 100%|██████████| 366/366 [01:53<00:00,  3.22it/s]
[valid epoch 9] loss: 1.850, acc: 0.408: 100%|██████████| 91/91 [00:29<00:00,  3.05it/s]
Best model (head+MLP+allAttn Stage 1) saved with accuracy: 0.4082
[train epoch 10] loss: 1.751, acc: 0.410: 100%|██████████| 366/366 [01:53<00:00,  3.21it/s]
[valid epoch 10] loss: 1.891, acc: 0.406: 100%|██████████| 91/91 [00:29<00:00,  3.05it/s]
[train epoch 11] loss: 1.704, acc: 0.431: 100%|██████████| 366/366 [01:53<00:00,  3.22it/s]
[valid epoch 11] loss: 1.838, acc: 0.427: 100%|██████████| 91/91 [00:29<00:00,  3.05it/s]
Best model (head+MLP+allAttn Stage 1) saved with accuracy: 0.4268
[train epoch 12] loss: 1.663, acc: 0.442: 100%|██████████| 366/366 [01:53<00:00,  3.22it/s]
[valid epoch 12] loss: 1.831, acc: 0.425: 100%|██████████| 91/91 [00:29<00:00,  3.06it/s]
[train epoch 13] loss: 1.620, acc: 0.457: 100%|██████████| 366/366 [01:53<00:00,  3.22it/s]
[valid epoch 13] loss: 1.834, acc: 0.430: 100%|██████████| 91/91 [00:29<00:00,  3.05it/s]
Best model (head+MLP+allAttn Stage 1) saved with accuracy: 0.4296
[train epoch 14] loss: 1.581, acc: 0.473: 100%|██████████| 366/366 [01:53<00:00,  3.22it/s]
[valid epoch 14] loss: 1.751, acc: 0.451: 100%|██████████| 91/91 [00:29<00:00,  3.06it/s]
Best model (head+MLP+allAttn Stage 1) saved with accuracy: 0.4509
[train epoch 15] loss: 1.549, acc: 0.480: 100%|██████████| 366/366 [01:53<00:00,  3.22it/s]
[valid epoch 15] loss: 1.720, acc: 0.468: 100%|██████████| 91/91 [00:29<00:00,  3.05it/s]
Best model (head+MLP+allAttn Stage 1) saved with accuracy: 0.4680
[train epoch 16] loss: 1.516, acc: 0.500: 100%|██████████| 366/366 [01:53<00:00,  3.22it/s]
[valid epoch 16] loss: 1.712, acc: 0.471: 100%|██████████| 91/91 [00:29<00:00,  3.05it/s]
Best model (head+MLP+allAttn Stage 1) saved with accuracy: 0.4708
[train epoch 17] loss: 1.488, acc: 0.499: 100%|██████████| 366/366 [01:53<00:00,  3.22it/s]
[valid epoch 17] loss: 1.709, acc: 0.471: 100%|██████████| 91/91 [00:29<00:00,  3.05it/s]
Stage 1 (head+MLP+allAttn) finished. Best acc: 0.4708

=== QAT Stage 2 (6bit, head+MLP+allAttn) ===
[train epoch 18] loss: 1.599, acc: 0.468: 100%|██████████| 366/366 [01:53<00:00,  3.22it/s]
[valid epoch 18] loss: 1.726, acc: 0.465: 100%|██████████| 91/91 [00:29<00:00,  3.04it/s]
Best model (head+MLP+allAttn Stage 2) saved with accuracy: 0.4653
[train epoch 19] loss: 1.575, acc: 0.477: 100%|██████████| 366/366 [01:53<00:00,  3.22it/s]
[valid epoch 19] loss: 1.719, acc: 0.461: 100%|██████████| 91/91 [00:29<00:00,  3.05it/s]
[train epoch 20] loss: 1.569, acc: 0.473: 100%|██████████| 366/366 [01:53<00:00,  3.22it/s]
[valid epoch 20] loss: 1.740, acc: 0.460: 100%|██████████| 91/91 [00:29<00:00,  3.05it/s]
[train epoch 21] loss: 1.545, acc: 0.484: 100%|██████████| 366/366 [01:53<00:00,  3.21it/s]
[valid epoch 21] loss: 1.714, acc: 0.474: 100%|██████████| 91/91 [00:29<00:00,  3.05it/s]
Best model (head+MLP+allAttn Stage 2) saved with accuracy: 0.4742
[train epoch 22] loss: 1.527, acc: 0.487: 100%|██████████| 366/366 [01:53<00:00,  3.22it/s]
[valid epoch 22] loss: 1.698, acc: 0.484: 100%|██████████| 91/91 [00:29<00:00,  3.07it/s]
Best model (head+MLP+allAttn Stage 2) saved with accuracy: 0.4838
[train epoch 23] loss: 1.503, acc: 0.498: 100%|██████████| 366/366 [01:53<00:00,  3.22it/s]
[valid epoch 23] loss: 1.668, acc: 0.488: 100%|██████████| 91/91 [00:29<00:00,  3.05it/s]
Best model (head+MLP+allAttn Stage 2) saved with accuracy: 0.4880
[train epoch 24] loss: 1.486, acc: 0.505: 100%|██████████| 366/366 [01:53<00:00,  3.22it/s]
[valid epoch 24] loss: 1.714, acc: 0.473: 100%|██████████| 91/91 [00:29<00:00,  3.05it/s]
[train epoch 25] loss: 1.458, acc: 0.515: 100%|██████████| 366/366 [01:53<00:00,  3.22it/s]
[valid epoch 25] loss: 1.665, acc: 0.480: 100%|██████████| 91/91 [00:29<00:00,  3.06it/s]
[train epoch 26] loss: 1.437, acc: 0.520: 100%|██████████| 366/366 [01:53<00:00,  3.21it/s]
[valid epoch 26] loss: 1.658, acc: 0.496: 100%|██████████| 91/91 [00:29<00:00,  3.06it/s]
Best model (head+MLP+allAttn Stage 2) saved with accuracy: 0.4955
[train epoch 27] loss: 1.428, acc: 0.517: 100%|██████████| 366/366 [01:53<00:00,  3.22it/s]
[valid epoch 27] loss: 1.647, acc: 0.497: 100%|██████████| 91/91 [00:29<00:00,  3.05it/s]
Best model (head+MLP+allAttn Stage 2) saved with accuracy: 0.4969
[train epoch 28] loss: 1.417, acc: 0.522: 100%|██████████| 366/366 [01:53<00:00,  3.22it/s]
[valid epoch 28] loss: 1.640, acc: 0.492: 100%|██████████| 91/91 [00:29<00:00,  3.05it/s]
[train epoch 29] loss: 1.417, acc: 0.525: 100%|██████████| 366/366 [01:53<00:00,  3.22it/s]
[valid epoch 29] loss: 1.639, acc: 0.493: 100%|██████████| 91/91 [00:29<00:00,  3.07it/s]
Stage 2 (head+MLP+allAttn) finished. Best acc: 0.4969

=== QAT Stage 3 (4bit, head+MLP+allAttn) ===
[train epoch 30] loss: 2.144, acc: 0.292: 100%|██████████| 366/366 [01:53<00:00,  3.22it/s]
[valid epoch 30] loss: 2.082, acc: 0.345: 100%|██████████| 91/91 [00:29<00:00,  3.04it/s]
Best model (head+MLP+allAttn Stage 3) saved with accuracy: 0.3450
[train epoch 31] loss: 1.929, acc: 0.365: 100%|██████████| 366/366 [01:53<00:00,  3.22it/s]
[valid epoch 31] loss: 2.045, acc: 0.362: 100%|██████████| 91/91 [00:29<00:00,  3.04it/s]
Best model (head+MLP+allAttn Stage 3) saved with accuracy: 0.3622
[train epoch 32] loss: 1.865, acc: 0.385: 100%|██████████| 366/366 [01:53<00:00,  3.22it/s]
[valid epoch 32] loss: 1.930, acc: 0.404: 100%|██████████| 91/91 [00:29<00:00,  3.05it/s]
Best model (head+MLP+allAttn Stage 3) saved with accuracy: 0.4041
[train epoch 33] loss: 1.836, acc: 0.398: 100%|██████████| 366/366 [01:53<00:00,  3.22it/s]
[valid epoch 33] loss: 1.947, acc: 0.393: 100%|██████████| 91/91 [00:29<00:00,  3.06it/s]
[train epoch 34] loss: 1.785, acc: 0.406: 100%|██████████| 366/366 [01:53<00:00,  3.22it/s]
[valid epoch 34] loss: 1.943, acc: 0.403: 100%|██████████| 91/91 [00:29<00:00,  3.04it/s]
[train epoch 35] loss: 1.754, acc: 0.412: 100%|██████████| 366/366 [01:53<00:00,  3.21it/s]
[valid epoch 35] loss: 1.896, acc: 0.423: 100%|██████████| 91/91 [00:29<00:00,  3.06it/s]
Best model (head+MLP+allAttn Stage 3) saved with accuracy: 0.4227
[train epoch 36] loss: 1.734, acc: 0.424: 100%|██████████| 366/366 [01:53<00:00,  3.22it/s]
[valid epoch 36] loss: 1.838, acc: 0.432: 100%|██████████| 91/91 [00:29<00:00,  3.04it/s]
Best model (head+MLP+allAttn Stage 3) saved with accuracy: 0.4316
[train epoch 37] loss: 1.703, acc: 0.431: 100%|██████████| 366/366 [01:53<00:00,  3.22it/s]
[valid epoch 37] loss: 1.831, acc: 0.441: 100%|██████████| 91/91 [00:29<00:00,  3.05it/s]
Best model (head+MLP+allAttn Stage 3) saved with accuracy: 0.4405
[train epoch 38] loss: 1.682, acc: 0.435: 100%|██████████| 366/366 [01:53<00:00,  3.22it/s]
[valid epoch 38] loss: 1.821, acc: 0.449: 100%|██████████| 91/91 [00:29<00:00,  3.06it/s]
Best model (head+MLP+allAttn Stage 3) saved with accuracy: 0.4488
[train epoch 39] loss: 1.642, acc: 0.455: 100%|██████████| 366/366 [01:53<00:00,  3.22it/s]
[valid epoch 39] loss: 1.843, acc: 0.424: 100%|██████████| 91/91 [00:30<00:00,  3.02it/s]
[train epoch 40] loss: 1.629, acc: 0.464: 100%|██████████| 366/366 [01:56<00:00,  3.15it/s]
[valid epoch 40] loss: 1.776, acc: 0.452: 100%|██████████| 91/91 [00:29<00:00,  3.06it/s]
Best model (head+MLP+allAttn Stage 3) saved with accuracy: 0.4515
[train epoch 41] loss: 1.602, acc: 0.470: 100%|██████████| 366/366 [01:53<00:00,  3.22it/s]
[valid epoch 41] loss: 1.769, acc: 0.449: 100%|██████████| 91/91 [00:29<00:00,  3.06it/s]
[train epoch 42] loss: 1.603, acc: 0.467: 100%|██████████| 366/366 [01:53<00:00,  3.22it/s]
[valid epoch 42] loss: 1.770, acc: 0.449: 100%|██████████| 91/91 [00:29<00:00,  3.07it/s]
[train epoch 43] loss: 1.573, acc: 0.477: 100%|██████████| 366/366 [01:53<00:00,  3.22it/s]
[valid epoch 43] loss: 1.761, acc: 0.456: 100%|██████████| 91/91 [00:29<00:00,  3.06it/s]
Best model (head+MLP+allAttn Stage 3) saved with accuracy: 0.4564
[train epoch 44] loss: 1.578, acc: 0.476: 100%|██████████| 366/366 [01:53<00:00,  3.21it/s]
[valid epoch 44] loss: 1.747, acc: 0.468: 100%|██████████| 91/91 [00:30<00:00,  3.03it/s]
Best model (head+MLP+allAttn Stage 3) saved with accuracy: 0.4680
[train epoch 45] loss: 1.552, acc: 0.483: 100%|██████████| 366/366 [01:53<00:00,  3.21it/s]
[valid epoch 45] loss: 1.751, acc: 0.467: 100%|██████████| 91/91 [00:30<00:00,  3.03it/s]
Stage 3 (head+MLP+allAttn) finished. Best acc: 0.4680
Progressive QAT completed. Best validation accuracy: 0.4969

==== Sweep 13: all-main ====

=== QAT Stage 1 (8bit, all-main) ===
[train epoch 0] loss: 1.983, acc: 0.344: 100%|██████████| 366/366 [01:53<00:00,  3.22it/s]
[valid epoch 0] loss: 2.372, acc: 0.245: 100%|██████████| 91/91 [00:29<00:00,  3.05it/s]
Best model (all-main Stage 1) saved with accuracy: 0.2447
[train epoch 1] loss: 1.954, acc: 0.357: 100%|██████████| 366/366 [01:53<00:00,  3.22it/s]
[valid epoch 1] loss: 2.084, acc: 0.339: 100%|██████████| 91/91 [00:29<00:00,  3.05it/s]
Best model (all-main Stage 1) saved with accuracy: 0.3388
[train epoch 2] loss: 1.957, acc: 0.358: 100%|██████████| 366/366 [01:53<00:00,  3.22it/s]
[valid epoch 2] loss: 2.071, acc: 0.342: 100%|██████████| 91/91 [00:29<00:00,  3.06it/s]
Best model (all-main Stage 1) saved with accuracy: 0.3416
[train epoch 3] loss: 1.916, acc: 0.364: 100%|██████████| 366/366 [01:53<00:00,  3.22it/s]
[valid epoch 3] loss: 2.053, acc: 0.368: 100%|██████████| 91/91 [00:29<00:00,  3.05it/s]
Best model (all-main Stage 1) saved with accuracy: 0.3684
[train epoch 4] loss: 1.888, acc: 0.376: 100%|██████████| 366/366 [01:53<00:00,  3.22it/s]
[valid epoch 4] loss: 1.904, acc: 0.408: 100%|██████████| 91/91 [00:29<00:00,  3.05it/s]
Best model (all-main Stage 1) saved with accuracy: 0.4082
[train epoch 5] loss: 1.899, acc: 0.365: 100%|██████████| 366/366 [01:53<00:00,  3.22it/s]
[valid epoch 5] loss: 2.088, acc: 0.345: 100%|██████████| 91/91 [00:29<00:00,  3.05it/s]
[train epoch 6] loss: 1.892, acc: 0.379: 100%|██████████| 366/366 [01:53<00:00,  3.22it/s]
[valid epoch 6] loss: 1.957, acc: 0.389: 100%|██████████| 91/91 [00:29<00:00,  3.04it/s]
[train epoch 7] loss: 1.834, acc: 0.393: 100%|██████████| 366/366 [01:53<00:00,  3.22it/s]
[valid epoch 7] loss: 1.893, acc: 0.401: 100%|██████████| 91/91 [00:29<00:00,  3.05it/s]
[train epoch 8] loss: 1.802, acc: 0.400: 100%|██████████| 366/366 [01:53<00:00,  3.21it/s]
[valid epoch 8] loss: 1.975, acc: 0.402: 100%|██████████| 91/91 [00:29<00:00,  3.06it/s]
[train epoch 9] loss: 1.769, acc: 0.412: 100%|██████████| 366/366 [01:53<00:00,  3.21it/s]
[valid epoch 9] loss: 1.876, acc: 0.425: 100%|██████████| 91/91 [00:29<00:00,  3.05it/s]
Best model (all-main Stage 1) saved with accuracy: 0.4254
[train epoch 10] loss: 1.707, acc: 0.430: 100%|██████████| 366/366 [01:53<00:00,  3.21it/s]
[valid epoch 10] loss: 1.829, acc: 0.433: 100%|██████████| 91/91 [00:29<00:00,  3.03it/s]
Best model (all-main Stage 1) saved with accuracy: 0.4330
[train epoch 11] loss: 1.659, acc: 0.444: 100%|██████████| 366/366 [01:53<00:00,  3.21it/s]
[valid epoch 11] loss: 1.793, acc: 0.443: 100%|██████████| 91/91 [00:29<00:00,  3.07it/s]
Best model (all-main Stage 1) saved with accuracy: 0.4426
[train epoch 12] loss: 1.600, acc: 0.465: 100%|██████████| 366/366 [01:53<00:00,  3.21it/s]
[valid epoch 12] loss: 1.764, acc: 0.454: 100%|██████████| 91/91 [00:29<00:00,  3.05it/s]
Best model (all-main Stage 1) saved with accuracy: 0.4536
[train epoch 13] loss: 1.596, acc: 0.467: 100%|██████████| 366/366 [01:53<00:00,  3.21it/s]
[valid epoch 13] loss: 1.756, acc: 0.467: 100%|██████████| 91/91 [00:29<00:00,  3.06it/s]
Best model (all-main Stage 1) saved with accuracy: 0.4667
[train epoch 14] loss: 1.538, acc: 0.495: 100%|██████████| 366/366 [01:53<00:00,  3.21it/s]
[valid epoch 14] loss: 1.701, acc: 0.489: 100%|██████████| 91/91 [00:29<00:00,  3.04it/s]
Best model (all-main Stage 1) saved with accuracy: 0.4887
[train epoch 15] loss: 1.510, acc: 0.498: 100%|██████████| 366/366 [01:54<00:00,  3.21it/s]
[valid epoch 15] loss: 1.679, acc: 0.484: 100%|██████████| 91/91 [00:30<00:00,  3.00it/s]
[train epoch 16] loss: 1.472, acc: 0.509: 100%|██████████| 366/366 [01:54<00:00,  3.20it/s]
[valid epoch 16] loss: 1.671, acc: 0.491: 100%|██████████| 91/91 [00:29<00:00,  3.05it/s]
Best model (all-main Stage 1) saved with accuracy: 0.4907
[train epoch 17] loss: 1.453, acc: 0.516: 100%|██████████| 366/366 [01:53<00:00,  3.21it/s]
[valid epoch 17] loss: 1.666, acc: 0.496: 100%|██████████| 91/91 [00:30<00:00,  3.03it/s]
Best model (all-main Stage 1) saved with accuracy: 0.4955
Stage 1 (all-main) finished. Best acc: 0.4955

=== QAT Stage 2 (6bit, all-main) ===
[train epoch 18] loss: 1.586, acc: 0.473: 100%|██████████| 366/366 [01:54<00:00,  3.20it/s]
[valid epoch 18] loss: 1.783, acc: 0.460: 100%|██████████| 91/91 [00:29<00:00,  3.05it/s]
Best model (all-main Stage 2) saved with accuracy: 0.4605
[train epoch 19] loss: 1.550, acc: 0.482: 100%|██████████| 366/366 [01:54<00:00,  3.21it/s]
[valid epoch 19] loss: 1.712, acc: 0.470: 100%|██████████| 91/91 [00:29<00:00,  3.05it/s]
Best model (all-main Stage 2) saved with accuracy: 0.4701
[train epoch 20] loss: 1.533, acc: 0.485: 100%|██████████| 366/366 [01:53<00:00,  3.21it/s]
[valid epoch 20] loss: 1.729, acc: 0.465: 100%|██████████| 91/91 [00:29<00:00,  3.06it/s]
[train epoch 21] loss: 1.516, acc: 0.499: 100%|██████████| 366/366 [01:53<00:00,  3.21it/s]
[valid epoch 21] loss: 1.672, acc: 0.487: 100%|██████████| 91/91 [00:29<00:00,  3.04it/s]
Best model (all-main Stage 2) saved with accuracy: 0.4873
[train epoch 22] loss: 1.490, acc: 0.506: 100%|██████████| 366/366 [01:54<00:00,  3.21it/s]
[valid epoch 22] loss: 1.681, acc: 0.482: 100%|██████████| 91/91 [00:30<00:00,  3.01it/s]
[train epoch 23] loss: 1.487, acc: 0.501: 100%|██████████| 366/366 [01:53<00:00,  3.22it/s]
[valid epoch 23] loss: 1.669, acc: 0.496: 100%|██████████| 91/91 [00:29<00:00,  3.04it/s]
Best model (all-main Stage 2) saved with accuracy: 0.4955
[train epoch 24] loss: 1.443, acc: 0.524: 100%|██████████| 366/366 [01:53<00:00,  3.21it/s]
[valid epoch 24] loss: 1.653, acc: 0.487: 100%|██████████| 91/91 [00:29<00:00,  3.05it/s]
[train epoch 25] loss: 1.440, acc: 0.517: 100%|██████████| 366/366 [01:53<00:00,  3.21it/s]
[valid epoch 25] loss: 1.641, acc: 0.493: 100%|██████████| 91/91 [00:29<00:00,  3.04it/s]
[train epoch 26] loss: 1.410, acc: 0.520: 100%|██████████| 366/366 [01:53<00:00,  3.22it/s]
[valid epoch 26] loss: 1.632, acc: 0.495: 100%|██████████| 91/91 [00:29<00:00,  3.04it/s]
[train epoch 27] loss: 1.392, acc: 0.534: 100%|██████████| 366/366 [01:54<00:00,  3.21it/s]
[valid epoch 27] loss: 1.630, acc: 0.504: 100%|██████████| 91/91 [00:29<00:00,  3.04it/s]
Best model (all-main Stage 2) saved with accuracy: 0.5038
[train epoch 28] loss: 1.386, acc: 0.537: 100%|██████████| 366/366 [01:54<00:00,  3.21it/s]
[valid epoch 28] loss: 1.634, acc: 0.496: 100%|██████████| 91/91 [00:29<00:00,  3.06it/s]
[train epoch 29] loss: 1.385, acc: 0.541: 100%|██████████| 366/366 [01:53<00:00,  3.21it/s]
[valid epoch 29] loss: 1.627, acc: 0.506: 100%|██████████| 91/91 [00:29<00:00,  3.03it/s]
Best model (all-main Stage 2) saved with accuracy: 0.5058
Stage 2 (all-main) finished. Best acc: 0.5058

=== QAT Stage 3 (4bit, all-main) ===
[train epoch 30] loss: 2.382, acc: 0.196: 100%|██████████| 366/366 [01:53<00:00,  3.22it/s]
[valid epoch 30] loss: 2.313, acc: 0.236: 100%|██████████| 91/91 [00:29<00:00,  3.04it/s]
Best model (all-main Stage 3) saved with accuracy: 0.2364
[train epoch 31] loss: 2.199, acc: 0.260: 100%|██████████| 366/366 [01:53<00:00,  3.22it/s]
[valid epoch 31] loss: 2.284, acc: 0.266: 100%|██████████| 91/91 [00:29<00:00,  3.04it/s]
Best model (all-main Stage 3) saved with accuracy: 0.2660
[train epoch 32] loss: 2.115, acc: 0.293: 100%|██████████| 366/366 [01:53<00:00,  3.22it/s]
[valid epoch 32] loss: 2.162, acc: 0.313: 100%|██████████| 91/91 [00:29<00:00,  3.04it/s]
Best model (all-main Stage 3) saved with accuracy: 0.3134
[train epoch 33] loss: 2.040, acc: 0.321: 100%|██████████| 366/366 [01:53<00:00,  3.21it/s]
[valid epoch 33] loss: 2.126, acc: 0.342: 100%|██████████| 91/91 [00:29<00:00,  3.06it/s]
Best model (all-main Stage 3) saved with accuracy: 0.3416
[train epoch 34] loss: 2.001, acc: 0.330: 100%|██████████| 366/366 [01:53<00:00,  3.22it/s]
[valid epoch 34] loss: 2.103, acc: 0.334: 100%|██████████| 91/91 [00:29<00:00,  3.04it/s]
[train epoch 35] loss: 1.959, acc: 0.342: 100%|██████████| 366/366 [01:53<00:00,  3.21it/s]
[valid epoch 35] loss: 2.090, acc: 0.348: 100%|██████████| 91/91 [00:29<00:00,  3.06it/s]
Best model (all-main Stage 3) saved with accuracy: 0.3485
[train epoch 36] loss: 1.933, acc: 0.350: 100%|██████████| 366/366 [01:53<00:00,  3.22it/s]
[valid epoch 36] loss: 2.031, acc: 0.372: 100%|██████████| 91/91 [00:29<00:00,  3.05it/s]
Best model (all-main Stage 3) saved with accuracy: 0.3718
[train epoch 37] loss: 1.885, acc: 0.371: 100%|██████████| 366/366 [01:53<00:00,  3.22it/s]
[valid epoch 37] loss: 2.001, acc: 0.381: 100%|██████████| 91/91 [00:29<00:00,  3.05it/s]
Best model (all-main Stage 3) saved with accuracy: 0.3808
[train epoch 38] loss: 1.890, acc: 0.376: 100%|██████████| 366/366 [01:53<00:00,  3.22it/s]
[valid epoch 38] loss: 2.002, acc: 0.367: 100%|██████████| 91/91 [00:29<00:00,  3.05it/s]
[train epoch 39] loss: 1.847, acc: 0.380: 100%|██████████| 366/366 [01:53<00:00,  3.22it/s]
[valid epoch 39] loss: 1.960, acc: 0.383: 100%|██████████| 91/91 [00:29<00:00,  3.04it/s]
Best model (all-main Stage 3) saved with accuracy: 0.3828
[train epoch 40] loss: 1.824, acc: 0.391: 100%|██████████| 366/366 [01:53<00:00,  3.22it/s]
[valid epoch 40] loss: 1.948, acc: 0.392: 100%|██████████| 91/91 [00:30<00:00,  3.00it/s]
Best model (all-main Stage 3) saved with accuracy: 0.3918
[train epoch 41] loss: 1.805, acc: 0.405: 100%|██████████| 366/366 [01:53<00:00,  3.22it/s]
[valid epoch 41] loss: 1.939, acc: 0.390: 100%|██████████| 91/91 [00:29<00:00,  3.05it/s]
[train epoch 42] loss: 1.788, acc: 0.402: 100%|██████████| 366/366 [01:53<00:00,  3.22it/s]
[valid epoch 42] loss: 1.954, acc: 0.389: 100%|██████████| 91/91 [00:29<00:00,  3.06it/s]
[train epoch 43] loss: 1.777, acc: 0.404: 100%|██████████| 366/366 [01:53<00:00,  3.22it/s]
[valid epoch 43] loss: 1.921, acc: 0.403: 100%|██████████| 91/91 [00:29<00:00,  3.05it/s]
Best model (all-main Stage 3) saved with accuracy: 0.4034
[train epoch 44] loss: 1.760, acc: 0.410: 100%|██████████| 366/366 [01:53<00:00,  3.22it/s]
[valid epoch 44] loss: 1.924, acc: 0.392: 100%|██████████| 91/91 [00:30<00:00,  3.02it/s]
[train epoch 45] loss: 1.769, acc: 0.411: 100%|██████████| 366/366 [01:53<00:00,  3.22it/s]
[valid epoch 45] loss: 1.913, acc: 0.394: 100%|██████████| 91/91 [00:29<00:00,  3.05it/s]
Stage 3 (all-main) finished. Best acc: 0.4034
Progressive QAT completed. Best validation accuracy: 0.5058

进程已结束，退出代码为 0
